<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.beyondunreal.com/Legacy:LadderQuery by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 10:55:55 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>Legacy:LadderQuery - Unreal Wiki</title>
<meta name="generator" content="MediaWiki 1.25.1" />
<link rel="alternate" type="application/x-wiki" title="Edit" href="https://wiki.beyondunreal.com/edit/Legacy:LadderQuery" />
<link rel="edit" title="Edit" href="https://wiki.beyondunreal.com/edit/Legacy:LadderQuery" />
<link rel="shortcut icon" href="w/uewiki-favicon.png" />
<link rel="search" type="application/opensearchdescription+xml" href="w/opensearch_desc.php" title="Unreal Wiki" />
<link rel="EditURI" type="application/rsd+xml" href="w/api251f.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="Legacy_LadderQuery.html" />
<link rel="copyright" href="Unreal_Wiki_Copyrights.html" />
<link rel="alternate" type="application/atom+xml" title="Unreal Wiki Atom feed" href="https://wiki.beyondunreal.com/Special:RecentChanges?feed=atom" />
<link rel="stylesheet" href="w/load2743.css?debug=false&amp;lang=en&amp;modules=ext.geshi.language.uscript%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if IE 6]><link rel="stylesheet" href="/w/skins/MonoBook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/w/skins/MonoBook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="w/load484a.css?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wiki:resourceloader:filter:minify-css:7:29b70323345a439ab9ed7007e0c178a6 */</style>
<script src="w/load9316.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"Legacy","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":100,"wgPageName":"Legacy:LadderQuery","wgTitle":"LadderQuery","wgCurRevisionId":4179,"wgRevisionId":4179,"wgArticleId":1691,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Legacy:LadderQuery","wgRelevantArticleId":1691,"wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}"});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wiki:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-100 ns-subject page-Legacy_LadderQuery skin-monobook action-view">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
									<div id="siteNotice"><div id="localNotice" lang="en" dir="ltr"><p>My program doesn't have bugs. It just develops random features.
</p></div></div>
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Legacy:LadderQuery</h1>

				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</div>
					<div id="contentSub"></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="infobox infobox-class infobox-legacy"><a href="Legacy_UT2003.html" title="Legacy:UT2003" class="mw-redirect">UT2003</a>&#160;:: <a href="Legacy_Object.html" title="Legacy:Object">Object</a> &gt;&gt; <a href="Legacy_XAdminBase.html" title="Legacy:XAdminBase">XAdminBase</a> &gt;&gt; <a href="Legacy_XWebQueryHandler.html" title="Legacy:XWebQueryHandler">xWebQueryHandler</a> &gt;&gt; LadderQuery (<a href="Legacy_Ladder1.html" title="Legacy:Ladder1.46">Ladder1.46</a>)</div>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<ol>
<li class="li1">
<pre class="de1">
<span class="co1">//-----------------------------------------------------------</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//  Ladder.LadderQuery</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//  QueryHandler for webadmin interface</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//-----------------------------------------------------------</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">class</span> LadderQuery <span class="kw1">extends</span> xWebQueryHandler
</pre></li>
<li class="li1">
<pre class="de1">
	DependsOn(ProfileConfigSet)
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">config</span>(System);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">const</span> LOGNAME		= <span class="st0">'LadderQuery'</span>;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">const</span> EPICNUMBER    = <span class="nu0">85</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> LadderGameRules LadderRules;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Profile Tracking Variables</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> SessionMaster 			SMaster;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> ConfigMaster			ConfigM;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw5">string</span> 					EpicPackages[EPICNUMBER];
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Active Profile Variables</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> StringArray 		ProfileMaps;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> ProfileExporter		ExportMaster;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> ProfileConfigSet 	CurrentProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> StringArray 		ProfileMutators;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw5">string</span>				DefaultProfileName;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Physical page that will be served</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		MasterPage;	<span class="co1">// This is main html page for Ladder</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		SubFrame;	<span class="co1">// Manage sub-frame</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		SubFrameMenu;	<span class="co1">// Sub-menu (GameType, Mutators, Maps, PlayInfo, Review)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		SubFrameContent;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Include Files</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		IncludeTable;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		IncludeSection;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		IncludeRows;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		IncludeCaptionButton;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		IncludeMapSelect;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		IncludeProfileName;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		IncludeGameType;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		IncludeCheckBox;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		IncludeSwitch;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// Virtual paths that will be requested from clients</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span> 		ProfileViewURI;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span> 		ProfileEditURI;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span> 		ProfileMenuURI;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span> 		ProfileSwitchURI;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		ProfileManageURI;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		SubFrameURI;	<span class="co1">// accessed through manage link - linked to SubFrame page</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		SubFrameMenuURI;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span> 		SubMapsURI;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span> 		SubSavedURI;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span> 		SubRulesURI;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span> 		SubReviewURI;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span> 		SubGametypeURI;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span> 		SubMutatorsURI;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		SubImportURI;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">string</span>		SubExportURI;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Localized Page Help texts</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	HelpViewProfile;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	HelpEditProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	HelpSwitchProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	HelpManageProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	HelpImportProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	HelpExportProfile;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// Subpage help text</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	HelpGameType;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	HelpMutators;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	HelpMaps;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	HelpPlayInfo;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	HelpReview;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Localized Menu Link Text</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	LinkEditProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	LinkViewProfile;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	LinkSwitchProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	LinkManageProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	LinkImportProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	LinkExportProfile;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// for AddProfilePage/ManageProfilePage</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	TableTitle[<span class="nu0">9</span>];
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	PageCaption[<span class="nu0">9</span>];
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	ProfileButtonName[<span class="nu0">9</span>];
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	ProfileButtonValue[<span class="nu0">9</span>];
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Section Headers &amp; Text</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	MapText;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorText;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	MutatorText;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	RequiredText;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	AvailableText;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	UnlimitedText;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	FollowingMaps;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	AreAssignedText;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	AreAvailableText;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	FollowingMutators;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	CommandLineOptionsTitle;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Button Values</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	ButtonLoadProfile;			<span class="co1">// Label for "switch immediately" button</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ButtonDeleteProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ButtonPreviewProfile;		<span class="co1">// Label for previewing remote profile button</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ButtonApplyImportProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ButtonApplyExportProfile;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ButtonApplyProfileChanges;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Input form labels</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelCopyProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelDeleteProfile;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelImportProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelExportProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelAddProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelSelectActions;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelTextboxActions;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelPlayInfo;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelGeneralProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelGameType;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelProfileName;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelAccessControl;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelChooseAction;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelManagement;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelInputDescription;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	LabelMaxMaps;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	LabelNumberGames;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelCheckAllMap;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelRequiredMaps;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelUncheckAllMap;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	LabelChangeMaplist;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelCheckAllMutator;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelRequiredMutators;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelNumberMatchesLeft;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelUncheckAllMutator;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelDelayProfileChange;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelApplyImportProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelApplyExportProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	LabelModifyProfile;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// Success Messages</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	SuccessText;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	SuccessDeleteProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	SuccessExportProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	SuccessImportProfile;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	SuccessImportProfileTitle;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	SuccessCopyProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	SuccessSwitchProfile;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Profile Errors</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorLoadingPlayInfoText[<span class="nu0">5</span>];
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorGameRulesNotFound;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorGameClassText;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorGameClassTitle;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorAccessControlText;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorAccessControlTitle;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> 	ErrorSameProfileName;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorRemoteMutator;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorRemoteServerActor;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorSavingProfile;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorDeletingProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorExportingProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorNoProfilesExist;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorCopyFrom;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorCopyNoName;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorExcludeMapNotFound;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorIncludeMapNotFound;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorReplacingWebConnection;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ImportClassSpawnError;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ImportProfileFailText;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ImportProfileFailTitle;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Import errors</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorBind;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorBadURL;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorServer;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorResolve;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorProfile;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorTimeout;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorNotFound;
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorForbidden;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorBadRequest;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span>	ErrorUnauthorized;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> <span class="kw5">bool</span> Init()
</pre></li>
<li class="li2">
<pre class="de2">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> GameRules GR;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (GR=<span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">GameRulesModifiers</span>;GR!=<span class="kw5">None</span>;GR=GR.<span class="me0">NextGameRules</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (LadderGameRules(GR) != <span class="kw5">None</span>)
</pre></li>
<li class="li2">
<pre class="de2">
			LadderRules = LadderGameRules(GR);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (LadderRules == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		Cleanup();
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">return</span> <span class="kw6">false</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (ConfigM == <span class="kw5">None</span> &amp;&amp; ConfigMaster(<span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">BaseMutator</span>.<span class="me0">NextMutator</span>) != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		ConfigM = ConfigMaster(<span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">BaseMutator</span>.<span class="me0">NextMutator</span>);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	GetCurrentConfigSet();
</pre></li>
<li class="li1">
<pre class="de1">
	ExportMaster 			= <span class="kw1">new</span> <span class="kw1">class</span><span class="st0">'ProfileExporter'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	DefaultProfileName 		= LadderRules.<span class="me0">DefaultProfileName</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	SMaster 				= <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SessionMaster'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	ProfileMaps 			= <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	ProfileMutators 		= <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">Assert</span>(<span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">AccessControl</span> != <span class="kw5">None</span>);
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//////////////////////////////////////////////////////////////</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//////////////////////////////////////////////////////////////</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// Session Manipulation Functions</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Load profile information into session object</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> CreateSessionInfo(<span class="kw1">coerce</span> <span class="kw5">int</span> ProfileIndex, <span class="kw5">string</span> SID, <span class="kw1">optional</span> <span class="kw5">bool</span> bIncludeNonActive, <span class="kw1">optional</span> <span class="kw5">bool</span> bSave, <span class="kw1">optional</span> <span class="kw5">bool</span> bQuiet)
</pre></li>
<li class="li2">
<pre class="de2">
{
</pre></li>
<li class="li1">
<pre class="de1">
    <span class="kw1">local</span> <span class="kw5">int</span> 										i;
</pre></li>
<li class="li1">
<pre class="de1">
    <span class="kw1">local</span> Session 									CurS;
</pre></li>
<li class="li1">
<pre class="de1">
    <span class="kw1">local</span> <span class="kw5">string</span> 									TempStr;
</pre></li>
<li class="li1">
<pre class="de1">
    <span class="kw1">local</span> array&lt;string&gt; 							TempArr;
</pre></li>
<li class="li2">
<pre class="de2">
    <span class="kw1">local</span> ProfileConfigSet 							TempPCS;
</pre></li>
<li class="li1">
<pre class="de1">
    <span class="kw1">local</span> array&lt;ProfileConfigSet.<span class="me0">ProfileMutator</span>&gt; 	AllPCSMutators;
</pre></li>
<li class="li1">
<pre class="de1">
    <span class="kw1">local</span> array&lt;ProfileConfigSet.<span class="me0">ProfileMap</span>&gt; 		AllPCSMaps;
</pre></li>
<li class="li1">
<pre class="de1">
    <span class="kw1">local</span> array&lt;ProfileConfigSet.<span class="me0">ProfileSA</span>&gt; AllPCSServerActors;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
    <span class="kw2">if</span> (SID == <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
        <span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
    CurS = SMaster.<span class="me0">getSession</span>(SID,<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	TempPCS = LadderRules.<span class="me0">LadderProfiles</span>[ProfileIndex];
</pre></li>
<li class="li2">
<pre class="de2">
	TempPCS.<span class="me0">StartEdit</span>();
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// General profile information</span>
</pre></li>
<li class="li1">
<pre class="de1">
    CurS.<span class="me0">setValue</span>(<span class="st0">"ProfileIndex"</span>, <span class="kw5">string</span>(ProfileIndex), <span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	CurS.<span class="me0">setValue</span>(<span class="st0">"ProfileName"</span>,LadderRules.<span class="me0">Profiles</span>[ProfileIndex].<span class="me0">ProfileName</span>,<span class="kw6">true</span>);
</pre></li>
<li class="li2">
<pre class="de2">
	CurS.<span class="me0">setValue</span>(<span class="st0">"GameType"</span>, <span class="kw5">string</span>(TempPCS.<span class="me0">GetGameClass</span>()), <span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	CurS.<span class="me0">setValue</span>(<span class="st0">"ACClass"</span>, TempPCS.<span class="me0">GetAccessControl</span>(), <span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	CurS.<span class="me0">setValue</span>(<span class="st0">"MaxMaps"</span>, <span class="kw5">string</span>(TempPCS.<span class="me0">GetMaxMaps</span>()), <span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	AllPCSMutators = TempPCS.<span class="me0">GetProfileMutators</span>();
</pre></li>
<li class="li2">
<pre class="de2">
	AllPCSMaps = TempPCS.<span class="me0">GetProfileMaps</span>();
</pre></li>
<li class="li1">
<pre class="de1">
	AllPCSServerActors = TempPCS.<span class="me0">GetProfileServerActors</span>();
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
    TempArr = LadderRules.<span class="me0">GetProfileMutators</span>(<span class="kw5">string</span>(ProfileIndex));
</pre></li>
<li class="li1">
<pre class="de1">
    TempStr = <span class="kw1">class</span><span class="st0">'wUtils103.wArray'</span>.<span class="kw1">static</span>.<span class="me0">Join</span>(TempArr,<span class="st0">","</span>);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Load profile mutator information</span>
</pre></li>
<li class="li1">
<pre class="de1">
    CurS.<span class="me0">ClearMutators</span>();
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;AllPCSMutators.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
	   <span class="kw2">if</span> (AllPCSMutators[i].<span class="me0">bRequired</span> || (<span class="kw3">InStr</span>(TempStr,AllPCSMutators[i].<span class="me0">MutatorName</span>)!=-<span class="nu0">1</span>) || bIncludeNonActive)
</pre></li>
<li class="li2">
<pre class="de2">
	       CurS.<span class="me0">setMutator</span>(AllPCSMutators[i].<span class="me0">MutatorName</span>,<span class="kw6">True</span>,AllPCSMutators[i].<span class="me0">bRequired</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
    TempArr = LadderRules.<span class="me0">GetProfileMaps</span>(<span class="kw5">string</span>(ProfileIndex));
</pre></li>
<li class="li1">
<pre class="de1">
    TempStr = <span class="kw1">class</span><span class="st0">'wUtils103.wArray'</span>.<span class="kw1">static</span>.<span class="me0">Join</span>(TempArr,<span class="st0">","</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// Load profile map information</span>
</pre></li>
<li class="li1">
<pre class="de1">
    CurS.<span class="me0">ClearMaps</span>();
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;AllPCSMaps.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
	   <span class="kw2">if</span> (AllPCSMaps[i].<span class="me0">bRequired</span> || (<span class="kw3">InStr</span>(TempStr,AllPCSMaps[i].<span class="me0">MapName</span>)!=-<span class="nu0">1</span>) || bIncludeNonActive)
</pre></li>
<li class="li1">
<pre class="de1">
    	   CurS.<span class="me0">setMap</span>(AllPCSMaps[i].<span class="me0">MapName</span>,AllPCSMaps[i].<span class="me0">MapListOrder</span>,<span class="kw6">True</span>,AllPCSMaps[i].<span class="me0">bRequired</span>);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	TempArr = LadderRules.<span class="me0">GetProfileServerActors</span>(<span class="kw5">string</span>(ProfileIndex));
</pre></li>
<li class="li1">
<pre class="de1">
	TempStr = <span class="kw1">class</span><span class="st0">'wUtils103.wArray'</span>.<span class="kw1">static</span>.<span class="me0">Join</span>(TempArr,<span class="st0">","</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Load ServerActor info</span>
</pre></li>
<li class="li2">
<pre class="de2">
	CurS.<span class="me0">ClearServerActors</span>();
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;AllPCSServerActors.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (AllPCSServerActors[i].<span class="me0">bRequired</span> || <span class="kw3">InStr</span>(TempStr,AllPCSServerActors[i].<span class="me0">ActorClass</span>)!=-<span class="nu0">1</span> || bIncludeNonActive)
</pre></li>
<li class="li1">
<pre class="de1">
			CurS.<span class="me0">setServerActor</span>(AllPCSServerActors[i].<span class="me0">ActorClass</span>, <span class="kw6">True</span>, AllPCSServerActors[i].<span class="me0">bRequired</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// Load profile PlayInfo data</span>
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;TempPCS.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
        CurS.<span class="me0">setValue</span>(TempPCS.<span class="me0">GetProfileParamName</span>(i),TempPCS.<span class="me0">GetProfileParam</span>(i),<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
    TempPCS.<span class="me0">EndEdit</span>(bSave,bQuiet);
</pre></li>
<li class="li2">
<pre class="de2">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Initialize session data for recently imported profile</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> ProfileConfigSet CreateImportSessionInfo(Session CurS)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">int</span>						i;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> 					TempStr, Tmp;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw8">PlayInfo</span>					TempPI;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> ProfileConfigSet 			TempPCS;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> class&lt;Mutator&gt;			Mut<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;GameInfo&gt; 			GI<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;AccessControl&gt; 		AC<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;Info&gt;				ServerActor<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;class&lt;Info&gt; &gt;		SA<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> array&lt;class&lt;Mutator&gt; &gt; 	M<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	TempPCS = LadderRules.<span class="me0">AddProfile</span>(CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>),CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>));
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (TempPCS.<span class="me0">StartEdit</span>())
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li2">
<pre class="de2">
		TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			GIClass = class&lt;GameInfo&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (GIClass == <span class="kw5">None</span>) <span class="kw2">return</span> <span class="kw5">None</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"ACClass"</span>,<span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">AccessControlClass</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			ACClass = class&lt;AccessControl&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (ACClass == <span class="kw5">None</span>) <span class="kw2">return</span> <span class="kw5">None</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		TempPI = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'PlayInfo'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Mutators</span>
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getMutatorLength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			TempStr = CurS.<span class="me0">getMutator</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
			MutClass = class&lt;Mutator&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr, <span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (MutClass != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				MClass[MClass.<span class="me0">Length</span>] = Mut<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li2">
<pre class="de2">
				TempPCS.<span class="me0">AddProfileMutator</span>(TempStr,CurS.<span class="me0">MutRequired</span>(TempStr));
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> <span class="kw3">log</span>(ErrorRemoteMutator@TempStr,LOGNAME);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getSALength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = CurS.<span class="me0">getServerActor</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
			ServerActorClass = class&lt;Info&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">if</span> (ServerActorClass != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				SAClass[SAClass.<span class="me0">Length</span>] = ServerActor<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
				TempPCS.<span class="me0">AddProfileServerActor</span>(TempStr,CurS.<span class="me0">SARequired</span>(TempStr));
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">else</span> <span class="kw3">log</span>(ErrorRemoteServerActor@TempStr,LOGNAME);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		LoadThisPlayInfo(TempPI, GIClass, ACClass, MClass, SAClass);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// Maps</span>
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getMapLength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = CurS.<span class="me0">getMap</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
			TempPCS.<span class="me0">AddProfileMap</span>(TempStr,CurS.<span class="me0">MapRequired</span>(TempStr));
</pre></li>
<li class="li2">
<pre class="de2">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// PlayInfo</span>
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;TempPI.<span class="me0">Settings</span>.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			TempStr = <span class="st0">""</span>; Tmp=<span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (CurS.<span class="me0">getIdValue</span>(i,TempStr,Tmp) == -<span class="nu0">1</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> ( !SettingIsAllowed(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SecLevel</span>) ) <span class="kw2">continue</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (!TempPCS.<span class="me0">SetProfileNamedParam</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>, CurS.<span class="me0">getValue</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>,TempPI.<span class="me0">Settings</span>[i].<span class="me0">Value</span>)))
</pre></li>
<li class="li2">
<pre class="de2">
				TempPCS.<span class="me0">SetProfileParam</span>(TempPCS.<span class="me0">Count</span>(),TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>,CurS.<span class="me0">getValue</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>,TempPI.<span class="me0">Settings</span>[i].<span class="me0">Value</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		TempPCS.<span class="me0">EndEdit</span>(<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">return</span> TempPCS;
</pre></li>
<li class="li2">
<pre class="de2">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> <span class="kw3">log</span>(ErrorServer,LOGNAME);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> <span class="kw5">None</span>;
</pre></li>
<li class="li2">
<pre class="de2">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Clear session data and optionally create new session object</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> <span class="kw5">string</span> ResetSessionID(Session CurS, <span class="kw1">optional</span> <span class="kw5">bool</span> bDestroySession)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">string</span> OldSID;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (bDestroySession) SMaster.<span class="me0">destroySession</span>(CurS);
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> CurS.<span class="me0">ResetSession</span>();
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	CurS = SMaster.<span class="me0">getSession</span>(OldSID,<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> CurS.<span class="me0">GetHash</span>();
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">////////////////////////////////////////////////////////////</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">////////////////////////////////////////////////////////////</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Profile manipulation methods</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">function</span> <span class="kw5">int</span> LoadThisPlayInfo(<span class="kw8">PlayInfo</span> <span class="kw6">PI</span>, class&lt;GameInfo&gt; ThisGameInfo, class&lt;AccessControl&gt; ThisAccessControl, array&lt;class&lt;Mutator&gt; &gt; ThisMutator, array&lt;class&lt;Info&gt; &gt; ThisServerActor)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;Mutator&gt; M;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">if</span> (<span class="kw6">PI</span> == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">return</span> <span class="nu0">0</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw6">PI</span>.<span class="me0">Clear</span>();
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (ThisGameInfo == <span class="kw5">None</span>)
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">return</span> <span class="nu0">1</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (ThisAccessControl == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">return</span> <span class="nu0">2</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">if</span> (ThisMutator.<span class="me0">Length</span> &gt; <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;ThisMutator.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (ThisMutator[i] == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">return</span> <span class="nu0">3</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">if</span> (ThisServerActor.<span class="me0">Length</span> &gt; <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;ThisServerActor.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (ThisServerActor[i] == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">return</span> <span class="nu0">4</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	ThisGameInfo.<span class="kw1">static</span>.<span class="me0">FillPlayInfo</span>(<span class="kw6">PI</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw6">PI</span>.<span class="me0">PopClass</span>();
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (ThisGameInfo.<span class="kw1">default</span>.<span class="me0">MutatorClass</span> != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li2">
<pre class="de2">
		M = class&lt;Mutator&gt;(<span class="kw3">DynamicLoadObject</span>(ThisGameInfo.<span class="kw1">default</span>.<span class="me0">MutatorClass</span>,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (M != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			M.<span class="kw1">static</span>.<span class="me0">FillPlayInfo</span>(<span class="kw6">PI</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	ThisAccessControl.<span class="kw1">static</span>.<span class="me0">FillPlayInfo</span>(<span class="kw6">PI</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw6">PI</span>.<span class="me0">PopClass</span>();
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i = <span class="nu0">0</span>; i &lt; ThisMutator.<span class="me0">Length</span>; i++)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li2">
<pre class="de2">
		ThisMutator[i].<span class="kw1">static</span>.<span class="me0">FillPlayInfo</span>(<span class="kw6">PI</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw6">PI</span>.<span class="me0">PopClass</span>();
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i = <span class="nu0">0</span>; i &lt; ThisServerActor.<span class="me0">Length</span>; i++)
</pre></li>
<li class="li2">
<pre class="de2">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		ThisServerActor[i].<span class="kw1">static</span>.<span class="me0">FillPlayInfo</span>(<span class="kw6">PI</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw6">PI</span>.<span class="me0">PopClass</span>();
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">class</span><span class="st0">'CommandLineParams'</span>.<span class="kw1">static</span>.<span class="me0">FillPlayInfo</span>(<span class="kw6">PI</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw6">PI</span>.<span class="me0">PopClass</span>();
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> -<span class="nu0">1</span>;
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> ProfileConfigSet GetCurrentConfigSet()
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">if</span> (CurrentProfile == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		i = LadderRules.<span class="me0">FindActiveProfile</span>();
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (i &gt;= <span class="nu0">0</span>)	CurrentProfile = LadderRules.<span class="me0">LadderProfiles</span>[i];
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> CurrentProfile;
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> <span class="kw5">int</span> GetCurrentConfigIndex()
</pre></li>
<li class="li2">
<pre class="de2">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CurrentProfile != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i = <span class="nu0">0</span>;i &lt; LadderRules.<span class="me0">LadderProfiles</span>.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">if</span> (LadderRules.<span class="me0">LadderProfiles</span>[i] == CurrentProfile)
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">return</span> i;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> LadderRules.<span class="me0">FindActiveProfile</span>();
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Returns an array of class names for mutators that this profile will use in the game</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> array&lt;string&gt; LoadActiveProfileMutators(<span class="kw1">optional</span> <span class="kw5">string</span> CurrentProfileItem)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> LadderRules.<span class="me0">GetProfileMutators</span>(CurrentProfileItem);
</pre></li>
<li class="li2">
<pre class="de2">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> array&lt;string&gt; LoadActiveProfileServerActors(<span class="kw1">optional</span> <span class="kw5">string</span> CurrentProfileItem)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> LadderRules.<span class="me0">GetProfileServerActors</span>(CurrentProfileItem);
</pre></li>
<li class="li2">
<pre class="de2">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Returns an array of map names that in the maplist for this profile</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> array&lt;string&gt; LoadActiveProfileMaps(<span class="kw1">optional</span> <span class="kw5">string</span> CurrentProfileItem)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">return</span> LadderRules.<span class="me0">GetProfileServerActors</span>(CurrentProfileItem);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">/*</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">function CreateFullMutatorList(out StringArray Mutators, out StringArray GroupsOnly)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">{</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">	local StringArray Grouped;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	local int i,j,z;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	local string GrpName;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	local string thisgroup, nextgroup;</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">// This class provides a specialized sorting function</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">// since mutators may be grouped - mutators in the same groups</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">// are not allowed to be selected togther</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	Grouped = new(None) class'SortedStringArray';</span>
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">// Create array sorted on GroupName...this allows to flag</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">// the mutator for a different .inc file</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	for (i = 0; i &lt; Mutators.Count(); i++)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	{</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">		j = int(Mutators.GetItem(i));</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">// If the mutator author forgot to configure a group name for the mutator</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		if (AllMutators[j].GroupName == "")</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			GrpName = "Z" $ string (z++);</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">		else GrpName = AllMutators[j].GroupName;</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		Grouped.Add(string(j),GrpName $ "." $ AllMutators[j].FriendlyName);</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	}</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">// Move all grouped mutators to GroupsOnly StringArray for sorting by friendly name</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	for (i=0;i&lt;Grouped.Count();i++)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	{</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		thisgroup = AllMutators[int(Grouped.GetItem(i))].GroupName;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		nextgroup = "";</span>
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		if (thisgroup=="")</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			continue;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		if (i+1&lt;Grouped.Count())</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			nextgroup = AllMutators[int(Grouped.GetItem(i+1))].GroupName;</span>
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		if (thisgroup ~= nextgroup)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		{</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			j=i;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			while(nextgroup~=thisgroup &amp;&amp; j&lt;Grouped.Count())</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">			{</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				GroupsOnly.MoveFromId(Grouped, Grouped.FindItemId(Grouped.GetItem(j)));</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				thisgroup = nextgroup;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				if (j+1==Grouped.Count())</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">					nextgroup="";</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">				else nextgroup = AllMutators[int(Grouped.GetItem(j+1))].GroupName;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			}</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			if (j&lt;Grouped.Count())</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				GroupsOnly.MoveFromId(Grouped,Grouped.FindItemId(Grouped.GetItem(j)));</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			i=-1;</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">		}</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	}</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">// Move all non-grouped mutators back to Mutators array</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">// for re-sorting by Friendly Name</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">	Mutators.Reset();</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	for (i=0;i&lt;Grouped.Count();i++)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	{</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		j=int(Grouped.GetItem(i));</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		Mutators.Add(string(j),AllMutators[j].FriendlyName);</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">	}</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	Grouped.Reset();</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">}</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">*/</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//****************************************************************</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">//****************************************************************</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Helper functions</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//****************************************************************</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//**************************</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// HTML Generation</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//*************************</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Creates a listing of PlayInfo data</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Pass "defaults_row" in the 'IncludeFile' param to add the</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// input form objects to the output</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> <span class="kw5">string</span> GeneratePlayInfoRows(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res, <span class="kw5">string</span> IncludeFile)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i,j,k,z;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">string</span> 	TempStr, Data, Op, SID,
</pre></li>
<li class="li1">
<pre class="de1">
					TempRow, HeadingRow, PlayInfoRows;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> Session 		CurS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw8">PlayInfo</span> 		TempPI;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> StringArray 	<span class="kw9">Info</span>, InfoC, InfoS, InfoT;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;string&gt; 		Options;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;Mutator&gt; 		TempMut;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;Info&gt;			TempSA;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> class&lt;GameInfo&gt; 		GI<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;AccessControl&gt; 	AC<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;class&lt;Mutator&gt; &gt; M<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;class&lt;Info&gt; &gt;	SA<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	CurS = SMaster.<span class="me0">GetSession</span>(SID);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li2">
<pre class="de2">
		GIClass = class&lt;GameInfo&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (GIClass == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		ShowMessage(Res,ErrorGameClassTitle,ErrorGameClassText);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">return</span> <span class="st0">""</span>;
</pre></li>
<li class="li2">
<pre class="de2">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"ACClass"</span>,<span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">AccessControlClass</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		ACClass = class&lt;AccessControl&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">if</span> (ACClass == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		ShowMessage(Res,ErrorAccessControlTitle,ErrorAccessControlText);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">return</span> <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">GetMutatorLength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = CurS.<span class="me0">getMutator</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li2">
<pre class="de2">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			TempMut = class&lt;Mutator&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempMut != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				MClass[MClass.<span class="me0">Length</span>] = TempMut;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li2">
<pre class="de2">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getSALength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = CurS.<span class="me0">getServerActor</span>(i);
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			TempSA = class&lt;Info&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempSA != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				SAClass[SAClass.<span class="me0">Length</span>] = TempSA;
</pre></li>
<li class="li2">
<pre class="de2">
		}
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Initialize and fill PlayInfo</span>
</pre></li>
<li class="li1">
<pre class="de1">
	TempPI = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'PlayInfo'</span>;
</pre></li>
<li class="li2">
<pre class="de2">
	LoadThisPlayInfo(TempPI, GIClass, ACClass, MClass, SAClass);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;TempPI.<span class="me0">Settings</span>.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (CurS.<span class="me0">HasData</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>))
</pre></li>
<li class="li1">
<pre class="de1">
			TempPI.<span class="me0">StoreSetting</span>(i, CurS.<span class="me0">getValue</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>,TempPI.<span class="me0">Settings</span>[i].<span class="me0">Value</span>));
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	InfoC = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;	<span class="co1">// Checkboxes</span>
</pre></li>
<li class="li1">
<pre class="de1">
	InfoS = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;	<span class="co1">// Selects</span>
</pre></li>
<li class="li1">
<pre class="de1">
	InfoT = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;	<span class="co1">// Textboxes</span>
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw9">Info</span>  = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;	<span class="co1">// Contains each unique ClassFrom value</span>
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Want to allow admin to input values for each setting</span>
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (IncludeFile ~= <span class="st0">"defaults_row"</span>)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;TempPI.<span class="me0">Settings</span>.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li2">
<pre class="de2">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempPI.<span class="me0">Settings</span>[i].<span class="me0">RenderType</span>~=<span class="st0">"Text"</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="co1">// Hack for MOTD sorting</span>
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (<span class="kw3">Left</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>,<span class="kw3">Len</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>) - <span class="nu0">1</span>) ~= <span class="st0">"GameReplicationInfo.MOTDLine"</span>)
</pre></li>
<li class="li2">
<pre class="de2">
					InfoT.<span class="me0">Add</span>(<span class="kw5">string</span>(i), TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span> InfoT.<span class="me0">Add</span>(<span class="kw5">string</span>(i),TempPI.<span class="me0">Settings</span>[i].<span class="me0">DisplayName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> <span class="kw2">if</span> (TempPI.<span class="me0">Settings</span>[i].<span class="me0">RenderType</span>~=<span class="st0">"Check"</span>)
</pre></li>
<li class="li2">
<pre class="de2">
				InfoC.<span class="me0">Add</span>(<span class="kw5">string</span>(i),TempPI.<span class="me0">Settings</span>[i].<span class="me0">DisplayName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> <span class="kw2">if</span> (TempPI.<span class="me0">Settings</span>[i].<span class="me0">RenderType</span>~=<span class="st0">"Select"</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				InfoS.<span class="me0">Add</span>(<span class="kw5">string</span>(i),TempPI.<span class="me0">Settings</span>[i].<span class="me0">DisplayName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">for</span> (j=<span class="nu0">0</span>;j&lt;<span class="kw9">Info</span>.<span class="me0">Count</span>();j++)
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (<span class="kw9">Info</span>.<span class="me0">GetTag</span>(j) ~= <span class="kw5">string</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">ClassFrom</span>))
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (j == <span class="kw9">Info</span>.<span class="me0">Count</span>())
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw9">Info</span>.<span class="me0">Add</span>(<span class="kw5">string</span>(i), <span class="kw5">string</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">ClassFrom</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (k=<span class="nu0">0</span>;k&lt;<span class="kw9">Info</span>.<span class="me0">Count</span>();k++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			TempRow = <span class="st0">""</span>; HeadingRow = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, <span class="st0">"&lt;td class=ttext colspan=<span class="es0">\"</span>3<span class="es0">\"</span>&gt;"</span>$Info.<span class="me0">GetTag</span>(k)$<span class="st0">"&lt;/td&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			HeadingRow = WebInclude(RowLeft);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;InfoC.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li2">
<pre class="de2">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
				j=<span class="kw5">int</span>(InfoC.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (!SettingIsAllowed(TempPI.<span class="me0">Settings</span>[j].<span class="me0">SecLevel</span>) || (<span class="kw5">string</span>(TempPI.<span class="me0">Settings</span>[j].<span class="me0">ClassFrom</span>)!=<span class="kw9">Info</span>.<span class="me0">GetTag</span>(k)))
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">continue</span>;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, Checkbox(TempPI.<span class="me0">Settings</span>[j].<span class="me0">SettingName</span>, TempPI.<span class="me0">Settings</span>[j].<span class="me0">Value</span> ~= <span class="st0">"True"</span>, TempPI.<span class="me0">Settings</span>[j].<span class="me0">Data</span> != <span class="st0">""</span>));
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = WebInclude(CellLeft);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, <span class="st0">"&lt;span class=location title=<span class="es0">\"</span>Required Security Level<span class="es0">\"</span>&gt;"</span>$TempPI.<span class="me0">Settings</span>[j].<span class="me0">SecLevel</span>$<span class="st0">"&lt;/span&gt;"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
				TempStr += WebInclude(CellLeft);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, <span class="st0">"&lt;span class='location'&gt;"</span>$HtmlEncode(TempPI.<span class="me0">Settings</span>[j].<span class="me0">DisplayName</span>)$<span class="st0">"&lt;/span&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, WebInclude(CellLeft) $ TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
				TempRow += WebInclude(RowLeft);
</pre></li>
<li class="li2">
<pre class="de2">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;InfoT.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = <span class="st0">""</span>;
</pre></li>
<li class="li2">
<pre class="de2">
				j = <span class="kw5">int</span>(InfoT.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (!SettingIsAllowed(TempPI.<span class="me0">Settings</span>[j].<span class="me0">SecLevel</span>) || (<span class="kw5">string</span>(TempPI.<span class="me0">Settings</span>[j].<span class="me0">ClassFrom</span>)!=<span class="kw9">Info</span>.<span class="me0">GetTag</span>(k)))
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">continue</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Data = <span class="st0">"8"</span>;
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">if</span> (TempPI.<span class="me0">Settings</span>[j].<span class="me0">Data</span> != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					Data = TempPI.<span class="me0">Settings</span>[j].<span class="me0">Data</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw3">Divide</span>(TempPI.<span class="me0">Settings</span>[j].<span class="me0">Data</span>, <span class="st0">";"</span>, Data, Op);
</pre></li>
<li class="li1">
<pre class="de1">
					TempPI.<span class="me0">SplitStringToArray</span>(Options, Op, <span class="st0">":"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
				}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Op = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (Options.<span class="me0">Length</span> &gt; <span class="nu0">1</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					Op = <span class="st0">" ("</span>$Options[<span class="nu0">0</span>]$<span class="st0">" - "</span>$Options[<span class="nu0">1</span>]$<span class="st0">")"</span>;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, Textbox(TempPI.<span class="me0">Settings</span>[j].<span class="me0">SettingName</span>, Data, <span class="nu0">3</span> * <span class="kw5">int</span>(Data), TempPI.<span class="me0">Settings</span>[j].<span class="me0">Value</span>) $ Op);
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = WebInclude(CellLeft);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, <span class="st0">"&lt;span class=location title=<span class="es0">\"</span>Required Security Level<span class="es0">\"</span>&gt;"</span>$TempPI.<span class="me0">Settings</span>[j].<span class="me0">SecLevel</span>$<span class="st0">"&lt;/span&gt;"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
				TempStr += WebInclude(CellLeft);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, <span class="st0">"&lt;span class='location'&gt;"</span>$HtmlEncode(TempPI.<span class="me0">Settings</span>[j].<span class="me0">DisplayName</span>)$<span class="st0">"&lt;/span&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, WebInclude(CellLeft) $ TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
				TempRow += WebInclude(RowLeft);
</pre></li>
<li class="li2">
<pre class="de2">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;InfoS.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				Data = <span class="st0">""</span>; TempStr = <span class="st0">""</span>;
</pre></li>
<li class="li2">
<pre class="de2">
				j=<span class="kw5">int</span>(InfoS.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (!SettingIsAllowed(TempPI.<span class="me0">Settings</span>[j].<span class="me0">SecLevel</span>) || (<span class="kw5">string</span>(TempPI.<span class="me0">Settings</span>[j].<span class="me0">ClassFrom</span>)!=<span class="kw9">Info</span>.<span class="me0">GetTag</span>(k)))
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">continue</span>;
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="co1">// Build a set of options from PID.Data</span>
</pre></li>
<li class="li1">
<pre class="de1">
				TempPI.<span class="me0">SplitStringToArray</span>(Options, TempPI.<span class="me0">Settings</span>[j].<span class="me0">Data</span>, <span class="st0">";"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">for</span> (z = <span class="nu0">0</span>; (z+<span class="nu0">1</span>)&lt;Options.<span class="me0">Length</span>; z += <span class="nu0">2</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					Data += (<span class="st0">"&lt;option value='"</span>$Options[z]$<span class="st0">"'"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">If</span> (TempPI.<span class="me0">Settings</span>[j].<span class="me0">Value</span> == Options[z])
</pre></li>
<li class="li1">
<pre class="de1">
						Data @= <span class="st0">"selected"</span>;
</pre></li>
<li class="li2">
<pre class="de2">
					Data += (<span class="st0">"&gt;"</span>$HtmlEncode(Options[z+<span class="nu0">1</span>])$<span class="st0">"&lt;/option&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, Select(TempPI.<span class="me0">Settings</span>[j].<span class="me0">SettingName</span>, Data));
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = WebInclude(CellLeft);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, <span class="st0">"&lt;span class=location title=<span class="es0">\"</span>Required Security Level<span class="es0">\"</span>&gt;"</span>$TempPI.<span class="me0">Settings</span>[j].<span class="me0">SecLevel</span>$<span class="st0">"&lt;/span&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr += WebInclude(CellLeft);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, <span class="st0">"&lt;span class='location'&gt;"</span>$HtmlEncode(TempPI.<span class="me0">Settings</span>[j].<span class="me0">DisplayName</span>)$<span class="st0">"&lt;/span&gt;"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
				Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, WebInclude(CellLeft) $ TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
				TempRow += WebInclude(RowLeft);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempRow!=<span class="st0">""</span>)
</pre></li>
<li class="li2">
<pre class="de2">
				PlayInfoRows += (HeadingRow$TempRow);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span>	<span class="co1">// Displaying values only</span>
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;TempPI.<span class="me0">Settings</span>.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (<span class="kw3">Left</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>,<span class="kw3">Len</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>) - <span class="nu0">1</span>) ~= <span class="st0">"GameReplicationInfo.MOTDLine"</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				InfoS.<span class="me0">Add</span>(<span class="kw5">string</span>(i), TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> InfoS.<span class="me0">Add</span>(<span class="kw5">string</span>(i),TempPI.<span class="me0">Settings</span>[i].<span class="me0">DisplayName</span>);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (j=<span class="nu0">0</span>;j&lt;<span class="kw9">Info</span>.<span class="me0">Count</span>();j++)
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (<span class="kw9">Info</span>.<span class="me0">GetTag</span>(j) ~= <span class="kw5">string</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">ClassFrom</span>))
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (j == <span class="kw9">Info</span>.<span class="me0">Count</span>())
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw9">Info</span>.<span class="me0">Add</span>(<span class="kw5">string</span>(i), <span class="kw5">string</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">ClassFrom</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (k=<span class="nu0">0</span>;k&lt;<span class="kw9">Info</span>.<span class="me0">Count</span>();k++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			TempRow = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			HeadingRow = <span class="st0">"&lt;tr&gt;&lt;td class=ttext colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;"</span>$Info.<span class="me0">GetTag</span>(k)$<span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;InfoS.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				j=<span class="kw5">int</span>(InfoS.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li2">
<pre class="de2">
				Data = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (!SettingIsAllowed(TempPI.<span class="me0">Settings</span>[j].<span class="me0">SecLevel</span>) || (<span class="kw5">string</span>(TempPI.<span class="me0">Settings</span>[j].<span class="me0">ClassFrom</span>)!=<span class="kw9">Info</span>.<span class="me0">GetTag</span>(k)))
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">continue</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
				Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, HtmlEncode(TempPI.<span class="me0">Settings</span>[j].<span class="me0">DisplayName</span>));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (TempPI.<span class="me0">Settings</span>[j].<span class="me0">Value</span> ~= <span class="st0">"true"</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					Data = <span class="st0">"True"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">else</span> <span class="kw2">if</span> (TempPI.<span class="me0">Settings</span>[j].<span class="me0">Value</span> ~= <span class="st0">"false"</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					Data = <span class="st0">"False"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span>
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li2">
<pre class="de2">
					<span class="kw2">if</span> (TempPI.<span class="me0">Settings</span>[j].<span class="me0">RenderType</span> ~= <span class="st0">"Select"</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw1">class</span><span class="st0">'wUtils103.wString'</span>.<span class="kw1">static</span>.<span class="me0">Split2</span>(TempPI.<span class="me0">Settings</span>[j].<span class="me0">Data</span>, <span class="st0">";"</span>, Options);
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">for</span> (z=<span class="nu0">0</span>;(z+<span class="nu0">1</span>)&lt;Options.<span class="me0">Length</span>;z+=<span class="nu0">2</span>)
</pre></li>
<li class="li1">
<pre class="de1">
						{
</pre></li>
<li class="li2">
<pre class="de2">
							<span class="kw2">if</span> (TempPI.<span class="me0">Settings</span>[j].<span class="me0">Value</span> == Options[z])
</pre></li>
<li class="li1">
<pre class="de1">
							{
</pre></li>
<li class="li1">
<pre class="de1">
								Data = Options[z+<span class="nu0">1</span>];
</pre></li>
<li class="li1">
<pre class="de1">
								<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
							}
</pre></li>
<li class="li2">
<pre class="de2">
						}
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">else</span> Data = TempPI.<span class="me0">Settings</span>[j].<span class="me0">Value</span>;
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
				Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, HtmlEncode(Data));
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				TempRow += WebInclude(IncludeFile);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">if</span> (TempRow!=<span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				PlayInfoRows += (HeadingRow$TempRow);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> PlayInfoRows;
</pre></li>
<li class="li2">
<pre class="de2">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Creates the drop-down box containing profiles names</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> <span class="kw5">String</span> GenerateSwitchProfileOptions(<span class="kw1">optional</span> <span class="kw5">string</span> CurrentProfileItem)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">int</span> i;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> SelectedStr, OptionStr;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (LadderRules.<span class="me0">AllLadderProfiles</span>.<span class="me0">Count</span>() == <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">return</span> <span class="st0">"&lt;option value=<span class="es0">\"</span><span class="es0">\"</span>&gt;***"</span>@NoneText@<span class="st0">"***&lt;/option&gt;"</span>;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i=<span class="nu0">0</span>; i &lt; LadderRules.<span class="me0">AllLadderProfiles</span>.<span class="me0">Count</span>(); i++)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// This item was the item passed in by CurrentProfileItem, so make it active</span>
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (CurrentProfileItem ~= LadderRules.<span class="me0">AllLadderProfiles</span>.<span class="me0">GetItem</span>(i))
</pre></li>
<li class="li2">
<pre class="de2">
			SelectedStr = <span class="st0">" selected"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">else</span> SelectedStr = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		OptionStr = OptionStr$<span class="st0">"&lt;option value=<span class="es0">\"</span>"</span>$LadderRules.<span class="me0">AllLadderProfiles</span>.<span class="me0">GetItem</span>(i)$<span class="st0">"<span class="es0">\"</span>"</span>$SelectedStr$<span class="st0">"&gt;"</span>$LadderRules.<span class="me0">AllLadderProfiles</span>.<span class="me0">GetTag</span>(i)@<span class="st0">"&lt;/option&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">return</span> OptionStr;
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> <span class="kw5">bool</span> SettingIsAllowed(<span class="kw5">byte</span> SettingSecLevel)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">return</span> SettingSecLevel &lt;= CurAdmin.<span class="me0">MaxSecLevel</span>();
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Handles generation of the double map select boxes (Exclude &amp; Include)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> <span class="kw5">String</span> CreateMapListSelect(array&lt;ProfileConfigSet.<span class="me0">ProfileMap</span>&gt; AllPCSMaps, StringArray MapList, StringArray MovedMaps)
</pre></li>
<li class="li2">
<pre class="de2">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i,j;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">String</span> ResponseStr, SelectedStr, Tmp;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (MapList.<span class="me0">Count</span>() == <span class="nu0">0</span>)
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">return</span> <span class="st0">"&lt;option value=<span class="es0">\"</span><span class="es0">\"</span>&gt;***"</span>@NoneText@<span class="st0">"***&lt;/option&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i = <span class="nu0">0</span>; i&lt;MapList.<span class="me0">Count</span>(); i++)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Index for map within AllPCSMaps</span>
</pre></li>
<li class="li2">
<pre class="de2">
		j = <span class="kw5">int</span>(MapList.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Tmp = AllPCSMaps[j].<span class="me0">MapName</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		SelectedStr = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (MovedMaps != <span class="kw5">None</span> &amp;&amp; MovedMaps.<span class="me0">FindItemId</span>(<span class="kw5">string</span>(j)) &gt;= <span class="nu0">0</span>)
</pre></li>
<li class="li2">
<pre class="de2">
			SelectedStr = <span class="st0">" selected"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		ResponseStr = ResponseStr$<span class="st0">"&lt;option value=<span class="es0">\"</span>"</span>$Tmp$<span class="st0">"<span class="es0">\"</span>"</span>$SelectedStr$<span class="st0">"&gt;"</span>$Tmp$<span class="st0">"&lt;/option&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> ResponseStr;
</pre></li>
<li class="li2">
<pre class="de2">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//**********************</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Import / Export</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//**********************</span>
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Handles spacing for textboxes on export page</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> <span class="kw5">int</span> GetLongestURL()
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i, Current, Largest;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i = <span class="nu0">0</span>; i &lt; ExportMaster.<span class="me0">Zips</span>.<span class="me0">Length</span>; i++)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		Current = <span class="kw3">Len</span>(ExportMaster.<span class="me0">Zips</span>[i].<span class="me0">ZipURL</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (Current &gt; Largest)
</pre></li>
<li class="li2">
<pre class="de2">
			Largest = Current;
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> Largest + <span class="nu0">1</span>;
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Handles filling in zip-location textboxes on export page</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> <span class="kw5">string</span> GetLocation(<span class="kw5">string</span> Package)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Check if we're dealing with a map or a mutator</span>
</pre></li>
<li class="li1">
<pre class="de1">
	i = <span class="kw3">InStr</span>(Package, <span class="st0">"."</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Dealing with a mutator - remove class name</span>
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">if</span> (i != -<span class="nu0">1</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		Package = <span class="kw3">Left</span>(Package, i);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> ExportMaster.<span class="me0">FindZipLocation</span>(Package);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Handles saving zip file locations from export page</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> <span class="kw4">SetLocation</span>(<span class="kw5">string</span> Package, <span class="kw5">string</span> NewLocation)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Check if we're dealing with a map or a mutator</span>
</pre></li>
<li class="li1">
<pre class="de1">
	i = <span class="kw3">InStr</span>(Package, <span class="st0">"."</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Dealing with a mutator - remove class name</span>
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">if</span> (i != -<span class="nu0">1</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		Package = <span class="kw3">Left</span>(Package, i);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (NewLocation == <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		ExportMaster.<span class="me0">DeleteZipLocation</span>(Package);
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">else</span> ExportMaster.<span class="me0">AddZipLocation</span>(Package, NewLocation);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Utility function to remove strings from profile names before</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// creating .txt for exported profile</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">function</span> <span class="kw5">string</span> RemoveStr(<span class="kw5">string</span> Source,<span class="kw5">string</span> mask)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> <span class="kw3">left</span>,<span class="kw3">right</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	i = <span class="kw3">InStr</span>(Source,mask);
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">while</span> (i != -<span class="nu0">1</span>)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw3">Divide</span>(Source,mask,<span class="kw3">left</span>,<span class="kw3">right</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		Source = <span class="kw3">Left</span>$Right;
</pre></li>
<li class="li2">
<pre class="de2">
		i = <span class="kw3">InStr</span>(Source,Mask);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> Source;
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Prevents entering a zip file location for any package</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// that is already included with the game</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> <span class="kw5">bool</span> EpicPackage(<span class="kw5">string</span> Package)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">int</span> i;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Check if we're dealing with a map or a mutator</span>
</pre></li>
<li class="li1">
<pre class="de1">
	i = <span class="kw3">InStr</span>(Package, <span class="st0">"."</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="co1">// Dealing with a mutator - remove class name</span>
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (i != -<span class="nu0">1</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		Package = <span class="kw3">Left</span>(Package, i);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i = <span class="nu0">0</span>;i &lt; EPICNUMBER; i++)
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">if</span> (Package ~= EpicPackages[i])
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> <span class="kw6">false</span>;
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">function</span> CheckSettingValue(<span class="kw5">string</span> SettingData, <span class="kw1">out</span> <span class="kw5">string</span> NewValue)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> sMaxLength, sMinMax, sMin, sMax;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> iMaxLength, iMin, iMax, iValue;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">float</span> <span class="kw3">fMin</span>, <span class="kw3">fMax</span>, fValue;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">bool</span> bFloat;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (SettingData == <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// This setting has no valid min/max (it is a password setting or something)</span>
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (<span class="kw3">InStr</span>(SettingData,<span class="st0">";"</span>) &lt; <span class="nu0">0</span> )
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="co1">// Allow only up to three times the configured max length</span>
</pre></li>
<li class="li1">
<pre class="de1">
		iMaxLength = <span class="nu0">3</span> * <span class="kw5">int</span>(SettingData);
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">if</span> (<span class="kw3">Len</span>(NewValue) &gt; iMaxLength)
</pre></li>
<li class="li1">
<pre class="de1">
			NewValue = <span class="kw3">Left</span>(NewValue,iMaxLength);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw3">Divide</span>(SettingData,<span class="st0">";"</span>,sMaxLength,sMinMax);	<span class="co1">// Split the Max Length &amp; MinMax Info</span>
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw3">Divide</span>(sMinMax,<span class="st0">":"</span>,sMin,sMax);				<span class="co1">// Split the Min &amp; Max info for casting</span>
</pre></li>
<li class="li1">
<pre class="de1">
	iMaxLength = <span class="kw5">int</span>(sMaxLength);
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> ( <span class="kw3">InStr</span>(sMin,<span class="st0">"."</span>) &gt;= <span class="nu0">0</span> || <span class="kw3">InStr</span>(sMax,<span class="st0">"."</span>) &gt;= <span class="nu0">0</span>)	<span class="co1">// Are we dealing with floating point numbers?</span>
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li2">
<pre class="de2">
		bFloat = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw3">fMin</span> = <span class="kw5">float</span>(sMin);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw3">fMax</span> = <span class="kw5">float</span>(sMax);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">else</span>
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		iMin = <span class="kw5">int</span>(sMin);
</pre></li>
<li class="li1">
<pre class="de1">
		iMax = <span class="kw5">int</span>(sMax);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// First check for length</span>
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (<span class="kw3">Len</span>(NewValue) &gt; iMaxLength)
</pre></li>
<li class="li1">
<pre class="de1">
		NewValue = <span class="kw3">Left</span>(NewValue,iMaxLength);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">if</span> (bFloat)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		fValue = <span class="kw5">float</span>(NewValue);
</pre></li>
<li class="li1">
<pre class="de1">
		fValue = <span class="kw3">FClamp</span>(fValue,<span class="kw3">fMin</span>,<span class="kw3">fMax</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		NewValue = <span class="kw5">string</span>(fValue);
</pre></li>
<li class="li2">
<pre class="de2">
	}
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span>
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		iValue = <span class="kw5">int</span>(NewValue);
</pre></li>
<li class="li1">
<pre class="de1">
		iValue = <span class="kw3">Clamp</span>(iValue,iMin,iMax);
</pre></li>
<li class="li2">
<pre class="de2">
		NewValue = <span class="kw5">string</span>(iValue);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//*****************************************************************************</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//*****************************************************************************</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// Query Methods</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Passes the SessionID variable to all pages in this query action</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// if SessionID is not present in WebRequest, generates one</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// (Helpful when dealing with frames)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> <span class="kw5">bool</span> PreQuery(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> SID;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (SID == <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		SID = SMaster.<span class="me0">getSession</span>(<span class="st0">"xxxxx"</span>,<span class="kw6">true</span>).<span class="me0">GetHash</span>();
</pre></li>
<li class="li2">
<pre class="de2">
		Req.<span class="me0">AddVariable</span>(<span class="st0">"SessionID"</span>, SID);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SessionID"</span>, SID);
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> <span class="kw5">bool</span> Query(<span class="kw8">WebRequest</span> Request, <span class="kw8">WebResponse</span> Response)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">switch</span> (<span class="kw3">Mid</span>(Request.<span class="me0">URI</span>, <span class="nu0">1</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">case</span> DefaultPage: 		<span class="kw2">if</span> (!MapIsChanging()) QueryLadderFrame(Request, Response);		<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> ProfileMenuURI:	<span class="kw2">if</span> (!MapIsChanging()) QueryLadderMenu(Request, Response);		<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> ProfileViewURI:	<span class="kw2">if</span> (!MapIsChanging()) QueryLadderView(Request, Response);		<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> ProfileEditURI: 	<span class="kw2">if</span> (!MapIsChanging()) QueryLadderEdit(Request, Response);		<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> ProfileSwitchURI:	<span class="kw2">if</span> (!MapIsChanging()) QueryLadderSwitch(Request, Response);		<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">case</span> ProfileManageURI:	<span class="kw2">if</span> (!MapIsChanging()) QueryLadderManage(Request, Response);		<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Management subframes</span>
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> SubFrameURI: 		<span class="kw2">if</span> (!MapIsChanging()) QuerySubFrame(Request, Response);			<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> SubFrameMenuURI: 	<span class="kw2">if</span> (!MapIsChanging()) QuerySubMenu(Request, Response);			<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">case</span> SubGametypeURI:	<span class="kw2">if</span> (!MapIsChanging()) QuerySubGameType(Request, Response);		<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> SubMapsURI:		<span class="kw2">if</span> (!MapIsChanging()) QuerySubMaps(Request, Response);			<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> SubMutatorsURI:	<span class="kw2">if</span> (!MapIsChanging()) QuerySubMutators(Request, Response);		<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> SubRulesURI:		<span class="kw2">if</span> (!MapIsChanging()) QuerySubRules(Request, Response);			<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> SubReviewURI:		<span class="kw2">if</span> (!MapIsChanging()) QuerySubReview(Request, Response);		<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">case</span> SubSavedURI:		<span class="kw2">if</span> (!MapIsChanging()) QuerySubSaved(Request, Response);			<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> SubImportURI: 		<span class="kw2">if</span> (!MapIsChanging()) QuerySubImport(Request, Response);		<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> SubExportURI: 		<span class="kw2">if</span> (!MapIsChanging()) QuerySubExport(Request, Response);		<span class="kw2">return</span> <span class="kw6">true</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// This query is looking for a page from another query handler</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// or the map is changing</span>
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">return</span> <span class="kw6">false</span>;
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> QueryLadderFrame(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li2">
<pre class="de2">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">String</span> Page;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> SID;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// if no page specified, use the default</span>
</pre></li>
<li class="li2">
<pre class="de2">
	Page = Req.<span class="me0">GetVariable</span>(<span class="st0">"Page"</span>, ProfileViewURI);
</pre></li>
<li class="li1">
<pre class="de1">
	SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Tell the menu page which page we're viewing (with the ?Page=),</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// so that it can highlight the appropriate link</span>
</pre></li>
<li class="li2">
<pre class="de2">
	Res.<span class="me0">Subst</span>(<span class="st0">"IndexURI"</span>,ProfileMenuURI$<span class="st0">"?Page="</span>$Page$<span class="st0">"?SessionID="</span>$SID);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Load the main page into the frameset</span>
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"MainURI"</span>, Page$<span class="st0">"?SessionID="</span>$SID);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	ShowFrame(Res, DefaultPage);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> QuerySubFrame(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">string</span> Page, SID, TempStr, Action;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> Session CurS;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	CurS = SMaster.<span class="me0">getSession</span>(SID, <span class="kw6">true</span>);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	Action = Req.<span class="me0">GetVariable</span>(<span class="st0">"Actions"</span>,<span class="st0">"Add"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (Action ~= <span class="st0">"Modify"</span>)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li2">
<pre class="de2">
		TempStr = Req.<span class="me0">GetVariable</span>(<span class="st0">"ProfileNameSelect"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (TempStr != <span class="st0">""</span>) CreateSessionInfo(TempStr,SID,<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> <span class="kw2">if</span> (Action ~= <span class="st0">"Add"</span>)
</pre></li>
<li class="li2">
<pre class="de2">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = Req.<span class="me0">GetVariable</span>(<span class="st0">"TextInput"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (TempStr != <span class="st0">""</span>) CurS.<span class="me0">setValue</span>(<span class="st0">"ProfileName"</span>,TempStr,<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// if no page specified, use the default</span>
</pre></li>
<li class="li1">
<pre class="de1">
	Page = Req.<span class="me0">GetVariable</span>(<span class="st0">"Page"</span>, SubGameTypeURI);
</pre></li>
<li class="li1">
<pre class="de1">
	CurS.<span class="me0">setValue</span>(<span class="st0">"CurrentPage"</span>, Page, <span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Tell the SubMenu page which page we're viewing, so that it can highlight</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// the appropriate link</span>
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SubMenuURI"</span>, SubFrameMenuURI$<span class="st0">"?SessionID="</span>$SID);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Load the main page into the frameset</span>
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SubMainURI"</span>, Page$<span class="st0">"?SessionID="</span>$SID);
</pre></li>
<li class="li2">
<pre class="de2">
	ShowFrame(Res, SubFrame);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> QueryLadderMenu(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">string</span> SID;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">/*</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">If ?SessionID= is appended to the link, PreQuery() will not generate</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">a new Session when this link is queried</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">*/</span>
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Set URIs</span>
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Lv"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"ViewProfiles"</span>, <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$ProfileViewURI$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>main<span class="es0">\"</span>&gt;"</span>$LinkViewProfile$<span class="st0">"&lt;/a&gt;&lt;br /&gt;"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Le"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"EditProfiles"</span>, <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$ProfileEditURI$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>main<span class="es0">\"</span>&gt;"</span>$LinkEditProfile$<span class="st0">"&lt;/a&gt;&lt;br&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Ls"</span>))
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"SwitchProfiles"</span>, <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$ProfileSwitchURI$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>main<span class="es0">\"</span>&gt;"</span>$LinkSwitchProfile$<span class="st0">"&lt;/a&gt;&lt;br&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Lm"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"ManageProfiles"</span>, <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$ProfileManageURI$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>main<span class="es0">\"</span>&gt;"</span>$LinkManageProfile$<span class="st0">"&lt;/a&gt;&lt;br&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	ShowPage(Res, ProfileMenuURI);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> QuerySubMenu(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// Highlight the current page</span>
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> Highlighted, Background, SID;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> GameLink, MutatorLink, MapLink, RuleLink, ReviewLink;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> GameSpan, MutatorSpan, MapSpan, RuleSpan, ReviewSpan;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">string</span> Page;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> Session CurS;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Lm"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li2">
<pre class="de2">
		Highlighted = <span class="st0">"&lt;span class=<span class="es0">\"</span>blue<span class="es0">\"</span>&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		Background = <span class="st0">"&lt;span class=<span class="es0">\"</span>red<span class="es0">\"</span>&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		CurS = SMaster.<span class="me0">getSession</span>(SID, <span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="co1">// We are managing an existing profile</span>
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (CurS.<span class="me0">HasData</span>(<span class="st0">"ProfileIndex"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	    	Res.<span class="me0">Subst</span>(<span class="st0">"Section"</span>, LabelModifyProfile);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">else</span> Res.<span class="me0">Subst</span>(<span class="st0">"Section"</span>, LabelAddProfile);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Page = CurS.<span class="me0">getValue</span>(<span class="st0">"CurrentPage"</span>,SubGametypeURI);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Including ?SessionID= in link prevents PreQuery() from generating a new Session</span>
</pre></li>
<li class="li1">
<pre class="de1">
		GameLink = 		<span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$SubFrameURI$<span class="st0">"?SessionID="</span>$SID$<span class="st0">"?Page="</span>$SubGametypeURI$	<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_parent<span class="es0">\"</span>&gt;"</span>;
</pre></li>
<li class="li2">
<pre class="de2">
		MutatorLink = 	<span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$SubFrameURI$<span class="st0">"?SessionID="</span>$SID$<span class="st0">"?Page="</span>$SubMutatorsURI$	<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_parent<span class="es0">\"</span>&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		MapLink = 		<span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$SubFrameURI$<span class="st0">"?SessionID="</span>$SID$<span class="st0">"?Page="</span>$SubMapsURI$		<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_parent<span class="es0">\"</span>&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		RuleLink = 		<span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$SubFrameURI$<span class="st0">"?SessionID="</span>$SID$<span class="st0">"?Page="</span>$SubRulesURI$	<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_parent<span class="es0">\"</span>&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		ReviewLink = 	<span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$SubFrameURI$<span class="st0">"?SessionID="</span>$SID$<span class="st0">"?Page="</span>$SubReviewURI$	<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_parent<span class="es0">\"</span>&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="co1">// Initially set all spans to the background color</span>
</pre></li>
<li class="li1">
<pre class="de1">
		GameSpan 	= Background;
</pre></li>
<li class="li1">
<pre class="de1">
		MutatorSpan = Background;
</pre></li>
<li class="li1">
<pre class="de1">
		MapSpan 	= Background;
</pre></li>
<li class="li1">
<pre class="de1">
		RuleSpan 	= Background;
</pre></li>
<li class="li2">
<pre class="de2">
		ReviewSpan 	= Background;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="co1">// Then set the appropriate span to the highlighted color</span>
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SubTitle"</span>, CurS.<span class="me0">GetValue</span>(<span class="st0">"ProfileName"</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">switch</span> (Page)
</pre></li>
<li class="li2">
<pre class="de2">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">case</span> SubGametypeURI:
</pre></li>
<li class="li1">
<pre class="de1">
				Curs.<span class="me0">SetValue</span>(<span class="st0">"ButtonName"</span>,		ProfileButtonName[<span class="nu0">1</span>],<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				Curs.<span class="me0">SetValue</span>(<span class="st0">"ButtonValue"</span>, 	ProfileButtonValue[<span class="nu0">1</span>],<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
				Res.<span class="me0">Subst</span>(<span class="st0">"PageHelp"</span>, HelpGameType);
</pre></li>
<li class="li1">
<pre class="de1">
				GameSpan = Highlighted; <span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">case</span> SubMutatorsURI:
</pre></li>
<li class="li1">
<pre class="de1">
				Curs.<span class="me0">SetValue</span>(<span class="st0">"ButtonName"</span>, 	ProfileButtonName[<span class="nu0">2</span>],<span class="kw6">true</span>);
</pre></li>
<li class="li2">
<pre class="de2">
				Curs.<span class="me0">SetValue</span>(<span class="st0">"ButtonValue"</span>, 	ProfileButtonValue[<span class="nu0">2</span>],<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"PageHelp"</span>, HelpMutators);
</pre></li>
<li class="li1">
<pre class="de1">
				MutatorSpan = Highlighted; <span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">case</span> SubMapsURI:
</pre></li>
<li class="li1">
<pre class="de1">
				Curs.<span class="me0">SetValue</span>(<span class="st0">"ButtonName"</span>, 	ProfileButtonName[<span class="nu0">3</span>],<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				Curs.<span class="me0">SetValue</span>(<span class="st0">"ButtonValue"</span>, 	ProfileButtonValue[<span class="nu0">3</span>],<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"PageHelp"</span>, HelpMaps);
</pre></li>
<li class="li2">
<pre class="de2">
				Mapspan = Highlighted; <span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">case</span> SubRulesURI:
</pre></li>
<li class="li1">
<pre class="de1">
				Curs.<span class="me0">SetValue</span>(<span class="st0">"ButtonName"</span>, 	ProfileButtonName[<span class="nu0">4</span>],<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				Curs.<span class="me0">SetValue</span>(<span class="st0">"ButtonValue"</span>, 	ProfileButtonValue[<span class="nu0">4</span>],<span class="kw6">true</span>);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"PageHelp"</span>, HelpPlayInfo);
</pre></li>
<li class="li1">
<pre class="de1">
				RuleSpan = Highlighted; <span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">case</span> SubReviewURI:
</pre></li>
<li class="li2">
<pre class="de2">
				Curs.<span class="me0">SetValue</span>(<span class="st0">"ButtonName"</span>, 	ProfileButtonName[<span class="nu0">5</span>],<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				Curs.<span class="me0">SetValue</span>(<span class="st0">"ButtonValue"</span>, 	ProfileButtonValue[<span class="nu0">5</span>],<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"PageHelp"</span>, HelpReview);
</pre></li>
<li class="li1">
<pre class="de1">
				ReviewSpan = Highlighted; <span class="kw2">break</span>;
</pre></li>
<li class="li2">
<pre class="de2">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		GameLink 	= GameLink 		$ GameSpan 		$ TableTitle[<span class="nu0">1</span>]$<span class="st0">"&lt;/span&gt;&lt;/a&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		MutatorLink = MutatorLink 	$ MutatorSpan 	$ TableTitle[<span class="nu0">2</span>]$<span class="st0">"&lt;/span&gt;&lt;/a&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		MapLink 	= MapLink 		$ MapSpan 		$ TableTitle[<span class="nu0">3</span>]$<span class="st0">"&lt;/span&gt;&lt;/a&gt;"</span>;
</pre></li>
<li class="li2">
<pre class="de2">
		RuleLink 	= RuleLink 		$ RuleSpan 		$ TableTitle[<span class="nu0">4</span>]$<span class="st0">"&lt;/span&gt;&lt;/a&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		ReviewLink 	= ReviewLink 	$ ReviewSpan 	$ TableTitle[<span class="nu0">5</span>]$<span class="st0">"&lt;/span&gt;&lt;/a&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"GameTypeLink"</span>, 	GameLink);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"MutatorsLink"</span>, 	MutatorLink);
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"MapsLink"</span>, 		MapLink);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"RulesLink"</span>, 		RuleLink);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"ReviewLink"</span>, 	ReviewLink);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		ShowPage(Res, SubFrameMenu);
</pre></li>
<li class="li2">
<pre class="de2">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> AccessDenied(Res);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">function</span> QueryLadderView(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i,j;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> Session 	CurS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span>	SID,
</pre></li>
<li class="li2">
<pre class="de2">
					TempStr,
</pre></li>
<li class="li1">
<pre class="de1">
					ViewRows,
</pre></li>
<li class="li1">
<pre class="de1">
					NewProfile,
</pre></li>
<li class="li1">
<pre class="de1">
					NewGameType;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> StringArray 			Mutators, GroupsOnly, ServerActors;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;GameInfo&gt; 		GI<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;AccessControl&gt; 	AC<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;Mutator&gt;		TempMut;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;Info&gt;			TempSA;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Lv"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		CurS = SMaster.<span class="me0">getSession</span>(SID,<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (CanPerform(<span class="st0">"Ls"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(<span class="st0">"SetProfileName"</span>,<span class="st0">""</span>)!=<span class="st0">""</span>) <span class="co1">// We would like to view a different profile</span>
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = Req.<span class="me0">GetVariable</span>(<span class="st0">"ProfileNameSelect"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">If</span> (TempStr == <span class="st0">""</span>)	<span class="co1">// Not selecting a new profile to view</span>
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="co1">// First, see if the current session is holding a profile</span>
</pre></li>
<li class="li1">
<pre class="de1">
				NewProfile = CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileIndex"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (NewProfile == <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="co1">// See if a profile is currently loaded</span>
</pre></li>
<li class="li2">
<pre class="de2">
					j = GetCurrentConfigIndex();
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (j!=-<span class="nu0">1</span>)		<span class="co1">// Found an active profile - this profile should be selected</span>
</pre></li>
<li class="li1">
<pre class="de1">
						NewProfile = <span class="kw5">string</span>(j);
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempStr!=<span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				NewProfile = TempStr;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"ButtonName"</span>, <span class="st0">"SetProfileName"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			Res.<span class="me0">Subst</span>(<span class="st0">"ButtonValue"</span>, ButtonLoadProfile);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"PageCaption"</span>, <span class="st0">"&lt;select class=mini name='ProfileNameSelect'&gt;"</span>$GenerateSwitchProfileOptions(NewProfile)$<span class="st0">"&lt;/select&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// If admin doesn't have switch privileges, check for current profile</span>
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">if</span> (NewProfile == <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			NewProfile = CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileIndex"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (NewProfile == <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li2">
<pre class="de2">
				j = GetCurrentConfigIndex();
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (j != -<span class="nu0">1</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					NewProfile = <span class="kw5">string</span>(j);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (NewProfile != <span class="st0">""</span> &amp;&amp; LadderRules.<span class="me0">AllLadderProfiles</span>.<span class="me0">Count</span>() &gt; <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			CurS.<span class="me0">setValue</span>(<span class="st0">"ProfileIndex"</span>, NewProfile, <span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
            CreateSessionInfo(NewProfile,SID);
</pre></li>
<li class="li2">
<pre class="de2">
			NewGameType = CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (NewGameType != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				GIClass = class&lt;GameInfo&gt;(<span class="kw3">DynamicLoadObject</span>(NewGameType,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (GIClass==<span class="kw5">None</span>)
</pre></li>
<li class="li2">
<pre class="de2">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				ShowMessage(Res,ErrorGameClassTitle,ErrorGameClassText);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"ACClass"</span>,<span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">AccessControlClass</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				ACClass = class&lt;AccessControl&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (ACClass == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li2">
<pre class="de2">
				ShowMessage(Res,ErrorAccessControlTitle,ErrorAccessControlText);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			Mutators = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li2">
<pre class="de2">
			GroupsOnly = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			ServerActors = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="co1">// Mutator Section</span>
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getMutatorLength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li2">
<pre class="de2">
			    TempStr = CurS.<span class="me0">getMutator</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
                <span class="kw2">for</span> (j=<span class="nu0">0</span>;j&lt;AllMutators.<span class="me0">Length</span>;j++)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (TempStr ~= AllMutators[j].<span class="me0">ClassName</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li2">
<pre class="de2">
						TempMut = class&lt;Mutator&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">if</span> (TempMut != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
							Mutators.<span class="me0">Add</span>(<span class="kw5">string</span>(j), AllMutators[j].<span class="me0">FriendlyName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li2">
<pre class="de2">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getSALength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = CurS.<span class="me0">GetServerActor</span>(i);
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">for</span> (j=<span class="nu0">0</span>;j&lt;ConfigM.<span class="me0">ManagedActors</span>.<span class="me0">Length</span>;j++)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (TempStr ~= <span class="kw5">string</span>(ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SAClass</span>))
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						TempSA = class&lt;Info&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li2">
<pre class="de2">
						<span class="kw2">if</span> (TempSA != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
							ServerActors.<span class="me0">Add</span>(<span class="kw5">string</span>(j),ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SAName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, TableTitle[<span class="nu0">2</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			ViewRows = ViewRows$WebInclude(IncludeSection);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">for</span> (i = <span class="nu0">0</span>; i&lt;ServerActors.<span class="me0">Count</span>(); i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				j = <span class="kw5">int</span>(ServerActors.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, ServerActors.<span class="me0">GetTag</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (CurS.<span class="me0">SARequired</span>(<span class="kw5">string</span>(ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SAClass</span>)))
</pre></li>
<li class="li2">
<pre class="de2">
					Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, RequiredText);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span> Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				ViewRows = ViewRows $ WebInclude(IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
			ViewRows = ViewRows $ <span class="st0">"&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;&amp;nbsp;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span>;
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">for</span> (i = <span class="nu0">0</span>; i&lt;Mutators.<span class="me0">Count</span>(); i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				j = <span class="kw5">int</span>(Mutators.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, AllMutators[j].<span class="me0">FriendlyName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (CurS.<span class="me0">MutRequired</span>(AllMutators[j].<span class="me0">ClassName</span>))
</pre></li>
<li class="li2">
<pre class="de2">
					Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, RequiredText);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span> Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				ViewRows = ViewRows$WebInclude(IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, TableTitle[<span class="nu0">3</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			ViewRows = ViewRows$WebInclude(IncludeSection);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, LabelMaxMaps);
</pre></li>
<li class="li2">
<pre class="de2">
			TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"MaxMaps"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempStr == <span class="st0">"0"</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = UnlimitedText;
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>, <span class="st0">"&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;&amp;nbsp;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			ViewRows = ViewRows$WebInclude(IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getMapLength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
                TempStr = CurS.<span class="me0">getMap</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
                Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, TempStr);
</pre></li>
<li class="li2">
<pre class="de2">
				Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (CurS.<span class="me0">MapRequired</span>(TempStr))
</pre></li>
<li class="li1">
<pre class="de1">
					Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, RequiredText);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span> Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
				ViewRows = ViewRows$WebInclude(IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, TableTitle[<span class="nu0">4</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			ViewRows = ViewRows $ WebInclude(IncludeSection);
</pre></li>
<li class="li1">
<pre class="de1">
			ViewRows = ViewRows $ <span class="st0">"&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span> $ GeneratePlayInfoRows(Req, Res, IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// We have no profile currently active</span>
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">else</span>
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, PageCaption[<span class="nu0">0</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
			ViewRows = ViewRows $ WebInclude(IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>, PageCaption[<span class="nu0">0</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (LadderRules.<span class="me0">GetRemainingMatches</span>() &gt; <span class="nu0">0</span> &amp;&amp; TempStr == LadderRules.<span class="me0">Profiles</span>[GetCurrentConfigIndex()].<span class="me0">ProfileName</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = TempStr @ LabelNumberMatchesLeft @ <span class="kw5">string</span>(LadderRules.<span class="me0">GetRemainingMatches</span>());
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"TableRows"</span>, ViewRows);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"LadderTable"</span>, WebInclude(IncludeCaptionButton)$WebInclude(IncludeTable));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"Section"</span>, LinkViewProfile);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SubTitle"</span>, TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PageHelp"</span>, HelpViewProfile);
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"PostAction"</span>, ProfileViewURI$<span class="st0">"?SessionID="</span>$SID);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		ShowPage(Res, MasterPage);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">else</span> AccessDenied(Res);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> QueryLadderEdit(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> Session CurS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">bool</span> 	bAllMuts;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> 	i,j,k,z,
</pre></li>
<li class="li1">
<pre class="de1">
				id,
</pre></li>
<li class="li1">
<pre class="de1">
				Count,
</pre></li>
<li class="li2">
<pre class="de2">
				MoveCount;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span>	SID,
</pre></li>
<li class="li1">
<pre class="de1">
					EditRows,
</pre></li>
<li class="li1">
<pre class="de1">
					TempStr, Tmp, NewProfile, NewGameType,
</pre></li>
<li class="li2">
<pre class="de2">
					lastgroup, thisgroup, nextgroup, EmptyRow;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> ProfileConfigSet 		TempPCS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;string&gt; 		TempMutes;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;GameInfo&gt; 		GI<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> class&lt;AccessControl&gt; 	AC<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;ProfileConfigSet.<span class="me0">ProfileMap</span>&gt; 		AllPCSMaps;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;ProfileConfigSet.<span class="me0">ProfileMutator</span>&gt; 	AllPCSMutators;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;ProfileConfigSet.<span class="me0">ProfileSA</span>&gt;			AllPCSServerActors;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> StringArray
</pre></li>
<li class="li2">
<pre class="de2">
				Mutators, GroupsOnly, Required, ServerActors, ReqSA,
</pre></li>
<li class="li1">
<pre class="de1">
				RequiredMaps, IncludeMaps, ExcludeMaps, MovedMaps;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	CurS = SMaster.<span class="me0">getSession</span>(SID,<span class="kw6">true</span>);
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Le"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (CanPerform(<span class="st0">"Ls"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(<span class="st0">"SetProfileName"</span>,<span class="st0">""</span>)!=<span class="st0">""</span>) <span class="co1">// We would like to view a different profile</span>
</pre></li>
<li class="li2">
<pre class="de2">
				TempStr = Req.<span class="me0">GetVariable</span>(<span class="st0">"ProfileNameSelect"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">If</span> (TempStr == <span class="st0">""</span>)	<span class="co1">// Not selecting a new profile to view</span>
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="co1">// First, see if the current session is holding a profile</span>
</pre></li>
<li class="li2">
<pre class="de2">
				NewProfile = CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileIndex"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (NewProfile == <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="co1">// See if a profile is currently loaded</span>
</pre></li>
<li class="li2">
<pre class="de2">
					j = GetCurrentConfigIndex();
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (j!=-<span class="nu0">1</span>)		<span class="co1">// Found an active profile - this profile should be selected</span>
</pre></li>
<li class="li1">
<pre class="de1">
						NewProfile = <span class="kw5">string</span>(j);
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempStr!=<span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				NewProfile = TempStr;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			Res.<span class="me0">Subst</span>(<span class="st0">"ButtonName"</span>, <span class="st0">"SetProfileName"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"ButtonValue"</span>, ButtonLoadProfile);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"PageCaption"</span>, <span class="st0">"&lt;select class=mini name='ProfileNameSelect'&gt;"</span>$GenerateSwitchProfileOptions(NewProfile)$<span class="st0">"&lt;/select&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
		CurS.<span class="me0">setValue</span>(<span class="st0">"CurrentPage"</span>, ProfileEditURI, <span class="kw6">true</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		CurS.<span class="me0">setValue</span>(<span class="st0">"ButtonName"</span>, <span class="st0">"ApplyProfileChanges"</span>,<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		CurS.<span class="me0">setValue</span>(<span class="st0">"ButtonValue"</span>, ButtonApplyProfileChanges, <span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// If admin doesn't have switch privileges, check for current profile</span>
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (NewProfile == <span class="st0">""</span>)
</pre></li>
<li class="li2">
<pre class="de2">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			NewProfile = CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileIndex"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (NewProfile == <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				j = GetCurrentConfigIndex();
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">if</span> (j != -<span class="nu0">1</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					NewProfile = <span class="kw5">string</span>(j);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		CurS.<span class="me0">setValue</span>(<span class="st0">"ProfileIndex"</span>, NewProfile, <span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (NewProfile != <span class="st0">""</span> &amp;&amp; LadderRules.<span class="me0">AllLadderProfiles</span>.<span class="me0">Count</span>() &gt; <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			ProfileMaps.<span class="kw4">Reset</span>();
</pre></li>
<li class="li1">
<pre class="de1">
			Required = <span class="kw1">new</span>(<span class="kw5">None</span>) 		<span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li2">
<pre class="de2">
			ReqSA	= <span class="kw1">new</span>(<span class="kw5">None</span>)			<span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			Mutators = <span class="kw1">new</span>(<span class="kw5">None</span>) 		<span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			MovedMaps = <span class="kw1">new</span>(<span class="kw5">None</span>) 		<span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			GroupsOnly = <span class="kw1">new</span>(<span class="kw5">None</span>) 		<span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			ServerActors = <span class="kw1">new</span>(<span class="kw5">None</span>)	<span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li2">
<pre class="de2">
			IncludeMaps = <span class="kw1">new</span>(<span class="kw5">None</span>) 	<span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			ExcludeMaps = <span class="kw1">new</span>(<span class="kw5">None</span>) 	<span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			RequiredMaps = <span class="kw1">new</span>(<span class="kw5">None</span>) 	<span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
            CreateSessionInfo(NewProfile,SID);
</pre></li>
<li class="li2">
<pre class="de2">
			TempPCS = LadderRules.<span class="me0">LadderProfiles</span>[<span class="kw5">int</span>(NewProfile)];
</pre></li>
<li class="li1">
<pre class="de1">
			TempPCS.<span class="me0">StartEdit</span>();
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			NewGameType = CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			GIClass = class&lt;GameInfo&gt;(<span class="kw3">DynamicLoadObject</span>(NewGameType,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">if</span> (GIClass==<span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				ShowMessage(Res,ErrorGameClassTitle,ErrorGameClassText);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"ACClass"</span>, <span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">AccessControlClass</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				ACClass = class&lt;AccessControl&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
			AllPCSMutators = TempPCS.<span class="me0">GetProfileMutators</span>();
</pre></li>
<li class="li2">
<pre class="de2">
			AllPCSMaps = TempPCS.<span class="me0">GetProfileMaps</span>();
</pre></li>
<li class="li1">
<pre class="de1">
			AllPCSServerActors = TempPCS.<span class="me0">GetProfileServerActors</span>();
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Load Exclude Maps</span>
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;AllPCSMaps.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li2">
<pre class="de2">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				ProfileMaps.<span class="me0">Add</span>(<span class="kw5">string</span>(i), AllPCSMaps[i].<span class="me0">MapName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (AllPCSMaps[i].<span class="me0">bRequired</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					RequiredMaps.<span class="me0">Add</span>(<span class="kw5">string</span>(i),<span class="kw5">string</span>(AllPCSMaps[i].<span class="me0">MapListOrder</span>));
</pre></li>
<li class="li2">
<pre class="de2">
					IncludeMaps.<span class="me0">Add</span>(<span class="kw5">string</span>(i),<span class="kw5">string</span>(AllPCSMaps[i].<span class="me0">MapListOrder</span>));
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span> ExcludeMaps.<span class="me0">Add</span>(<span class="kw5">string</span>(i),<span class="kw5">string</span>(AllPCSMaps[i].<span class="me0">MapListOrder</span>));
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">GetMapLength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				j = ExcludeMaps.<span class="me0">FindItemId</span>(ProfileMaps.<span class="me0">GetItem</span>(ProfileMaps.<span class="me0">FindTagId</span>(CurS.<span class="me0">getMap</span>(i))));
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (j &gt;= <span class="nu0">0</span>) IncludeMaps.<span class="me0">MoveFromId</span>(ExcludeMaps, j);
</pre></li>
<li class="li2">
<pre class="de2">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(<span class="st0">"ApplyProfileChanges"</span>,<span class="st0">""</span>)!=<span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;AllPCSMutators.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li2">
<pre class="de2">
					<span class="kw2">for</span> (j=<span class="nu0">0</span>;j&lt;AllMutators.<span class="me0">Length</span>;j++)
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">if</span> (AllPCSMutators[i].<span class="me0">MutatorName</span> ~= AllMutators[j].<span class="me0">ClassName</span>)
</pre></li>
<li class="li1">
<pre class="de1">
							Mutators.<span class="me0">Add</span>(<span class="kw5">string</span>(j),AllPCSMutators[i].<span class="me0">MutatorName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;Mutators.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li2">
<pre class="de2">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> ((Req.<span class="me0">GetVariable</span>(Mutators.<span class="me0">GetTag</span>(i),<span class="st0">""</span>)!=<span class="st0">""</span>)||(Req.<span class="me0">GetVariable</span>(AllMutators[<span class="kw5">int</span>(Mutators.<span class="me0">GetItem</span>(i))].<span class="me0">GroupName</span>)~=Mutators.<span class="me0">GetTag</span>(i)))
</pre></li>
<li class="li1">
<pre class="de1">
						TempPCS.<span class="me0">AddMutator</span>(Mutators.<span class="me0">GetTag</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">else</span> TempPCS.<span class="me0">DelMutator</span>(Mutators.<span class="me0">GetTag</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;AllPCSServerActors.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(AllPCSServerActors[i].<span class="me0">ActorClass</span>,<span class="st0">""</span>) != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
						TempPCS.<span class="me0">AddServerActor</span>(AllPCSServerActors[i].<span class="me0">ActorClass</span>);
</pre></li>
<li class="li2">
<pre class="de2">
					<span class="kw2">else</span> TempPCS.<span class="me0">DelServerActor</span>(AllPCSServerActors[i].<span class="me0">ActorClass</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;AllPCSMaps.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li2">
<pre class="de2">
					<span class="kw2">if</span> (AllPCSMaps[i].<span class="me0">bRequired</span>) TempPCS.<span class="me0">AddMap</span>(AllPCSMaps[i].<span class="me0">MapName</span>,<span class="kw5">int</span>(RequiredMaps.<span class="me0">GetTag</span>(RequiredMaps.<span class="me0">FindItemId</span>(<span class="kw5">string</span>(i)))));
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">else</span> <span class="kw2">if</span> (IncludeMaps.<span class="me0">FindItemId</span>(<span class="kw5">string</span>(i)) &gt;= <span class="nu0">0</span>) TempPCS.<span class="me0">AddMap</span>(AllPCSMaps[i].<span class="me0">MapName</span>,<span class="kw5">int</span>(IncludeMaps.<span class="me0">GetTag</span>(IncludeMaps.<span class="me0">FindItemId</span>(<span class="kw5">string</span>(i)))));
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">else</span> TempPCS.<span class="me0">RemoveMap</span>(AllPCSMaps[i].<span class="me0">MapName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
                CreateSessionInfo(NewProfile,SID,<span class="kw6">false</span>,<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> <span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(<span class="st0">"AddMap"</span>, <span class="st0">""</span>) != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				Count = Req.<span class="me0">GetVariableCount</span>(<span class="st0">"ExcludeMapsSelect"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">for</span> (i=<span class="nu0">0</span>; i&lt;Count; i++)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (IncludeMaps.<span class="me0">Count</span>() &gt;= TempPCS.<span class="me0">MaxMaps</span> &amp;&amp; TempPCS.<span class="me0">MaxMaps</span> &gt; <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (ExcludeMaps.<span class="me0">Count</span>() &gt; <span class="nu0">0</span>)
</pre></li>
<li class="li2">
<pre class="de2">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						id = IncludeMaps.<span class="me0">MoveFromId</span>(ExcludeMaps, ExcludeMaps.<span class="me0">FindItemId</span>(ProfileMaps.<span class="me0">GetItem</span>(ProfileMaps.<span class="me0">FindTagId</span>(Req.<span class="me0">GetVariableNumber</span>(<span class="st0">"ExcludeMapsSelect"</span>, i)))));
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">if</span> (id &gt;= <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
						{
</pre></li>
<li class="li1">
<pre class="de1">
							TempPCS.<span class="me0">AddMap</span>(AllPCSMaps[<span class="kw5">int</span>(IncludeMaps.<span class="me0">getItem</span>(id))].<span class="me0">MapName</span>,<span class="kw5">int</span>(IncludeMaps.<span class="me0">getTag</span>(id)));
</pre></li>
<li class="li2">
<pre class="de2">
							MovedMaps.<span class="me0">CopyFromId</span>(IncludeMaps, id);
</pre></li>
<li class="li1">
<pre class="de1">
						}
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">else</span>
</pre></li>
<li class="li1">
<pre class="de1">
							<span class="kw3">Log</span>(ErrorExcludeMapNotFound@Req.<span class="me0">GetVariableNumber</span>(<span class="st0">"ExcludeMapsSelect"</span>, i),LOGNAME);
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li2">
<pre class="de2">
				}
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;IncludeMaps.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
					TempPCS.<span class="me0">AddMap</span>(AllPCSMaps[<span class="kw5">int</span>(IncludeMaps.<span class="me0">getItem</span>(i))].<span class="me0">MapName</span>,i);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
                CreateSessionInfo(NewProfile,SID,<span class="kw6">false</span>,<span class="kw6">true</span>,<span class="kw6">True</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> <span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(<span class="st0">"DelMap"</span>, <span class="st0">""</span>) != <span class="st0">""</span> &amp;&amp; Req.<span class="me0">GetVariableCount</span>(<span class="st0">"IncludeMapsSelect"</span>) &gt; <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				Count = Req.<span class="me0">GetVariableCount</span>(<span class="st0">"IncludeMapsSelect"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">for</span> (i=<span class="nu0">0</span>; i&lt;Count; i++)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (RequiredMaps.<span class="me0">FindItemId</span>(ProfileMaps.<span class="me0">GetItem</span>(ProfileMaps.<span class="me0">FindTagId</span>(Req.<span class="me0">GetVariableNumber</span>(<span class="st0">"IncludeMapsSelect"</span>, i)))) &lt; <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">if</span> (IncludeMaps.<span class="me0">Count</span>() &gt; <span class="nu0">0</span>)
</pre></li>
<li class="li2">
<pre class="de2">
						{
</pre></li>
<li class="li1">
<pre class="de1">
							id = ExcludeMaps.<span class="me0">MoveFromId</span>(IncludeMaps, IncludeMaps.<span class="me0">FindItemId</span>(ProfileMaps.<span class="me0">GetItem</span>(ProfileMaps.<span class="me0">FindTagId</span>(Req.<span class="me0">GetVariableNumber</span>(<span class="st0">"IncludeMapsSelect"</span>, i)))));
</pre></li>
<li class="li1">
<pre class="de1">
							<span class="kw2">if</span> (id &gt;= <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
							{
</pre></li>
<li class="li1">
<pre class="de1">
								TempPCS.<span class="me0">RemoveMap</span>(AllPCSMaps[<span class="kw5">int</span>(ExcludeMaps.<span class="me0">GetItem</span>(id))].<span class="me0">MapName</span>);
</pre></li>
<li class="li2">
<pre class="de2">
								MovedMaps.<span class="me0">CopyFromId</span>(ExcludeMaps, id);
</pre></li>
<li class="li1">
<pre class="de1">
							}
</pre></li>
<li class="li1">
<pre class="de1">
							<span class="kw2">else</span>
</pre></li>
<li class="li1">
<pre class="de1">
								<span class="kw3">Log</span>(ErrorIncludeMapNotFound@Req.<span class="me0">GetVariableNumber</span>(<span class="st0">"IncludeMapsSelect"</span>, i),LOGNAME);
</pre></li>
<li class="li1">
<pre class="de1">
						}
</pre></li>
<li class="li2">
<pre class="de2">
					}
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
                CreateSessionInfo(NewProfile,SID,<span class="kw6">false</span>,<span class="kw6">true</span>,<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> <span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(<span class="st0">"AddAllMap"</span>, <span class="st0">""</span>) != <span class="st0">""</span>)
</pre></li>
<li class="li2">
<pre class="de2">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">while</span> (ExcludeMaps.<span class="me0">Count</span>() &gt; <span class="nu0">0</span> &amp;&amp; (IncludeMaps.<span class="me0">Count</span>() &lt; TempPCS.<span class="me0">MaxMaps</span> || TempPCS.<span class="me0">MaxMaps</span> == <span class="nu0">0</span>) )
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					id = IncludeMaps.<span class="me0">MoveFromId</span>(ExcludeMaps, ExcludeMaps.<span class="me0">Count</span>()-<span class="nu0">1</span>);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (id &gt;= <span class="nu0">0</span>)
</pre></li>
<li class="li2">
<pre class="de2">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						TempPCS.<span class="me0">AddMap</span>(AllPCSMaps[<span class="kw5">int</span>(IncludeMaps.<span class="me0">getItem</span>(id))].<span class="me0">MapName</span>,<span class="kw5">int</span>(IncludeMaps.<span class="me0">getTag</span>(id)));
</pre></li>
<li class="li1">
<pre class="de1">
						MovedMaps.<span class="me0">CopyFromId</span>(IncludeMaps, id);
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;IncludeMaps.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
					TempPCS.<span class="me0">AddMap</span>(AllPCSMaps[<span class="kw5">int</span>(IncludeMaps.<span class="me0">getItem</span>(i))].<span class="me0">MapName</span>,i);
</pre></li>
<li class="li1">
<pre class="de1">
               CreateSessionInfo(NewProfile,SID,<span class="kw6">false</span>,<span class="kw6">true</span>,<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> <span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(<span class="st0">"DelAllMap"</span>, <span class="st0">""</span>) != <span class="st0">""</span>)
</pre></li>
<li class="li2">
<pre class="de2">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				i = IncludeMaps.<span class="me0">Count</span>();
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">while</span> (i &gt; <span class="nu0">0</span> &amp;&amp; IncludeMaps.<span class="me0">Count</span>() &gt; RequiredMaps.<span class="me0">Count</span>())
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (RequiredMaps.<span class="me0">FindItemId</span>(IncludeMaps.<span class="me0">GetItem</span>(i-<span class="nu0">1</span>)) &lt; <span class="nu0">0</span>)
</pre></li>
<li class="li2">
<pre class="de2">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						id =  ExcludeMaps.<span class="me0">MoveFromId</span>(IncludeMaps, i-<span class="nu0">1</span>);
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">if</span> (id &gt;= <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
						{
</pre></li>
<li class="li1">
<pre class="de1">
							TempPCS.<span class="me0">RemoveMap</span>(AllPCSMaps[<span class="kw5">int</span>(ExcludeMaps.<span class="me0">GetItem</span>(id))].<span class="me0">MapName</span>);
</pre></li>
<li class="li2">
<pre class="de2">
							MovedMaps.<span class="me0">CopyFromId</span>(ExcludeMaps, id);
</pre></li>
<li class="li1">
<pre class="de1">
						}
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
					i--;
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li2">
<pre class="de2">
                CreateSessionInfo(NewProfile,SID,<span class="kw6">false</span>,<span class="kw6">true</span>,<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> <span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(<span class="st0">"MoveMap"</span>, <span class="st0">""</span>) != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				MoveCount = <span class="kw5">int</span>(<span class="kw3">Abs</span>(<span class="kw5">float</span>(Req.<span class="me0">GetVariable</span>(<span class="st0">"MoveMapCount"</span>))));
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">if</span> (MoveCount != <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					Count = Req.<span class="me0">GetVariableCount</span>(<span class="st0">"IncludeMapsSelect"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="co1">// 1) Create a sorted MovedMaps list</span>
</pre></li>
<li class="li2">
<pre class="de2">
					<span class="kw2">for</span> (i = <span class="nu0">0</span>; i&lt;Count; i++)
</pre></li>
<li class="li1">
<pre class="de1">
						MovedMaps.<span class="me0">CopyFromId</span>(IncludeMaps, IncludeMaps.<span class="me0">FindItemId</span>(ProfileMaps.<span class="me0">GetItem</span>(ProfileMaps.<span class="me0">FindTagId</span>(Req.<span class="me0">GetVariableNumber</span>(<span class="st0">"IncludeMapsSelect"</span>, i)))));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(<span class="st0">"MoveMap"</span>) ~= <span class="st0">"Down"</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li2">
<pre class="de2">
						<span class="co1">// 2) Browse from Last to 0 until all maps are moved by count</span>
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="co1">//    but stop moving them if hitting bottom</span>
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">for</span> (i = IncludeMaps.<span class="me0">Count</span>()-<span class="nu0">1</span>; i &gt;= <span class="nu0">0</span>; i--)
</pre></li>
<li class="li1">
<pre class="de1">
							<span class="kw2">if</span> (MovedMaps.<span class="me0">FindItemId</span>(IncludeMaps.<span class="me0">GetItem</span>(i)) &gt;= <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
								IncludeMaps.<span class="me0">ShiftStrict</span>(i, MoveCount);
</pre></li>
<li class="li2">
<pre class="de2">
					}
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">else</span>
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						MoveCount = -MoveCount;
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">for</span> (i = <span class="nu0">0</span>; i&lt;IncludeMaps.<span class="me0">Count</span>(); i++)
</pre></li>
<li class="li2">
<pre class="de2">
							<span class="kw2">if</span> (MovedMaps.<span class="me0">FindItemId</span>(IncludeMaps.<span class="me0">GetItem</span>(i)) &gt;= <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
								IncludeMaps.<span class="me0">ShiftStrict</span>(i, MoveCount);
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;IncludeMaps.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
					TempPCS.<span class="me0">AddMap</span>(AllPCSMaps[<span class="kw5">int</span>(IncludeMaps.<span class="me0">getItem</span>(i))].<span class="me0">MapName</span>,i);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
                CreateSessionInfo(NewProfile,SID,<span class="kw6">false</span>,<span class="kw6">true</span>,<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempPCS.<span class="me0">CanEdit</span>())
</pre></li>
<li class="li1">
<pre class="de1">
				TempPCS.<span class="me0">StartEdit</span>();
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Mutator Section</span>
</pre></li>
<li class="li1">
<pre class="de1">
			Mutators.<span class="kw4">Reset</span>();
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="co1">// Set active ServerActors</span>
</pre></li>
<li class="li1">
<pre class="de1">
			TempMutes = LoadActiveProfileServerActors(NewProfile);
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = <span class="kw1">class</span><span class="st0">'wUtils103.wArray'</span>.<span class="kw1">static</span>.<span class="me0">Join</span>(TempMutes,<span class="st0">","</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			bAllMuts = TempMutes.<span class="me0">Length</span> == ConfigM.<span class="me0">ManagedActors</span>.<span class="me0">Length</span>;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;AllPCSServerActors.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">for</span> (j = <span class="nu0">0</span>; j &lt; ConfigM.<span class="me0">ManagedActors</span>.<span class="me0">Length</span>; j++)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li2">
<pre class="de2">
					<span class="kw2">if</span> (AllPCSServerActors[i].<span class="me0">ActorClass</span> ~= <span class="kw5">string</span>(ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SAClass</span>))
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">if</span> (AllPCSServerActors[i].<span class="me0">bRequired</span>)
</pre></li>
<li class="li1">
<pre class="de1">
							ReqSA.<span class="me0">Add</span>(<span class="kw5">string</span>(j), ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SAName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">else</span> ServerActors.<span class="me0">Add</span>(<span class="kw5">string</span>(j),ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SAName</span>);
</pre></li>
<li class="li2">
<pre class="de2">
						<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
			TempMutes = LoadActiveProfileMutators(NewProfile);
</pre></li>
<li class="li2">
<pre class="de2">
			TempStr = <span class="kw1">class</span><span class="st0">'wUtils103.wArray'</span>.<span class="kw1">static</span>.<span class="me0">Join</span>(TempMutes,<span class="st0">","</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="co1">// Set Available Mutators for this profile</span>
</pre></li>
<li class="li1">
<pre class="de1">
			bAllMuts = bAllMuts &amp;&amp; AllPCSMutators.<span class="me0">Length</span> == AllMutators.<span class="me0">Length</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;AllPCSMutators.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">for</span> (j=<span class="nu0">0</span>;j&lt;AllMutators.<span class="me0">Length</span>;j++)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (AllMutators[j].<span class="me0">ClassName</span> ~= AllPCSMutators[i].<span class="me0">MutatorName</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">if</span> (AllPCSMutators[i].<span class="me0">bRequired</span>)
</pre></li>
<li class="li2">
<pre class="de2">
							Required.<span class="me0">Add</span>(<span class="kw5">string</span>(j),AllMutators[j].<span class="me0">FriendlyName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">else</span>
</pre></li>
<li class="li1">
<pre class="de1">
						{
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="co1">// Don't add available mutator if it belongs in the same group as a required mutator</span>
</pre></li>
<li class="li1">
<pre class="de1">
							<span class="kw2">for</span> (k=<span class="nu0">0</span>;k&lt;Required.<span class="me0">Count</span>();k++)
</pre></li>
<li class="li2">
<pre class="de2">
								<span class="kw2">if</span> (AllMutators[<span class="kw5">int</span>(Required.<span class="me0">GetItem</span>(k))].<span class="me0">GroupName</span> ~= AllMutators[j].<span class="me0">GroupName</span>)
</pre></li>
<li class="li1">
<pre class="de1">
									<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
							<span class="kw2">if</span> (k==Required.<span class="me0">Count</span>())
</pre></li>
<li class="li1">
<pre class="de1">
								Mutators.<span class="me0">Add</span>(<span class="kw5">string</span>(j),AllPCSMutators[i].<span class="me0">MutatorName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
						}
</pre></li>
<li class="li2">
<pre class="de2">
						<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// BEGIN OUTPUT ////////////////////////////////////////////</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">/*</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	TempMutes is an array of active mutators, including required ones</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	AllPCSMutators is a ProfileMutator array, which includes a required flag</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">	Need to generate a regular mutator selection list, but list all required</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">	first, followed by the list of all other mutators which are available</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">*/</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// MAPS</span>
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SpanLength"</span>, <span class="st0">"2"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SpanContent"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			EmptyRow = <span class="st0">"&lt;tr&gt;"</span> $ WebInclude(CellColSpan) $ <span class="st0">"&lt;/tr&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, TableTitle[<span class="nu0">3</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = <span class="kw5">string</span>(TempPCS.<span class="me0">GetMaxMaps</span>());
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempStr == <span class="st0">"0"</span>) TempStr = <span class="st0">"Unlimited"</span>;
</pre></li>
<li class="li2">
<pre class="de2">
			Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, LabelMaxMaps$<span class="st0">":"</span>@TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
			EditRows += WebInclude(IncludeSection);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			j = RequiredMaps.<span class="me0">Count</span>();
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (j &gt; <span class="nu0">0</span>)
</pre></li>
<li class="li2">
<pre class="de2">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				EditRows = EditRows $ EmptyRow $ <span class="st0">"&lt;tr&gt;&lt;td class=ttext&gt;"</span> $ RequiredText @ MapText $ <span class="st0">"&lt;/td&gt;&lt;td class=ttext&gt;"</span> $ FollowingMaps@AreAssignedText $ <span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
				i=<span class="nu0">0</span>;
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">while</span> (i&lt;j)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li2">
<pre class="de2">
					Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, AllPCSMaps[<span class="kw5">int</span>(RequiredMaps.<span class="me0">GetItem</span>(i++))].<span class="me0">MapName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
					Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, StringIf(i &lt; j, AllPCSMaps[<span class="kw5">int</span>(RequiredMaps.<span class="me0">GetItem</span>(i++))].<span class="me0">MapName</span>, <span class="st0">""</span>));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
					Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
					EditRows += WebInclude(IncludeRows);
</pre></li>
<li class="li2">
<pre class="de2">
				}
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			EditRows = EditRows $ EmptyRow $ <span class="st0">"&lt;tr&gt;&lt;td class=ttext&gt;"</span> $ AvailableText@MapText $ <span class="st0">"&lt;/td&gt;&lt;td class=ttext&gt;"</span> $ LabelChangeMaplist $ <span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			Res.<span class="me0">Subst</span>(<span class="st0">"ExcludeMapsOptions"</span>, CreateMapListSelect(AllPCSMaps, ExcludeMaps,MovedMaps));
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"IncludeMapsOptions"</span>, CreateMapListSelect(AllPCSMaps, IncludeMaps,MovedMaps));
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SpanContent"</span>, WebInclude(IncludeMapSelect));
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, WebInclude(CellColSpan));
</pre></li>
<li class="li1">
<pre class="de1">
			EditRows += WebInclude(RowLeft);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// MUTATORS</span>
</pre></li>
<li class="li1">
<pre class="de1">
			CreateFullMutatorList(Mutators,GroupsOnly);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, TableTitle[<span class="nu0">2</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			EditRows += WebInclude(IncludeSection);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (ReqSA.<span class="me0">Count</span>() &gt; <span class="nu0">0</span> || Required.<span class="me0">Count</span>() &gt; <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				EditRows = EditRows $ EmptyRow $ <span class="st0">"&lt;tr&gt;&lt;td class=ttext&gt;"</span> $ RequiredText@MutatorText $ <span class="st0">"&lt;/td&gt;&lt;td class=ttext&gt;"</span> $ FollowingMutators@AreAssignedText $ <span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Include ServerActors first</span>
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;ReqSA.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				j = <span class="kw5">int</span>(ReqSA.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, ReqSA.<span class="me0">GetTag</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SADescription</span>);
</pre></li>
<li class="li2">
<pre class="de2">
				Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				EditRows += WebInclude(IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;Required.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				j=<span class="kw5">int</span>(Required.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, AllMutators[j].<span class="me0">FriendlyName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, AllMutators[j].<span class="me0">Description</span>);
</pre></li>
<li class="li2">
<pre class="de2">
				Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				EditRows += WebInclude(IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			EditRows = EditRows $ EmptyRow $ <span class="st0">"&lt;tr&gt;&lt;td class=ttext&gt;"</span> $ AvailableText@MutatorText $ <span class="st0">"&lt;/td&gt;&lt;td class=ttext&gt;"</span> $ FollowingMutators@AreAvailableText $ <span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;GroupsOnly.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				j=<span class="kw5">int</span>(GroupsOnly.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (AllMutators[j].<span class="me0">GroupName</span>==<span class="st0">""</span>)
</pre></li>
<li class="li2">
<pre class="de2">
					thisgroup=<span class="st0">"Z"</span>$string(z++);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span> thisgroup = AllMutators[j].<span class="me0">GroupName</span>;
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> ( (i + <span class="nu0">1</span>) == GroupsOnly.<span class="me0">Count</span>())
</pre></li>
<li class="li1">
<pre class="de1">
					nextgroup = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span>
</pre></li>
<li class="li2">
<pre class="de2">
				{
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="co1">// Assign nextgroup to the next mutators group</span>
</pre></li>
<li class="li1">
<pre class="de1">
					k = <span class="kw5">int</span>(GroupsOnly.<span class="me0">GetItem</span>(i + <span class="nu0">1</span>));
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (AllMutators[k].<span class="me0">GroupName</span>==<span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
						nextgroup=<span class="st0">"Z"</span>$string(z);
</pre></li>
<li class="li2">
<pre class="de2">
					<span class="kw2">else</span> nextgroup = AllMutators[k].<span class="me0">GroupName</span>;
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"GroupName"</span>, thisgroup);
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"MutatorClass"</span>, AllMutators[j].<span class="me0">ClassName</span>);
</pre></li>
<li class="li2">
<pre class="de2">
				Res.<span class="me0">Subst</span>(<span class="st0">"MutatorName"</span>, AllMutators[j].<span class="me0">FriendlyName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"MutatorDesc"</span>, AllMutators[j].<span class="me0">Description</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> ((lastgroup != thisgroup) &amp;&amp; (thisgroup == nextgroup)) <span class="co1">// and the next mut is in the same group as this one</span>
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li2">
<pre class="de2">
					Res.<span class="me0">Subst</span>(<span class="st0">"Checked"</span>, <span class="st0">" checked"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
					EditRows += WebInclude(<span class="st0">"current_mutators_group"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"Checked"</span>, StringIf(CurS.<span class="me0">HasMutator</span>(AllMutators[j].<span class="me0">ClassName</span>), <span class="st0">" checked"</span>, <span class="st0">""</span>));
</pre></li>
<li class="li2">
<pre class="de2">
				EditRows += WebInclude(<span class="st0">"current_mutators_group_row"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				lastgroup=thisgroup;
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Add ServerActors first</span>
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">for</span> (i = <span class="nu0">0</span>; i &lt; ServerActors.<span class="me0">Count</span>(); i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
				j = <span class="kw5">int</span>(ServerActors.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
				Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, Checkbox(<span class="kw5">string</span>(ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SAClass</span>), CurS.<span class="me0">HasServerActor</span>(<span class="kw5">string</span>(ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SAClass</span>))) $ <span class="st0">"&amp;nbsp;"</span> $ ServerActors.<span class="me0">GetTag</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = WebInclude(NowrapLeft);
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SADescription</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, TempStr $ WebInclude(CellLeft));
</pre></li>
<li class="li1">
<pre class="de1">
				EditRows += WebInclude(RowLeft);
</pre></li>
<li class="li2">
<pre class="de2">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i = <span class="nu0">0</span>; i&lt;Mutators.<span class="me0">Count</span>(); i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = <span class="st0">""</span>;
</pre></li>
<li class="li2">
<pre class="de2">
				j = <span class="kw5">int</span>(Mutators.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, Checkbox(AllMutators[j].<span class="me0">ClassName</span>,CurS.<span class="me0">HasMutator</span>(AllMutators[j].<span class="me0">ClassName</span>)) $ <span class="st0">"&amp;nbsp;"</span> $ AllMutators[j].<span class="me0">FriendlyName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr += WebInclude(NowrapLeft);
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, AllMutators[j].<span class="me0">Description</span>);
</pre></li>
<li class="li2">
<pre class="de2">
				Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, TempStr $ WebInclude(CellLeft));
</pre></li>
<li class="li1">
<pre class="de1">
				EditRows += WebInclude(RowLeft);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
			TempPCS.<span class="me0">EndEdit</span>(<span class="kw6">False</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="co1">// We have no profile currently active</span>
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">else</span>
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, PageCaption[<span class="nu0">0</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
			EditRows += WebInclude(IncludeRows);
</pre></li>
<li class="li2">
<pre class="de2">
		}
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"TableRows"</span>, EditRows);
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = WebInclude(IncludeCaptionButton)$Tmp$WebInclude(IncludeTable);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">if</span> (NewProfile != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"ButtonName"</span>, curS.<span class="me0">getValue</span>(<span class="st0">"ButtonName"</span>,<span class="st0">"ApplyProfileChanges"</span>));
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"ButtonValue"</span>, ButtonApplyProfileChanges);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"PageCaption"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			TempStr += WebInclude(IncludeCaptionButton);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Tmp = CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>,PageCaption[<span class="nu0">0</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (LadderRules.<span class="me0">GetRemainingMatches</span>() &gt; <span class="nu0">0</span> &amp;&amp; Tmp == LadderRules.<span class="me0">Profiles</span>[GetCurrentConfigIndex()].<span class="me0">ProfileName</span>)
</pre></li>
<li class="li2">
<pre class="de2">
			Tmp = Tmp @ LabelNumberMatchesLeft @ <span class="kw5">string</span>(LadderRules.<span class="me0">GetRemainingMatches</span>());
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"LadderTable"</span>, 	TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"Section"</span>,	 	LinkEditProfile);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SubTitle"</span>, 		Tmp);
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"PageHelp"</span>, 		HelpEditProfile);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PostAction"</span>, 	ProfileEditURI$<span class="st0">"?SessionID="</span>$SID);
</pre></li>
<li class="li1">
<pre class="de1">
		ShowPage(Res, MasterPage);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">else</span> AccessDenied(Res);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> QueryLadderSwitch(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">int</span> 		j, NumMatches;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">bool</span>		bDelayChange, bSwitching;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> Session 	CurS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> 	SID,
</pre></li>
<li class="li1">
<pre class="de1">
					TempStr, Tmp,
</pre></li>
<li class="li2">
<pre class="de2">
					Checked;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	CurS = SMaster.<span class="me0">getSession</span>(SID,<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Ls"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = Req.<span class="me0">GetVariable</span>(<span class="st0">"ProfileNameSelect"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		Tmp = Req.<span class="me0">GetVariable</span>(<span class="st0">"SetNewProfile"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (Tmp != <span class="st0">""</span>)
</pre></li>
<li class="li2">
<pre class="de2">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				NumMatches = <span class="kw5">int</span>(Req.<span class="me0">GetVariable</span>(<span class="st0">"NumMatches"</span>, <span class="st0">"0"</span>));
</pre></li>
<li class="li1">
<pre class="de1">
				bDelayChange = Req.<span class="me0">GetVariable</span>(<span class="st0">"DelaySwitch"</span>,<span class="st0">""</span>) != <span class="st0">""</span>;
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">if</span> (bDelayChange)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (LadderRules.<span class="me0">WaitApplyProfile</span>(TempStr, NumMatches))
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						CurS.<span class="me0">setValue</span>(<span class="st0">"ProfileIndex"</span>, TempStr, <span class="kw6">True</span>);
</pre></li>
<li class="li2">
<pre class="de2">
						bSwitching = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span>
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="co1">// We would like to switch immediately</span>
</pre></li>
<li class="li1">
<pre class="de1">
					LadderRules.<span class="me0">ApplyProfile</span>(TempStr, NumMatches);
</pre></li>
<li class="li1">
<pre class="de1">
					MapIsChanging();
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li2">
<pre class="de2">
			}
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> StatusError(Res, ErrorNoProfilesExist);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">else</span> <span class="kw2">if</span> (LadderRules.<span class="me0">Profiles</span>.<span class="me0">Length</span> &gt; <span class="nu0">0</span>)
</pre></li>
<li class="li2">
<pre class="de2">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			j = GetCurrentConfigIndex();
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (j &gt;= <span class="nu0">0</span>) TempStr = <span class="kw5">string</span>(j);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		bDelayChange = Req.<span class="me0">GetVariable</span>(<span class="st0">"DelaySwitch"</span>,<span class="st0">""</span>) != <span class="st0">""</span> || LadderRules.<span class="me0">bWaitingToSwitch</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (bDelayChange)
</pre></li>
<li class="li1">
<pre class="de1">
			Checked = <span class="st0">" checked"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">else</span> Checked = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"ProfileSelect"</span>, 		GenerateSwitchProfileOptions(TempStr));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"NumberGamesText"</span>, 	LabelNumberGames);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"TextName"</span>, 			<span class="st0">"NumMatches"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"TextValue"</span>, 			<span class="kw5">string</span>(NumMatches));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"TextSize"</span>, 			<span class="st0">"3"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"TextLength"</span>, 		<span class="st0">"3"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SwitchButtonName"</span>, 	<span class="st0">"SetNewProfile"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SwitchButtonValue"</span>, 	ButtonLoadProfile);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"DelayCheckName"</span>, 	<span class="st0">"DelaySwitch"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"Checked"</span>, 			Checked);
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"DelayCheckLabel"</span>, 	LabelDelayProfileChange);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (Tmp != <span class="st0">""</span> &amp;&amp; bSwitching)
</pre></li>
<li class="li1">
<pre class="de1">
			StatusOK(Res, SuccessSwitchProfile);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		Tmp = CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>, PageCaption[<span class="nu0">0</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (LadderRules.<span class="me0">GetRemainingMatches</span>() &gt; <span class="nu0">0</span> &amp;&amp; Tmp == LadderRules.<span class="me0">Profiles</span>[GetCurrentConfigIndex()].<span class="me0">ProfileName</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			Tmp = Tmp @ LabelNumberMatchesLeft @ <span class="kw5">string</span>(LadderRules.<span class="me0">GetRemainingMatches</span>());
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"LadderTable"</span>, 	WebInclude(IncludeSwitch));
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"Section"</span>, 		LinkSwitchProfile);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SubTitle"</span>, 		Tmp);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PageHelp"</span>, 		HelpSwitchProfile);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PostAction"</span>, 	ProfileSwitchURI$<span class="st0">"?SessionID="</span>$SID);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		ShowPage(Res, MasterPage);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> AccessDenied(Res);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">function</span> QuerySubImport(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> 					SID;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> Session 					CurS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> ProfileConfigSet 			TempPCS;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	CurS = SMaster.<span class="me0">getSession</span>(SID,<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Lm"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="co1">// We've gotten our profile - want to integrate it into the server now</span>
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(<span class="st0">"ImportRemoteProfile"</span>,<span class="st0">""</span>) != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			TempPCS = CreateImportSessionInfo(CurS);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempPCS == <span class="kw5">None</span>)
</pre></li>
<li class="li2">
<pre class="de2">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				ShowMessage(Res, ImportProfileFailTitle, ImportProfileFailText);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
			ShowMessage(Res, SuccessImportProfileTitle, SuccessImportProfile);
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> AccessDenied(Res);
</pre></li>
<li class="li2">
<pre class="de2">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> RemoteImport(ProfileImporter ProfileConn)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i,j;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> Session 	CurS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> 	Tmp, TempStr,
</pre></li>
<li class="li1">
<pre class="de1">
					ImportRows,
</pre></li>
<li class="li1">
<pre class="de1">
					PackageLink,
</pre></li>
<li class="li1">
<pre class="de1">
					NewGameType, CustomGameLocation,
</pre></li>
<li class="li2">
<pre class="de2">
					NewAccessType, CustomAccessLocation,
</pre></li>
<li class="li1">
<pre class="de1">
					ImportProfileHTML,
</pre></li>
<li class="li1">
<pre class="de1">
					MapLocation, MutatorLocation, MutatorName;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> StringArray ImportMaps, ImportMutators;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw8">WebRequest</span> 		Req;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw8">WebResponse</span> 		Res;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	Req = ProfileConn.<span class="me0">QueryRequest</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	Res = ProfileConn.<span class="me0">QueryResponse</span>;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (Res == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		ShowMessage(Res, ErrorText, ErrorTimeout);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">return</span>;
</pre></li>
<li class="li2">
<pre class="de2">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">switch</span> (ProfileConn.<span class="me0">ImportResult</span>)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> IMPORT_BadURL: 		ShowMessage(Res,ErrorText,ErrorBadURL); 		CleanupQuery();	<span class="kw2">return</span>;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">case</span> IMPORT_ResolveError: 	ShowMessage(Res,ErrorText,ErrorResolve); 		CleanupQuery();	<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> IMPORT_BindError:		ShowMessage(Res,ErrorText,ErrorBind); 			CleanupQuery();	<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> IMPORT_TimeOut:		ShowMessage(Res,ErrorText,ErrorTimeout);		CleanupQuery();	<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> IMPORT_ServerError:	ShowMessage(Res,ErrorText,ErrorServer); 		CleanupQuery();	<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> IMPORT_BadRequest:		ShowMessage(Res,ErrorText,ErrorBadRequest); 	CleanupQuery();	<span class="kw2">return</span>;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">case</span> IMPORT_Unauthorized:	ShowMessage(Res,ErrorText,ErrorUnauthorized);	CleanupQuery();	<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> IMPORT_Forbidden:		ShowMessage(Res,ErrorText,ErrorForbidden);		CleanupQuery();	<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> IMPORT_NotFound:		ShowMessage(Res,ErrorText,ErrorNotFound); 		CleanupQuery();	<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">case</span> IMPORT_InvalidProfile:	ShowMessage(Res,ErrorText,ErrorProfile);		CleanupQuery();	<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	CurS = ProfileConn.<span class="me0">ImportS</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	ImportMaps = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	ImportMutators = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// General Profile Info</span>
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, LabelGeneralProfile);
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	ImportRows += WebInclude(IncludeSection);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, LabelProfileName);
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>));
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>,<span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	ImportRows += WebInclude(IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// Profile Gametype Class</span>
</pre></li>
<li class="li1">
<pre class="de1">
	NewGameType = CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	CustomGameLocation = CurS.<span class="me0">getValue</span>(<span class="st0">"CustomGameLoc"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CustomGameLocation != <span class="st0">""</span>)
</pre></li>
<li class="li2">
<pre class="de2">
		PackageLink = <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$CustomGameLocation$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_blank<span class="es0">\"</span>&gt;"</span>$CurS.<span class="me0">getValue</span>(<span class="st0">"GameName"</span>)$<span class="st0">"&lt;/a&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> PackageLink = CurS.<span class="me0">getValue</span>(<span class="st0">"GameName"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, LabelGameType);
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, PackageLink);
</pre></li>
<li class="li2">
<pre class="de2">
	Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>,<span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	ImportRows += WebInclude(IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Profile access control class</span>
</pre></li>
<li class="li1">
<pre class="de1">
	NewAccessType = CurS.<span class="me0">getValue</span>(<span class="st0">"ACClass"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
	CustomAccessLocation = CurS.<span class="me0">getValue</span>(<span class="st0">"CustomACLoc"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CustomAccessLocation != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		PackageLink = <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$CustomAccessLocation$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_blank<span class="es0">\"</span>&gt;"</span>$NewAccessType$<span class="st0">"&lt;/a&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> PackageLink = NewAccessType;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, LabelAccessControl);
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, PackageLink);
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>,<span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	ImportRows += WebInclude(IncludeRows);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Map Information</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, TableTitle[<span class="nu0">3</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li2">
<pre class="de2">
	ImportRows += WebInclude(IncludeSection);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i = <span class="nu0">0</span>; i &lt; CurS.<span class="me0">getMapLength</span>(); i++)
</pre></li>
<li class="li1">
<pre class="de1">
		ImportMaps.<span class="me0">Add</span>(<span class="kw5">string</span>(i), <span class="kw5">string</span>(CurS.<span class="me0">MapOrder</span>(i)));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">for</span> (i = <span class="nu0">0</span>; i &lt; ImportMaps.<span class="me0">Count</span>(); i++)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = CurS.<span class="me0">getMap</span>( <span class="kw5">int</span>(ImportMaps.<span class="me0">getItem</span>(i)) );
</pre></li>
<li class="li1">
<pre class="de1">
		MapLocation = ProfileConn.<span class="me0">FindRemoteZipLocation</span>(TempStr,ProfileConn.<span class="me0">ProfileServerAddress</span> $ ProfileConn.<span class="me0">RemoteProfilePath</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (MapLocation != <span class="st0">""</span>) PackageLink = <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$MapLocation$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_blank<span class="es0">\"</span>&gt;"</span>$TempStr$<span class="st0">"&lt;/a&gt;"</span>;
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">else</span> PackageLink = TempStr;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (CurS.<span class="me0">MapRequired</span>( TempStr ))
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = <span class="st0">"&lt;font color=<span class="es0">\"</span>red<span class="es0">\"</span>&gt;"</span>$RequiredText$<span class="st0">"&lt;/font&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">else</span> TempStr = AvailableText;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, PackageLink);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		ImportRows = ImportRows $ WebInclude(IncludeRows);
</pre></li>
<li class="li2">
<pre class="de2">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Mutator Information</span>
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, TableTitle[<span class="nu0">2</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li2">
<pre class="de2">
	ImportRows += WebInclude(IncludeSection);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">for</span> (i = <span class="nu0">0</span>; i &lt; CurS.<span class="me0">getMutatorLength</span>(); i++)
</pre></li>
<li class="li1">
<pre class="de1">
		ImportMutators.<span class="me0">Add</span>(<span class="kw5">string</span>(i), CurS.<span class="me0">getMutator</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">for</span> (i = <span class="nu0">0</span>; i &lt; ImportMutators.<span class="me0">Count</span>(); i++)
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = CurS.<span class="me0">getMutator</span>( <span class="kw5">int</span>(ImportMutators.<span class="me0">getItem</span>(i)) );
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (j=<span class="nu0">0</span>;j&lt;CurS.<span class="me0">getDataLength</span>();j++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			CurS.<span class="me0">getIDValue</span>(j,MutatorName,Tmp);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (Tmp ~= TempStr) <span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		MutatorLocation = ProfileConn.<span class="me0">FindRemoteZipLocation</span>(TempStr,ProfileConn.<span class="me0">ProfileServerAddress</span> $ ProfileConn.<span class="me0">RemoteProfilePath</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		PackageLink = StringIf(MutatorLocation != <span class="st0">""</span>, <span class="st0">"&lt;a href=<span class="es0">\"</span>"</span>$MutatorLocation$<span class="st0">"<span class="es0">\"</span> target=<span class="es0">\"</span>_blank<span class="es0">\"</span>&gt;"</span>$MutatorName$<span class="st0">"&lt;/a&gt;"</span>, MutatorName);
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = Stringif(CurS.<span class="me0">MutRequired</span>(TempStr), <span class="st0">"&lt;font color=<span class="es0">\"</span>red<span class="es0">\"</span>&gt;"</span>$RequiredText$<span class="st0">"&lt;/font&gt;"</span>, AvailableText);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, PackageLink);
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		ImportRows += WebInclude(IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// PlayInfo Information</span>
</pre></li>
<li class="li2">
<pre class="de2">
	Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, TableTitle[<span class="nu0">4</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	ImportRows += WebInclude(IncludeSection);
</pre></li>
<li class="li1">
<pre class="de1">
	ImportRows = ImportRows $<span class="st0">"&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span>$ GeneratePlayInfoRows(Req,Res,IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// Build Subst's</span>
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"ButtonName"</span>, <span class="st0">"ImportRemoteProfile"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"ButtonValue"</span>, ButtonApplyImportProfile);
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"PageCaption"</span>, LabelApplyImportProfile);
</pre></li>
<li class="li1">
<pre class="de1">
	ImportProfileHTML = WebInclude(IncludeCaptionButton);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"TableRows"</span>, ImportRows);
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"LadderTable"</span>, WebInclude(IncludeTable) $ ImportProfileHTML);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	Tmp = CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>, PageCaption[<span class="nu0">0</span>]);
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">if</span> (LadderRules.<span class="me0">GetRemainingMatches</span>() &gt; <span class="nu0">0</span> &amp;&amp; Tmp == LadderRules.<span class="me0">Profiles</span>[GetCurrentConfigIndex()].<span class="me0">ProfileName</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		Tmp = Tmp @ LabelNumberMatchesLeft @ <span class="kw5">string</span>(LadderRules.<span class="me0">GetRemainingMatches</span>());
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"Section"</span>, LinkImportProfile);
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"SubTitle"</span>, Tmp);
</pre></li>
<li class="li2">
<pre class="de2">
	Res.<span class="me0">Subst</span>(<span class="st0">"PageHelp"</span>, HelpImportProfile);
</pre></li>
<li class="li1">
<pre class="de1">
	Res.<span class="me0">Subst</span>(<span class="st0">"PostAction"</span>, SubImportURI$<span class="st0">"?SessionID="</span>$CurS.<span class="me0">getHash</span>());
</pre></li>
<li class="li1">
<pre class="de1">
	ShowPage(Res, MasterPage);
</pre></li>
<li class="li1">
<pre class="de1">
	CleanupQuery();
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> QuerySubExport(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i,j;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw8">PlayInfo</span> 	TempPI;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> FileLog 	EProfile;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> Session 	CurS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> 	SID, Logname,
</pre></li>
<li class="li1">
<pre class="de1">
					TempStr, Tmp,
</pre></li>
<li class="li1">
<pre class="de1">
					dataname, datavalue,
</pre></li>
<li class="li2">
<pre class="de2">
					ProfileIndex, NewGameType,
</pre></li>
<li class="li1">
<pre class="de1">
					ExportRows, <span class="kw7">Location</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;GameInfo&gt; 		GI<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;AccessControl&gt; 	AC<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> class&lt;Mutator&gt;		TempMut;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;class&lt;Mutator&gt; &gt; M<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;Info&gt;			TempSA;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;class&lt;Info&gt; &gt;	SA<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> StringArray Mutators,GroupsOnly;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Lm"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		CurS = SMaster.<span class="me0">getSession</span>(SID,<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		ProfileIndex = Req.<span class="me0">GetVariable</span>(<span class="st0">"ProfileNameSelect"</span>, CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileIndex"</span>));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
        CreateSessionInfo(ProfileIndex,SID,<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		Logname = CurS.<span class="me0">getValue</span>(<span class="st0">"Logname"</span>,Req.<span class="me0">GetVariable</span>(<span class="st0">"TextInput"</span>));
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">if</span> (Logname == <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			Logname = CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		CurS.<span class="me0">setValue</span>(<span class="st0">"Logname"</span>,Logname,<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getMutatorLength</span>();i++)
</pre></li>
<li class="li2">
<pre class="de2">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = CurS.<span class="me0">getMutator</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (EpicPackage(TempStr))
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">continue</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(<span class="st0">"Save"</span>$TempStr,<span class="st0">""</span>) != <span class="st0">""</span>)
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw4">SetLocation</span>(TempStr,Req.<span class="me0">GetVariable</span>(TempStr));
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getMapLength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			TempStr = CurS.<span class="me0">getMap</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (EpicPackage(TempStr))
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">continue</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(<span class="st0">"Save"</span>$TempStr,<span class="st0">""</span>) != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw4">SetLocation</span>(TempStr,Req.<span class="me0">GetVariable</span>(TempStr));
</pre></li>
<li class="li2">
<pre class="de2">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		NewGameType = CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (NewGameType != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			GIClass = class&lt;GameInfo&gt;(<span class="kw3">DynamicLoadObject</span>(NewGameType,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">if</span> (GIClass==<span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			ShowMessage(Res,ErrorGameClassTitle,ErrorGameClassText);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"ACClass"</span>, <span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">AccessControlClass</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			ACClass = class&lt;AccessControl&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (ACClass == <span class="kw5">None</span>)
</pre></li>
<li class="li2">
<pre class="de2">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			ShowMessage(Res,ErrorAccessControlTitle,ErrorAccessControlText);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(<span class="st0">"Export"</span>,<span class="st0">""</span>)!=<span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="co1">// Write file locations to .ini</span>
</pre></li>
<li class="li1">
<pre class="de1">
			EProfile = <span class="kw7">Level</span>.<span class="kw4">Spawn</span>(<span class="kw1">class</span><span class="st0">'FileLog'</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (EProfile == <span class="kw5">None</span>)
</pre></li>
<li class="li2">
<pre class="de2">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				ShowMessage(Res, ErrorText, ErrorExportingProfile);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			EProfile.<span class="me0">OpenLog</span>(RemoveStr(CurS.<span class="me0">getValue</span>(<span class="st0">"Logname"</span>),<span class="st0">" "</span>));
</pre></li>
<li class="li1">
<pre class="de1">
			EProfile.<span class="me0">Logf</span>(<span class="st0">"Profile:"</span>$CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>)$Chr(<span class="nu0">21</span>)$CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>)$Chr(<span class="nu0">21</span>)$CurS.<span class="me0">getValue</span>(<span class="st0">"MaxMaps"</span>)$Chr(<span class="nu0">21</span>)$GIClass.<span class="kw1">default</span>.<span class="me0">GameName</span>$Chr(<span class="nu0">21</span>)$string(ACClass));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getMapLength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li2">
<pre class="de2">
				TempStr = CurS.<span class="me0">getMap</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(TempStr,<span class="st0">""</span>) != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw7">Location</span> = <span class="kw3">Chr</span>(<span class="nu0">21</span>) $ Req.<span class="me0">GetVariable</span>(TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span> <span class="kw7">Location</span> = <span class="st0">""</span>;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
				EProfile.<span class="me0">Logf</span>(<span class="st0">"Map:"</span>$TempStr$Chr(<span class="nu0">21</span>)$CurS.<span class="me0">MapOrder</span>(i)$Chr(<span class="nu0">21</span>)$CurS.<span class="me0">MapRequired</span>(TempStr)$Location);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getSALength</span>();i++)
</pre></li>
<li class="li2">
<pre class="de2">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = CurS.<span class="me0">getServerActor</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">for</span> (j=<span class="nu0">0</span>;j&lt;ConfigM.<span class="me0">ManagedActors</span>.<span class="me0">Length</span>;j++)
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (<span class="kw5">string</span>(ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SAClass</span>) ~= TempStr)
</pre></li>
<li class="li1">
<pre class="de1">
						DataName = ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SAName</span>;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(TempStr,<span class="st0">""</span>) != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw7">Location</span> = <span class="kw3">Chr</span>(<span class="nu0">21</span>) $ Req.<span class="me0">GetVariable</span>(TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span> <span class="kw7">Location</span> = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
				EProfile.<span class="me0">Logf</span>(<span class="st0">"Mutator:"</span>$DataName$Chr(<span class="nu0">21</span>)$TempStr$Chr(<span class="nu0">21</span>)$CurS.<span class="me0">SARequired</span>(TempStr)$Location);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getMutatorLength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li2">
<pre class="de2">
				TempStr = CurS.<span class="me0">getMutator</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">for</span> (j=<span class="nu0">0</span>;j&lt;AllMutators.<span class="me0">Length</span>;j++)
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (AllMutators[j].<span class="me0">ClassName</span> == TempStr)
</pre></li>
<li class="li1">
<pre class="de1">
						DataName = AllMutators[j].<span class="me0">FriendlyName</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(TempStr,<span class="st0">""</span>) != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw7">Location</span> = <span class="kw3">Chr</span>(<span class="nu0">21</span>) $ Req.<span class="me0">GetVariable</span>(TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span> <span class="kw7">Location</span> = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				EProfile.<span class="me0">Logf</span>(<span class="st0">"Mutator:"</span>$DataName$Chr(<span class="nu0">21</span>)$TempStr$Chr(<span class="nu0">21</span>)$CurS.<span class="me0">MutRequired</span>(TempStr)$Location);
</pre></li>
<li class="li2">
<pre class="de2">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			i=<span class="nu0">0</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			j=<span class="nu0">0</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">while</span> (i&lt;CurS.<span class="me0">getDataLength</span>())
</pre></li>
<li class="li2">
<pre class="de2">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				CurS.<span class="me0">getIdValue</span>(i,dataname,datavalue);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (<span class="kw3">InStr</span>(dataname,<span class="st0">"."</span>) != -<span class="nu0">1</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					EProfile.<span class="me0">Logf</span>(<span class="st0">"Data:"</span>$DataName$Chr(<span class="nu0">21</span>)$DataValue);
</pre></li>
<li class="li1">
<pre class="de1">
				i++;
</pre></li>
<li class="li2">
<pre class="de2">
			}
</pre></li>
<li class="li1">
<pre class="de1">
			EProfile.<span class="kw4">Destroy</span>();
</pre></li>
<li class="li1">
<pre class="de1">
			ShowMessage(Res, SuccessText, SuccessExportProfile$RemoveStr(LogName,<span class="st0">" "</span>)$<span class="st0">".txt"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Mutator Section</span>
</pre></li>
<li class="li1">
<pre class="de1">
		Mutators = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		GroupsOnly = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getMutatorLength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
		    TempStr = CurS.<span class="me0">getMutator</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
            <span class="kw2">for</span> (j=<span class="nu0">0</span>;j&lt;AllMutators.<span class="me0">Length</span>;j++)
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (TempStr ~= AllMutators[j].<span class="me0">ClassName</span>)
</pre></li>
<li class="li2">
<pre class="de2">
					Mutators.<span class="me0">Add</span>(<span class="kw5">string</span>(j), AllMutators[j].<span class="me0">FriendlyName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			TempMut = class&lt;Mutator&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempMut != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				MClass[MClass.<span class="me0">Length</span>] = TempMut;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, TableTitle[<span class="nu0">2</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		ExportRows += WebInclude(IncludeSection);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">for</span> (i = <span class="nu0">0</span>; i&lt;Mutators.<span class="me0">Count</span>(); i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			j = <span class="kw5">int</span>(Mutators.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, AllMutators[j].<span class="me0">FriendlyName</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">if</span> (EpicPackage(AllMutators[j].<span class="me0">ClassName</span>))
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, Textbox(AllMutators[j].<span class="me0">ClassName</span>,<span class="kw3">Min</span>(<span class="kw3">Max</span>(GetLongestURL(),<span class="nu0">16</span>),<span class="nu0">64</span>),<span class="nu0">128</span>,GetLocation(AllMutators[j].<span class="me0">ClassName</span>)) $ <span class="st0">"&amp;nbsp;&amp;nbsp;"</span> $ SubmitButton(<span class="st0">"Save"</span>$AllMutators[j].<span class="me0">ClassName</span>,ProfileButtonName[<span class="nu0">0</span>]));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			ExportRows += WebInclude(IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getSALength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			TempStr = CurS.<span class="me0">getServerActor</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				TempSA = class&lt;Info&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (TempSA != <span class="kw5">None</span>)
</pre></li>
<li class="li2">
<pre class="de2">
					SAClass[SAClass.<span class="me0">Length</span>] = TempSA;
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		TempPI = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'PlayInfo'</span>;
</pre></li>
<li class="li2">
<pre class="de2">
		LoadThisPlayInfo(TempPI, GIClass, ACClass, MClass, SAClass);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, TableTitle[<span class="nu0">3</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		ExportRows += WebInclude(IncludeSection);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, LabelMaxMaps);
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"MaxMaps"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (TempStr == <span class="st0">"0"</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = UnlimitedText;
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>, <span class="st0">"&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;&amp;nbsp;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		ExportRows += WebInclude(IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Map Section</span>
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getMapLength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
            TempStr = CurS.<span class="me0">getMap</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
            Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">if</span> (EpicPackage(TempStr))
</pre></li>
<li class="li1">
<pre class="de1">
				Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, Textbox(TempStr,<span class="kw3">Min</span>(<span class="kw3">Max</span>(GetLongestURL(),<span class="nu0">16</span>),<span class="nu0">64</span>),<span class="nu0">128</span>,GetLocation(TempStr)) $ <span class="st0">"&amp;nbsp;&amp;nbsp;"</span> $ SubmitButton(<span class="st0">"Save"</span>$TempStr,ProfileButtonName[<span class="nu0">0</span>]));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			ExportRows += WebInclude(IncludeRows);
</pre></li>
<li class="li2">
<pre class="de2">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// PlayInfo section</span>
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, TableTitle[<span class="nu0">4</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		ExportRows += WebInclude(IncludeSection);
</pre></li>
<li class="li1">
<pre class="de1">
		ExportRows += (<span class="st0">"&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"</span> $ GeneratePlayInfoRows(Req, Res, IncludeRows));
</pre></li>
<li class="li1">
<pre class="de1">
		ExportRows += (<span class="st0">"&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;"</span>$LabelApplyExportProfile$<span class="st0">"&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan=<span class="es0">\"</span>2<span class="es0">\"</span>&gt;"</span>$SubmitButton(<span class="st0">"Export"</span>,ButtonApplyExportProfile)$<span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"TableRows"</span>, ExportRows);
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"LadderTable"</span>, WebInclude(IncludeTable));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Tmp = CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>, PageCaption[<span class="nu0">0</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (LadderRules.<span class="me0">GetRemainingMatches</span>() &gt; <span class="nu0">0</span> &amp;&amp; Tmp == LadderRules.<span class="me0">Profiles</span>[GetCurrentConfigIndex()].<span class="me0">ProfileName</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			Tmp = Tmp @ LabelNumberMatchesLeft @ <span class="kw5">string</span>(LadderRules.<span class="me0">GetRemainingMatches</span>());
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"Section"</span>, LinkExportProfile);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PageHelp"</span>, HelpExportProfile);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SubTitle"</span>, Tmp);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PostAction"</span>, SubExportURI$<span class="st0">"?SessionID="</span>$SID);
</pre></li>
<li class="li2">
<pre class="de2">
		ShowPage(Res, MasterPage);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> AccessDenied(Res);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//****************************************************************</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//****************************************************************</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Query subpages for Add &amp; Manage Modules</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">//</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Page 0</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> QueryLadderManage(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">string</span> 	HeaderRows, ManagementRows,
</pre></li>
<li class="li1">
<pre class="de1">
					TempStr, Tmp, SID;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">bool</span>		bAdd, bModify, bCopy, bDelete, bImport, bExport;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> Session 	CurS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> ProfileImporter ProfileConn;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Lm"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		CurS = SMaster.<span class="me0">getSession</span>(SID, <span class="kw6">True</span>);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="co1">// Submit button was pressed</span>
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(ProfileButtonName[<span class="nu0">0</span>], <span class="st0">""</span>) != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">switch</span> (Req.<span class="me0">GetVariable</span>(<span class="st0">"Actions"</span>,<span class="st0">""</span>))
</pre></li>
<li class="li2">
<pre class="de2">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">case</span> <span class="st0">"Add"</span>:
</pre></li>
<li class="li1">
<pre class="de1">
					bAdd = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					QuerySubFrame(Req, Res);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">break</span>;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">case</span> <span class="st0">"Modify"</span>:
</pre></li>
<li class="li1">
<pre class="de1">
					bModify = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					TempStr = Req.<span class="me0">GetVariable</span>(<span class="st0">"ProfileNameSelect"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (TempStr == <span class="st0">""</span>)
</pre></li>
<li class="li2">
<pre class="de2">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						StatusError(Res, ErrorNoProfilesExist);
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
					QuerySubFrame(Req, Res);
</pre></li>
<li class="li2">
<pre class="de2">
					<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">case</span> <span class="st0">"Copy"</span>:
</pre></li>
<li class="li1">
<pre class="de1">
					bCopy = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					Tmp = Req.<span class="me0">GetVariable</span>(<span class="st0">"ProfileNameSelect"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
					<span class="kw2">if</span> (Tmp == <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
						StatusError(Res, ErrorNoProfilesExist);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
					TempStr = Req.<span class="me0">GetVariable</span>(<span class="st0">"TextInput"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (TempStr == <span class="st0">""</span>)
</pre></li>
<li class="li2">
<pre class="de2">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						StatusError(Res, ErrorCopyNoName);
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
					<span class="kw2">if</span> (LadderRules.<span class="me0">CopyProfile</span>(<span class="kw5">int</span>(Tmp),TempStr))
</pre></li>
<li class="li1">
<pre class="de1">
						StatusOK(Res,SuccessCopyProfile);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">else</span> StatusError(Res, ErrorCopyFrom);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">case</span> <span class="st0">"Delete"</span>:
</pre></li>
<li class="li1">
<pre class="de1">
					bDelete = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					TempStr = Req.<span class="me0">GetVariable</span>(<span class="st0">"ProfileNameSelect"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li2">
<pre class="de2">
						<span class="kw2">if</span> (LadderRules.<span class="me0">RemoveProfile</span>(<span class="kw5">int</span>(TempStr)))
</pre></li>
<li class="li1">
<pre class="de1">
							StatusOK(Res, SuccessDeleteProfile);
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">else</span> StatusError(Res, ErrorDeletingProfile);
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">else</span> StatusError(Res, ErrorNoProfilesExist);
</pre></li>
<li class="li2">
<pre class="de2">
					<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">case</span> <span class="st0">"Import"</span>:
</pre></li>
<li class="li1">
<pre class="de1">
					bImport = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					TempStr = Req.<span class="me0">GetVariable</span>(<span class="st0">"TextInput"</span>,<span class="st0">""</span>);
</pre></li>
<li class="li2">
<pre class="de2">
					<span class="kw2">if</span> (!(<span class="kw3">Left</span>(TempStr,<span class="nu0">7</span>) ~= <span class="st0">"http://"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						StatusError(Res, ErrorBadURL);
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="co1">// Spawn class to handle network interaction to receive remote profile</span>
</pre></li>
<li class="li1">
<pre class="de1">
					ProfileConn = <span class="kw7">Level</span>.<span class="kw4">Spawn</span>(<span class="kw1">Class</span><span class="st0">'ProfileImporter'</span>);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">If</span> (ProfileConn == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li2">
<pre class="de2">
						ShowMessage(Res, ErrorText, ImportClassSpawnError);
</pre></li>
<li class="li1">
<pre class="de1">
						<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="co1">// Assign local connection objects to importer class</span>
</pre></li>
<li class="li2">
<pre class="de2">
					ProfileConn.<span class="me0">QueryPage</span> = <span class="kw6">Self</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					ProfileConn.<span class="me0">QueryRequest</span> = Req;
</pre></li>
<li class="li1">
<pre class="de1">
					ProfileConn.<span class="me0">QueryResponse</span> = Res;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="co1">// Setting bDelayCleanup prevents the connection from being closed</span>
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="co1">// when QueryProfileImport() returns to Query()</span>
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="co1">// Set this prior to initializing connection, to ensure correct behavior</span>
</pre></li>
<li class="li1">
<pre class="de1">
					Res.<span class="me0">Connection</span>.<span class="me0">bDelayCleanup</span> = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="co1">// Initialize connection to foreign host, pass Importer class a Session</span>
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="co1">// object to allow it to build a profile config set.</span>
</pre></li>
<li class="li1">
<pre class="de1">
					ProfileConn.<span class="me0">Connect</span>(TempStr, CurS);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">case</span> <span class="st0">"Export"</span>:
</pre></li>
<li class="li2">
<pre class="de2">
					bExport = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					TempStr = Req.<span class="me0">GetVariable</span>(<span class="st0">"ProfileNameSelect"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (TempStr == <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						StatusError(Res, ErrorNoProfilesExist);
</pre></li>
<li class="li2">
<pre class="de2">
						<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
					QuerySubExport(Req,Res);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw1">default</span>:
</pre></li>
<li class="li1">
<pre class="de1">
					bModify = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="co1">// Output code -</span>
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// TODO: move to .inc file</span>
</pre></li>
<li class="li1">
<pre class="de1">
		HeaderRows = <span class="st0">"&lt;tr&gt;&lt;td nowrap&gt;"</span>$LabelChooseAction$<span class="st0">"&lt;/td&gt;&lt;td nowrap&gt;"</span>$LabelInputDescription$<span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	    ManagementRows += (<span class="st0">"&lt;tr&gt;&lt;td nowrap&gt;"</span>$RadioButton(<span class="st0">"Actions"</span>, <span class="st0">"Add"</span>, bAdd)$LabelAddProfile$<span class="st0">"&lt;br&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		ManagementRows += (RadioButton(<span class="st0">"Actions"</span>, <span class="st0">"Modify"</span>, bModify)$LabelModifyProfile$<span class="st0">"&lt;/td&gt;"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		ManagementRows += (<span class="st0">"&lt;td&gt;&lt;select class=mini name='ProfileNameSelect'&gt;"</span>$GenerateSwitchProfileOptions(TempStr)$<span class="st0">"&lt;/select&gt;&amp;nbsp;"</span>$LabelSelectActions$<span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		ManagementRows += (<span class="st0">"&lt;tr&gt;&lt;td nowrap&gt;"</span>$RadioButton(<span class="st0">"Actions"</span>, <span class="st0">"Copy"</span>, bCopy)$LabelCopyProfile$<span class="st0">"&lt;br&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		ManagementRows += (RadioButton(<span class="st0">"Actions"</span>, <span class="st0">"Delete"</span>, bDelete)$LabelDeleteProfile$<span class="st0">"&lt;/td&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		ManagementRows += (<span class="st0">"&lt;td nowrap&gt;"</span>$Textbox(<span class="st0">"TextInput"</span>,<span class="nu0">64</span>,<span class="nu0">128</span>)$<span class="st0">"&amp;nbsp;"</span>$LabelTextboxActions$<span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		ManagementRows += (<span class="st0">"&lt;tr&gt;&lt;td nowrap&gt;"</span>$RadioButton(<span class="st0">"Actions"</span>, <span class="st0">"Import"</span>, bImport)$LabelImportProfile$<span class="st0">"&lt;br&gt;"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		ManagementRows += (RadioButton(<span class="st0">"Actions"</span>, <span class="st0">"Export"</span>, bExport)$LabelExportProfile$<span class="st0">"&lt;/td&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		ManagementRows += (<span class="st0">"&lt;td&gt;"</span>$SubmitButton(ProfileButtonName[<span class="nu0">0</span>],ProfileButtonValue[<span class="nu0">0</span>])$<span class="st0">"&lt;/td&gt;&lt;/tr&gt;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"TableTitle"</span>, TableTitle[<span class="nu0">0</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"HeaderRow"</span>, HeaderRows);
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"TableRows"</span>,ManagementRows);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Tmp = CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>, PageCaption[<span class="nu0">0</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (LadderRules.<span class="me0">GetRemainingMatches</span>() &gt; <span class="nu0">0</span> &amp;&amp; Tmp == LadderRules.<span class="me0">Profiles</span>[GetCurrentConfigIndex()].<span class="me0">ProfileName</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			Tmp @= (LabelNumberMatchesLeft @ <span class="kw5">string</span>(LadderRules.<span class="me0">GetRemainingMatches</span>()));
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"Section"</span>, LabelManagement);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PageHelp"</span>, HelpManageProfile);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SubTitle"</span>, Tmp);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"LadderTable"</span>, WebInclude(IncludeTable));
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"PostAction"</span>, ProfileManageURI);
</pre></li>
<li class="li1">
<pre class="de1">
		ShowPage(Res, MasterPage);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> AccessDenied(Res);
</pre></li>
<li class="li2">
<pre class="de2">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Page 1</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> QuerySubGameType(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">int</span> i;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> DataName, DataValue, SID, NewName, OldName;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> GameTypeRows, OldGameType, CommandLineRows;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> GameTypeTable, CommandLineTable, ApplyTable;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> Session CurS;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> LadderProfiles LadderMaster;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Lm"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li2">
<pre class="de2">
		SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		CurS = SMaster.<span class="me0">getSession</span>(SID, <span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
        <span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(CurS.<span class="me0">getValue</span>(<span class="st0">"ButtonName"</span>,<span class="st0">""</span>),<span class="st0">""</span>)!=<span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
    	{
</pre></li>
<li class="li2">
<pre class="de2">
    		NewName = Req.<span class="me0">GetVariable</span>(<span class="st0">"NewProfile"</span>,DefaultProfileName);
</pre></li>
<li class="li1">
<pre class="de1">
    		OldName = CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
    		<span class="kw2">if</span> ((OldName != <span class="st0">""</span> &amp;&amp; !(OldName ~= NewName)) || OldName == <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
    		{
</pre></li>
<li class="li1">
<pre class="de1">
	    		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;LadderRules.<span class="me0">Profiles</span>.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li2">
<pre class="de2">
	    		{
</pre></li>
<li class="li1">
<pre class="de1">
	    			<span class="kw2">if</span> (NewName ~= LadderRules.<span class="me0">Profiles</span>[i].<span class="me0">ProfileName</span>)
</pre></li>
<li class="li1">
<pre class="de1">
	    			{
</pre></li>
<li class="li1">
<pre class="de1">
	    				StatusError(Res, ErrorSameProfileName);
</pre></li>
<li class="li1">
<pre class="de1">
	    				NewName = DefaultProfileName;
</pre></li>
<li class="li2">
<pre class="de2">
	    				<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	    			}
</pre></li>
<li class="li1">
<pre class="de1">
	    		}
</pre></li>
<li class="li1">
<pre class="de1">
	    	}
</pre></li>
<li class="li1">
<pre class="de1">
			CurS.<span class="me0">setValue</span>(<span class="st0">"ProfileName"</span>, NewName, <span class="kw6">true</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			CurS.<span class="me0">setValue</span>(<span class="st0">"GameType"</span>, Req.<span class="me0">GetVariable</span>(<span class="st0">"NewGameType"</span>), <span class="kw6">True</span>, OldGameType);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (!(OldGameType ~= CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>)))
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				CurS.<span class="me0">ClearMaps</span>();
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="co1">// Reset all stored PlayInfo information</span>
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getDataLength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					CurS.<span class="me0">getIDValue</span>(i,DataName,DataValue);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (<span class="kw3">InStr</span>(DataName, <span class="st0">"."</span>) != -<span class="nu0">1</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li2">
<pre class="de2">
						CurS.<span class="me0">delValue</span>(DataName);
</pre></li>
<li class="li1">
<pre class="de1">
						i--;
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li2">
<pre class="de2">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"NewProfileName"</span>, CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>, DefaultProfileName));
</pre></li>
<li class="li1">
<pre class="de1">
		GameTypeRows = WebInclude(IncludeProfileName);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;AGameType.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"GameTypeClass"</span>, 	AGameType.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"GameTypeName"</span>, 	AGameType.<span class="me0">GetTag</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Selected"</span>, 		StringIf(CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>) ~= AGameType.<span class="me0">GetItem</span>(i), <span class="st0">" checked"</span>, <span class="st0">""</span>));
</pre></li>
<li class="li2">
<pre class="de2">
			GameTypeRows += WebInclude(IncludeGameType);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Fill in caption table values</span>
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PageCaption"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"PageCaption"</span>, PageCaption[<span class="nu0">1</span>]));
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"ButtonName"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"ButtonName"</span>, ProfileButtonName[<span class="nu0">1</span>]));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"ButtonValue"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"ButtonValue"</span>, ProfileButtonValue[<span class="nu0">1</span>]));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
  		Res.<span class="me0">Subst</span>(<span class="st0">"TableRows"</span>, 		GameTypeRows);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"LadderTable"</span>, 	WebInclude(IncludeTable)$WebInclude(IncludeCaptionButton));
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"PostAction"</span>, 	CurS.<span class="me0">GetValue</span>(<span class="st0">"CurrentPage"</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		ShowPage(Res, SubFrameContent);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> AccessDenied(Res);
</pre></li>
<li class="li2">
<pre class="de2">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Page 2</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> QuerySubMutators(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">int</span> i,j;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">bool</span> 		bAllMuts,
</pre></li>
<li class="li1">
<pre class="de1">
					bClearMuts,
</pre></li>
<li class="li1">
<pre class="de1">
					bChecked;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> 	MutatorRows,
</pre></li>
<li class="li2">
<pre class="de2">
					SID, TempStr;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> Session CurS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> StringArray Mutators, ServerActors;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;Mutator&gt; Mut<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Lm"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		CurS = SMaster.<span class="me0">getSession</span>(SID, <span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(CurS.<span class="me0">getValue</span>(<span class="st0">"ButtonName"</span>,<span class="st0">""</span>),<span class="st0">""</span>)!=<span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			bAllMuts = Req.<span class="me0">GetVariable</span>(<span class="st0">"AllowAllMutators"</span>)!=<span class="st0">""</span>;
</pre></li>
<li class="li2">
<pre class="de2">
			bClearMuts = Req.<span class="me0">GetVariable</span>(<span class="st0">"ClearAllMutators"</span>)!=<span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//			CurS.ClearMutators();</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;ConfigM.<span class="me0">ManagedActors</span>.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li2">
<pre class="de2">
				TempStr = <span class="kw5">string</span>(ConfigM.<span class="me0">ManagedActors</span>[i].<span class="me0">SAClass</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (bAllMuts || (!bClearMuts &amp;&amp; Req.<span class="me0">GetVariable</span>(TempStr,<span class="st0">""</span>) != <span class="st0">""</span>))
</pre></li>
<li class="li1">
<pre class="de1">
					CurS.<span class="me0">setServerActor</span>(TempStr, <span class="kw6">True</span>, CurS.<span class="me0">SARequired</span>(TempStr));
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span> CurS.<span class="me0">delServerActor</span>(TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;AllMutators.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (bAllMuts || (!bClearMuts &amp;&amp; (Req.<span class="me0">GetVariable</span>(AllMutators[i].<span class="me0">ClassName</span>,<span class="st0">""</span>)!=<span class="st0">""</span> || Req.<span class="me0">GetVariable</span>(AllMutators[i].<span class="me0">GroupName</span>)~=AllMutators[i].<span class="me0">ClassName</span>)))
</pre></li>
<li class="li1">
<pre class="de1">
					CurS.<span class="me0">setMutator</span>(AllMutators[i].<span class="me0">ClassName</span>,<span class="kw6">true</span>,CurS.<span class="me0">MutRequired</span>(AllMutators[i].<span class="me0">ClassName</span>));
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">else</span> <span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(AllMutators[i].<span class="me0">GroupName</span>) ~= <span class="st0">"None"</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					CurS.<span class="me0">setMutator</span>(AllMutators[i].<span class="me0">GroupName</span>,<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span>
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					CurS.<span class="me0">delMutator</span>(AllMutators[i].<span class="me0">ClassName</span>);
</pre></li>
<li class="li2">
<pre class="de2">
					CurS.<span class="me0">delMutator</span>(AllMutators[i].<span class="me0">GroupName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		Mutators = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		ServerActors = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">//		GroupsOnly = new(None) class'SortedStringArray';</span>
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i = <span class="nu0">0</span>; i&lt;AllMutators.<span class="me0">Length</span>; i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			MutClass = class&lt;Mutator&gt;(<span class="kw3">DynamicLoadObject</span>(AllMutators[i].<span class="me0">ClassName</span>, <span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (MutClass != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				Mutators.<span class="me0">Add</span>(<span class="kw5">string</span>(i),AllMutators[i].<span class="me0">FriendlyName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;ConfigM.<span class="me0">ManagedActors</span>.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (ConfigM.<span class="me0">ManagedActors</span>[i].<span class="me0">SAClass</span> != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				ServerActors.<span class="me0">Add</span>(<span class="kw5">string</span>(i),ConfigM.<span class="me0">ManagedActors</span>[i].<span class="me0">SAName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Uncomment this to allow mutators to be grouped according to MutatorGroup</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">/*</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		CreateFullMutatorList(Mutators,GroupsOnly);</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		for (i=0;i&lt;CurS.GetMutatorLength();i++)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		{</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">			k = 0-1;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			for (j=0;j&lt;AllMutators.Length;j++)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				if (CurS.GetMutator(i) ~= AllMutators[j].ClassName)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">					break;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			if (j&lt;AllMutators.Length) k = GroupsOnly.FindItemId(string(j));</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">			if (k &gt;= 0)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			{</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				for (z=0;z&lt;TempA.Length;z++)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				{</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">					if (TempA[z] ~= AllMutators[j].GroupName)</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">					{</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">						bAllMuts = True;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">						break;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">					}</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				}</span>
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				if (!bAllMuts) TempA[TempA.Length] = AllMutators[j].GroupName;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			}</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			if (bAllMuts)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">       			break;</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">		}</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		lastgroup = "";</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		thisgroup = "";</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		nextgroup = "";</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">		MutatorRows="";</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		for (i=0;i&lt;GroupsOnly.Count();i++)</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		{</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			j=int(GroupsOnly.GetItem(i));</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">			if (AllMutators[j].GroupName=="")</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				thisgroup="Z"$string(z++);</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			else thisgroup = AllMutators[j].GroupName;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			if ( (i + 1) == GroupsOnly.Count())</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				nextgroup = "";</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">			else</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			{</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			// Assign nextgroup to the next mutators group</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				k = int(GroupsOnly.GetItem(i + 1));</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				if (AllMutators[k].GroupName=="")</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">					nextgroup="Z"$string(z);</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				else nextgroup = AllMutators[k].GroupName;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			}</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			Res.Subst("GroupName", thisgroup);</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">			Res.Subst("MutatorClass", AllMutators[j].ClassName);</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			Res.Subst("MutatorName", AllMutators[j].FriendlyName);</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			Res.Subst("MutatorDesc", AllMutators[j].Description);</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			if ((lastgroup != thisgroup) &amp;&amp; (thisgroup == nextgroup)) // and the next mut is in the same group as this one</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">			{</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				if (bAllMuts||CurS.HasMutator(thisgroup)) Res.Subst("Checked", "checked");</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				MutatorRows = MutatorRows$WebInclude("current_mutators_group");</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			}</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			else</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">			{</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				if (CurS.HasMutator(AllMutators[j].ClassName) &amp;&amp; !bAllMuts) Res.Subst("Checked", "checked"); else Res.Subst("Checked", "");</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">				MutatorRows = MutatorRows$WebInclude("current_mutators_group_row");</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">			}</span>
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="coMULTI">			lastgroup=thisgroup;</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">		}</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="coMULTI">*/</span>
</pre></li>
<li class="li1">
<pre class="de1">
		bAllMuts = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i = <span class="nu0">0</span>; i&lt;ServerActors.<span class="me0">Count</span>(); i++)
</pre></li>
<li class="li2">
<pre class="de2">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = <span class="st0">""</span>; bChecked = <span class="kw6">False</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			j = <span class="kw5">int</span>(ServerActors.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (CurS.<span class="me0">HasServerActor</span>(<span class="kw5">string</span>(ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SAClass</span>)))
</pre></li>
<li class="li2">
<pre class="de2">
				bChecked = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> <span class="kw2">if</span> (bAllMuts) bAllMuts = <span class="kw6">False</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, Checkbox(<span class="kw5">string</span>(ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SAClass</span>),bChecked) $ <span class="st0">"&amp;nbsp;"</span> $ ServerActors.<span class="me0">GetTag</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = WebInclude(NowrapLeft);
</pre></li>
<li class="li2">
<pre class="de2">
			Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SADescription</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, TempStr $ WebInclude(CellLeft));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			MutatorRows += WebInclude(RowLeft);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i = <span class="nu0">0</span>; i&lt;Mutators.<span class="me0">Count</span>(); i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = <span class="st0">""</span>; bChecked = <span class="kw6">False</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			j = <span class="kw5">int</span>(Mutators.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (CurS.<span class="me0">HasMutator</span>(AllMutators[j].<span class="me0">ClassName</span>))
</pre></li>
<li class="li1">
<pre class="de1">
				bChecked = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> <span class="kw2">if</span> (bAllMuts) bAllMuts = <span class="kw6">False</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, CheckBox(AllMutators[j].<span class="me0">ClassName</span>, bChecked) $ <span class="st0">"&amp;nbsp;"</span> $ AllMutators[j].<span class="me0">FriendlyName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = WebInclude(NowrapLeft);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, AllMutators[j].<span class="me0">Description</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, TempStr $ WebInclude(CellLeft));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			MutatorRows += WebInclude(RowLeft);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (bAllMuts)
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, Checkbox(<span class="st0">"ClearAllMutators"</span>, <span class="kw6">False</span>)@LabelUncheckAllMutator);
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">else</span>
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, Checkbox(<span class="st0">"AllowAllMutators"</span>, <span class="kw6">False</span>)@LabelCheckAllMutator);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SpanLength"</span>, <span class="st0">"2"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SpanContent"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, WebInclude(CellColSpan));
</pre></li>
<li class="li2">
<pre class="de2">
		MutatorRows += WebInclude(RowLeft);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, WebInclude(CellLeft));
</pre></li>
<li class="li1">
<pre class="de1">
		MutatorRows += WebInclude(RowLeft);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"TableRows"</span>, MutatorRows);
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Fill in caption table values</span>
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PageCaption"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"PageCaption"</span>, PageCaption[<span class="nu0">2</span>]));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"ButtonName"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"ButtonName"</span>, ProfileButtonName[<span class="nu0">2</span>]));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"ButtonValue"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"ButtonValue"</span>, ProfileButtonValue[<span class="nu0">2</span>]));
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"LadderTable"</span>, 	WebInclude(IncludeTable)$WebInclude(IncludeCaptionButton));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PostAction"</span>, 	CurS.<span class="me0">GetValue</span>(<span class="st0">"CurrentPage"</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		ShowPage(Res, SubFrameContent);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> AccessDenied(Res);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Page3</span>
</pre></li>
<li class="li2">
<pre class="de2">
<span class="kw1">function</span> QuerySubMaps(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> 	SID,
</pre></li>
<li class="li1">
<pre class="de1">
					MapRows,
</pre></li>
<li class="li2">
<pre class="de2">
					TempStr, Temp,
</pre></li>
<li class="li1">
<pre class="de1">
					CheckString;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">bool</span> 		bAllMaps,
</pre></li>
<li class="li1">
<pre class="de1">
					bClearMaps,
</pre></li>
<li class="li1">
<pre class="de1">
					bChecked;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> Session CurS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> StringArray SortedMaps;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;string&gt; TempMaps;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;GameInfo&gt; GI<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Lm"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		CurS = SMaster.<span class="me0">getSession</span>(SID);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			GIClass = class&lt;GameInfo&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">if</span> (GIClass == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			ShowFramedMessage(Res,ErrorGameClassText,<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="co1">// Build a string array of maps valid for this gametype.</span>
</pre></li>
<li class="li1">
<pre class="de1">
		GIClass.<span class="kw1">static</span>.<span class="me0">LoadMapList</span>(GIClass.<span class="kw1">default</span>.<span class="me0">MapPrefix</span>, TempMaps);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(CurS.<span class="me0">getValue</span>(<span class="st0">"ButtonName"</span>,<span class="st0">""</span>),<span class="st0">""</span>)!=<span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			bAllMaps = Req.<span class="me0">GetVariable</span>(<span class="st0">"AllowAllMaps"</span>,<span class="st0">""</span>)!=<span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			bClearMaps = Req.<span class="me0">GetVariable</span>(<span class="st0">"ClearAllMaps"</span>,<span class="st0">""</span>)!=<span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;TempMaps.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (bAllMaps || (!bClearMaps &amp;&amp; Req.<span class="me0">GetVariable</span>(TempMaps[i])!=<span class="st0">""</span>))
</pre></li>
<li class="li2">
<pre class="de2">
					CurS.<span class="me0">setMap</span>(TempMaps[i],<span class="nu0">0</span>,<span class="kw6">True</span>,CurS.<span class="me0">MapRequired</span>(TempMaps[i]));
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span> CurS.<span class="me0">delMap</span>(TempMaps[i]);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="co1">// Add the map name array to a sorted string array for sorting</span>
</pre></li>
<li class="li1">
<pre class="de1">
		SortedMaps = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">for</span>(i=<span class="nu0">0</span>;i&lt;TempMaps.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
			SortedMaps.<span class="me0">Add</span>(<span class="kw5">string</span>(i),TempMaps[i]);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		bAllMaps = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="co1">// Now build the map rows</span>
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;SortedMaps.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			Temp = <span class="st0">""</span>; bChecked = <span class="kw6">False</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = SortedMaps.<span class="me0">GetTag</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (CurS.<span class="me0">HasMap</span>(TempStr))
</pre></li>
<li class="li2">
<pre class="de2">
				bChecked = <span class="kw6">True</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> <span class="kw2">if</span> (bAllMaps) bAllMaps = <span class="kw6">False</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, Checkbox(TempStr, bChecked) $ <span class="st0">"&amp;nbsp;"</span> $ TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, WebInclude(CellLeft));
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="co1">// Build string for javascript function</span>
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (CheckString!=<span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				CheckString += <span class="st0">"','"</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			CheckString += TempStr;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			MapRows += WebInclude(RowLeft);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Fill Javascript substs</span>
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"JavaScripts"</span>,<span class="st0">"&lt;script language=<span class="es0">\"</span>JavaScript<span class="es0">\"</span> type=<span class="es0">\"</span>text/JavaScript<span class="es0">\"</span>&gt;function MM_findObj(n,d){var p,i,x;if(!d)d=document;if((p=n.indexOf(<span class="es0">\"</span>?<span class="es0">\"</span>))&gt;0&amp;&amp;parent.frames.length){d=parent.frames[n.substring(p+1)].document;n=n.substring(0,p);}if(!(x=d[n])&amp;&amp;d.all)x=d.all[n];for(i=0;!x&amp;&amp;i&lt;d.forms.length;i++)x=d.forms[i][n];for(i=0;!x&amp;&amp;d.layers&amp;&amp;i&lt;d.layers.length;i++)x=MM_findObj(n,d.layers[i].document);if(!x&amp;&amp;d.getElementById)x=d.getElementById(n);return x;}function CheckMaps(){var maps=CheckMaps.arguments;var MapChecked=false;for(var i=0;i&lt;maps.length;i++){var myObj=MM_findObj(maps[i]);if(myObj.checked==true){MapChecked=true}}if(MapChecked==false){alert('You must check at least one map to continue!')}document.MM_returnValue=(MapChecked);}&lt;/script&gt;"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"JCheck"</span>,<span class="st0">" onClick=<span class="es0">\"</span>CheckMaps('AllowAllMaps','"</span>$CheckString$<span class="st0">"');return document.MM_returnValue<span class="es0">\"</span>"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"Checked"</span>,<span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (bAllMaps)
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, Checkbox(<span class="st0">"ClearAllMaps"</span>, <span class="kw6">False</span>) @ LabelUncheckAllMap);
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">else</span> Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, Checkbox(<span class="st0">"AllowAllMaps"</span>, <span class="kw6">False</span>) @ LabelCheckAllMap);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SpanLength"</span>, <span class="st0">"2"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SpanContent"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, WebInclude(CellColSpan));
</pre></li>
<li class="li2">
<pre class="de2">
		MapRows += WebInclude(RowLeft);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, WebInclude(CellLeft));
</pre></li>
<li class="li1">
<pre class="de1">
		MapRows += WebInclude(RowLeft);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="co1">// Set ladder_caption_table subst's</span>
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PageCaption"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"PageCaption"</span>,PageCaption[<span class="nu0">3</span>]));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"ButtonName"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"ButtonName"</span>, ProfileButtonName[<span class="nu0">3</span>]));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"ButtonValue"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"ButtonValue"</span>, ProfileButtonValue[<span class="nu0">3</span>]));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"TableRows"</span>, MapRows);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"LadderTable"</span>, 	WebInclude(IncludeTable)$WebInclude(IncludeCaptionButton));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PostAction"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"CurrentPage"</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		ShowPage(Res, SubFrameContent);
</pre></li>
<li class="li2">
<pre class="de2">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> AccessDenied(Res);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
<span class="co1">// Page 4</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> QuerySubRules(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">string</span> 	TempStr,
</pre></li>
<li class="li2">
<pre class="de2">
					SID;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> Session 	CurS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw8">PlayInfo</span> 	TempPI;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;Mutator&gt; 		Temp<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;GameInfo&gt; 		GI<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> class&lt;AccessControl&gt; 	AC<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;class&lt;Mutator&gt; &gt; M<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;Info&gt;			TempSA;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;class&lt;Info&gt; &gt;	SA<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Lm"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li1">
<pre class="de1">
		SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		CurS = SMaster.<span class="me0">GetSession</span>(SID);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			GIClass = class&lt;GameInfo&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (GIClass == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			ShowFramedMessage(Res,ErrorGameClassText,<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"ACClass"</span>, <span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">AccessControlClass</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			ACClass = class&lt;AccessControl&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (ACClass == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			ShowFramedMessage(Res,ErrorAccessControlText,<span class="kw6">True</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(CurS.<span class="me0">getValue</span>(<span class="st0">"ButtonName"</span>,<span class="st0">""</span>),<span class="st0">""</span>)!=<span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">GetMutatorLength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = CurS.<span class="me0">getMutator</span>(i);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li2">
<pre class="de2">
					TempClass = class&lt;Mutator&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (TempClass != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
						MClass[MClass.<span class="me0">Length</span>] = Temp<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			TempPI = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'PlayInfo'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">getSALength</span>(); i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = CurS.<span class="me0">getServerActor</span>(i);
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					TempSA = class&lt;Info&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (TempSA != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
						SAClass[SAClass.<span class="me0">Length</span>] = TempSA;
</pre></li>
<li class="li2">
<pre class="de2">
				}
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			LoadThisPlayInfo(TempPI, GIClass, ACClass, MClass, SAClass);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;TempPI.<span class="me0">Settings</span>.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li2">
<pre class="de2">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (!SettingIsAllowed(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SecLevel</span>)) <span class="kw2">continue</span>;
</pre></li>
<li class="li1">
<pre class="de1">
				TempStr = Req.<span class="me0">GetVariable</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>,TempPI.<span class="me0">Settings</span>[i].<span class="me0">Value</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (TempPI.<span class="me0">Settings</span>[i].<span class="me0">RenderType</span> == <span class="st0">"Text"</span>)
</pre></li>
<li class="li2">
<pre class="de2">
					CheckSettingValue(TempPI.<span class="me0">Settings</span>[i].<span class="me0">Data</span>, TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
				CurS.<span class="me0">setValue</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>,TempStr,<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"TableRows"</span>,		GeneratePlayInfoRows(Req, Res, <span class="st0">"defaults_row"</span>));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="co1">// Set ladder_caption_table subst's</span>
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PageCaption"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"PageCaption"</span>,PageCaption[<span class="nu0">4</span>]));
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"ButtonName"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"ButtonName"</span>, ProfileButtonName[<span class="nu0">4</span>]));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"ButtonValue"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"ButtonValue"</span>, ProfileButtonValue[<span class="nu0">4</span>]));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"LadderTable"</span>, 	WebInclude(IncludeTable)$WebInclude(IncludeCaptionButton));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PostAction"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"CurrentPage"</span>));
</pre></li>
<li class="li2">
<pre class="de2">
		ShowPage(Res, SubFrameContent);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> AccessDenied(Res);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Page 5</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> QuerySubReview(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i,j,k,z;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">string</span> 	SID,
</pre></li>
<li class="li1">
<pre class="de1">
					TempStr, TempSA,
</pre></li>
<li class="li1">
<pre class="de1">
					ReviewRows,
</pre></li>
<li class="li1">
<pre class="de1">
					thisgroup, lastgroup, nextgroup;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> Session CurS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> StringArray Mutators, GroupsOnly;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;Mutator&gt; 		Temp<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;Info&gt;			TempSA<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;GameInfo&gt; 		GI<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> class&lt;AccessControl&gt; 	AC<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;class&lt;Mutator&gt; &gt; M<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Lm"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li2">
<pre class="de2">
		SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		CurS = SMaster.<span class="me0">getSession</span>(SID);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li2">
<pre class="de2">
			GIClass = class&lt;GameInfo&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (GIClass == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			ShowFramedMessage(Res,ErrorGameClassText,<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">return</span>;
</pre></li>
<li class="li2">
<pre class="de2">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"ACClass"</span>,<span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">AccessControlClass</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			ACClass = class&lt;AccessControl&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">if</span> (ACClass == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			ShowFramedMessage(Res,ErrorAccessControlText,<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Mutators = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		GroupsOnly = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'SortedStringArray'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i = <span class="nu0">0</span>; i&lt;AllMutators.<span class="me0">Length</span>; i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">if</span> (CurS.<span class="me0">HasMutator</span>(AllMutators[i].<span class="me0">ClassName</span>)||CurS.<span class="me0">HasMutator</span>(AllMutators[i].<span class="me0">GroupName</span>))
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				TempClass = class&lt;Mutator&gt;(<span class="kw3">DynamicLoadObject</span>(AllMutators[i].<span class="me0">ClassName</span>, <span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (TempClass != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li2">
<pre class="de2">
					MClass[MClass.<span class="me0">Length</span>] = Temp<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
					Mutators.<span class="me0">Add</span>(<span class="kw5">string</span>(i),AllMutators[i].<span class="me0">FriendlyName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		CreateFullMutatorList(Mutators,GroupsOnly);
</pre></li>
<li class="li1">
<pre class="de1">
		lastgroup = <span class="st0">""</span>; thisgroup = <span class="st0">""</span>; nextgroup = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, TableTitle[<span class="nu0">2</span>]);
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, LabelRequiredMutators);
</pre></li>
<li class="li1">
<pre class="de1">
		ReviewRows += WebInclude(IncludeSection);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;GroupsOnly.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			j=<span class="kw5">int</span>(GroupsOnly.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (AllMutators[j].<span class="me0">GroupName</span>==<span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				thisgroup=<span class="st0">"Z"</span>$string(z++);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span> thisgroup = AllMutators[j].<span class="me0">GroupName</span>;
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> ( (i + <span class="nu0">1</span>) == GroupsOnly.<span class="me0">Count</span>())
</pre></li>
<li class="li1">
<pre class="de1">
				nextgroup = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">else</span>
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="co1">// Assign nextgroup to the next mutators group</span>
</pre></li>
<li class="li1">
<pre class="de1">
				k = <span class="kw5">int</span>(GroupsOnly.<span class="me0">GetItem</span>(i + <span class="nu0">1</span>));
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (AllMutators[k].<span class="me0">GroupName</span>==<span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					nextgroup=<span class="st0">"Z"</span>$string(z);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span> nextgroup = AllMutators[k].<span class="me0">GroupName</span>;
</pre></li>
<li class="li2">
<pre class="de2">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"GroupName"</span>, thisgroup);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"MutatorClass"</span>, AllMutators[j].<span class="me0">ClassName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"MutatorName"</span>, AllMutators[j].<span class="me0">FriendlyName</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			Res.<span class="me0">Subst</span>(<span class="st0">"MutatorDesc"</span>, AllMutators[j].<span class="me0">Description</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> ((lastgroup != thisgroup) &amp;&amp; (thisgroup == nextgroup)) <span class="co1">// and the next mut is in the same group as this one</span>
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
                Res.<span class="me0">Subst</span>(<span class="st0">"Checked"</span>, <span class="st0">" checked"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
				ReviewRows += WebInclude(<span class="st0">"current_mutators_group"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Checked"</span>, StringIf(CurS.<span class="me0">MutRequired</span>(AllMutators[j].<span class="me0">ClassName</span>), <span class="st0">" checked"</span>, <span class="st0">""</span>));
</pre></li>
<li class="li1">
<pre class="de1">
			ReviewRows += WebInclude(<span class="st0">"current_mutators_group_row"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			lastgroup=thisgroup;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i = <span class="nu0">0</span>; i&lt;Mutators.<span class="me0">Count</span>(); i++)
</pre></li>
<li class="li2">
<pre class="de2">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			j = <span class="kw5">int</span>(Mutators.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, CheckBox(AllMutators[j].<span class="me0">ClassName</span>, CurS.<span class="me0">MutRequired</span>(AllMutators[j].<span class="me0">ClassName</span>)) $ <span class="st0">"&amp;nbsp;"</span> $ AllMutators[j].<span class="me0">FriendlyName</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			TempStr = WebInclude(NowrapLeft);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, AllMutators[j].<span class="me0">Description</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, TempStr $ WebInclude(CellLeft));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			ReviewRows += WebInclude(RowLeft);
</pre></li>
<li class="li2">
<pre class="de2">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Mutators.<span class="kw4">Reset</span>();
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">for</span> (i = <span class="nu0">0</span>; i &lt; ConfigM.<span class="me0">ManagedActors</span>.<span class="me0">Length</span>; i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			TempSA = <span class="kw5">string</span>(ConfigM.<span class="me0">ManagedActors</span>[i].<span class="me0">SAClass</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (CurS.<span class="me0">HasServerActor</span>(TempSA))
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				TempSAClass = class&lt;Info&gt;(<span class="kw3">DynamicLoadObject</span>(TempSA,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (TempSAClass != <span class="kw5">None</span>)
</pre></li>
<li class="li2">
<pre class="de2">
					Mutators.<span class="me0">Add</span>(<span class="kw5">string</span>(i),ConfigM.<span class="me0">ManagedActors</span>[i].<span class="me0">SAName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
		lastgroup = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SpanLength"</span>, <span class="st0">"2"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"SpanContent"</span>, <span class="st0">"&amp;nbsp;&amp;nbsp;"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, WebInclude(CellColSpan));
</pre></li>
<li class="li1">
<pre class="de1">
		lastgroup = WebInclude(RowLeft);
</pre></li>
<li class="li1">
<pre class="de1">
		ReviewRows += lastgroup;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;Mutators.<span class="me0">Count</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = <span class="st0">""</span>;
</pre></li>
<li class="li1">
<pre class="de1">
			j = <span class="kw5">int</span>(Mutators.<span class="me0">GetItem</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, Checkbox(<span class="kw5">string</span>(ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SAClass</span>), CurS.<span class="me0">SARequired</span>(<span class="kw5">string</span>(ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SAClass</span>))) $ <span class="st0">"&amp;nbsp;"</span> $ Mutators.<span class="me0">GetTag</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
			TempStr = WebInclude(NowrapLeft);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Content"</span>, ConfigM.<span class="me0">ManagedActors</span>[j].<span class="me0">SADescription</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"RowContent"</span>, TempStr $ WebInclude(CellLeft));
</pre></li>
<li class="li1">
<pre class="de1">
			ReviewRows += WebInclude(RowLeft);
</pre></li>
<li class="li2">
<pre class="de2">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, TableTitle[<span class="nu0">3</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, LabelRequiredMaps);
</pre></li>
<li class="li1">
<pre class="de1">
		ReviewRows += WebInclude(IncludeSection);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, LabelMaxMaps);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, Textbox(<span class="st0">"MaxMaps"</span>, <span class="nu0">3</span>, <span class="nu0">3</span>, CurS.<span class="me0">getValue</span>(<span class="st0">"MaxMaps"</span>,<span class="st0">"3"</span>)));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>, lastgroup);
</pre></li>
<li class="li1">
<pre class="de1">
		ReviewRows += WebInclude(IncludeRows);
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;CurS.<span class="me0">GetMapLength</span>();i++)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SettingName"</span>, CurS.<span class="me0">getMap</span>(i));
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>, <span class="st0">""</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			Res.<span class="me0">Subst</span>(<span class="st0">"SettingData"</span>, Checkbox(CurS.<span class="me0">getMap</span>(i), CurS.<span class="me0">MapRequired</span>(CurS.<span class="me0">getMap</span>(i))));
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			ReviewRows += WebInclude(IncludeRows);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SectionName"</span>, TableTitle[<span class="nu0">4</span>]);
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"SpecialInstructions"</span>, LabelPlayInfo);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"Extra"</span>, lastgroup);
</pre></li>
<li class="li1">
<pre class="de1">
		ReviewRows += WebInclude(IncludeSection);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		ReviewRows += (lastgroup $ GeneratePlayInfoRows(Req, Res, IncludeRows));
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"TableRows"</span>, ReviewRows);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="co1">// Set ladder_caption_table subst's</span>
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PageCaption"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"PageCaption"</span>,PageCaption[<span class="nu0">5</span>]));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"ButtonName"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"ButtonName"</span>, ProfileButtonName[<span class="nu0">5</span>]));
</pre></li>
<li class="li2">
<pre class="de2">
		Res.<span class="me0">Subst</span>(<span class="st0">"ButtonValue"</span>, 	CurS.<span class="me0">getValue</span>(<span class="st0">"ButtonValue"</span>, ProfileButtonValue[<span class="nu0">5</span>]));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"LadderTable"</span>, 	WebInclude(IncludeTable)$WebInclude(IncludeCaptionButton));
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"PostAction"</span>, 	SubSavedURI$<span class="st0">"?SessionID="</span>$SID);
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"NewTarget"</span>,		<span class="st0">" target=<span class="es0">\"</span>_parent<span class="es0">\"</span>"</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		ShowPage(Res, SubFrameContent);
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> AccessDenied(Res);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="co1">// Page 6</span>
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">function</span> QuerySubSaved(<span class="kw8">WebRequest</span> Req, <span class="kw8">WebResponse</span> Res)
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw5">int</span> i,k, x;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> <span class="kw5">string</span> 	SID,
</pre></li>
<li class="li1">
<pre class="de1">
					tmp, tmp1,
</pre></li>
<li class="li1">
<pre class="de1">
					TempStr;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> Session 				CurS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> <span class="kw8">PlayInfo</span> 				TempPI;
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> ProfileConfigSet 		TempPCS;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;string&gt; 		TempArr;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;class&lt;Mutator&gt; &gt; M<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> array&lt;class&lt;Info&gt; &gt;	SA<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
	<span class="kw1">local</span> class&lt;Mutator&gt; 		Mut<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;GameInfo&gt; 		GI<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;AccessControl&gt; 	AC<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw1">local</span> class&lt;Info&gt;			TempSA;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
	SID = Req.<span class="me0">GetVariable</span>(<span class="st0">"SessionID"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
	CurS = SMaster.<span class="me0">getSession</span>(SID);
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">if</span> (CanPerform(<span class="st0">"Lm"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
	{
</pre></li>
<li class="li2">
<pre class="de2">
		TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			GIClass = class&lt;GameInfo&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (GIClass == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li2">
<pre class="de2">
			ShowFramedMessage(Res,ErrorGameClassText,<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		TempStr = CurS.<span class="me0">getValue</span>(<span class="st0">"ACClass"</span>,<span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">AccessControlClass</span>);
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">if</span> (TempStr != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			ACClass = class&lt;AccessControl&gt;(<span class="kw3">DynamicLoadObject</span>(TempStr,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (ACClass == <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			ShowFramedMessage(Res,ErrorAccessControlText,<span class="kw6">True</span>);
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
		TempPI = <span class="kw1">new</span>(<span class="kw5">None</span>) <span class="kw1">class</span><span class="st0">'PlayInfo'</span>;
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="co1">// We are managing an existing profile</span>
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">if</span> (CurS.<span class="me0">hasData</span>(<span class="st0">"ProfileIndex"</span>))
</pre></li>
<li class="li1">
<pre class="de1">
        {
</pre></li>
<li class="li1">
<pre class="de1">
            k = <span class="kw5">int</span>(CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileIndex"</span>));
</pre></li>
<li class="li1">
<pre class="de1">
            TempPCS = LadderRules.<span class="me0">LadderProfiles</span>[k];
</pre></li>
<li class="li1">
<pre class="de1">
            <span class="kw2">if</span> (LadderRules.<span class="me0">Profiles</span>[k].<span class="me0">ProfileName</span> != CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>))
</pre></li>
<li class="li2">
<pre class="de2">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				LadderRules.<span class="me0">Profiles</span>[k].<span class="me0">ProfileName</span> = CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				LadderRules.<span class="me0">AllLadderProfiles</span>.<span class="me0">Remove</span>(LadderRules.<span class="me0">AllLadderProfiles</span>.<span class="me0">FindItemId</span>(<span class="kw5">string</span>(k)));
</pre></li>
<li class="li1">
<pre class="de1">
				LadderRules.<span class="me0">AllLadderProfiles</span>.<span class="me0">Add</span>(<span class="kw5">string</span>(k),LadderRules.<span class="me0">Profiles</span>[k].<span class="me0">ProfileName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				LadderRules.<span class="kw3">SaveConfig</span>();
</pre></li>
<li class="li2">
<pre class="de2">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (TempPCS.<span class="me0">StartEdit</span>())
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				TempPCS.<span class="me0">SetGameType</span>(CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>));
</pre></li>
<li class="li2">
<pre class="de2">
				TempPCS.<span class="me0">EndEdit</span>(<span class="kw6">False</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
        }
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">else</span> TempPCS = LadderRules.<span class="me0">AddProfile</span>(CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>), CurS.<span class="me0">getValue</span>(<span class="st0">"GameType"</span>));
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
        <span class="kw2">if</span> (TempPCS.<span class="me0">StartEdit</span>())
</pre></li>
<li class="li1">
<pre class="de1">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;AllMutators.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li2">
<pre class="de2">
				MutClass = class&lt;Mutator&gt;(<span class="kw3">DynamicLoadObject</span>(AllMutators[i].<span class="me0">ClassName</span>,<span class="kw1">class</span><span class="st0">'Class'</span>));
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (MutClass != <span class="kw5">None</span>)
</pre></li>
<li class="li1">
<pre class="de1">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> ((Req.<span class="me0">GetVariable</span>(AllMutators[i].<span class="me0">ClassName</span>,<span class="st0">""</span>)!=<span class="st0">""</span>)||(Req.<span class="me0">GetVariable</span>(AllMutators[i].<span class="me0">GroupName</span>,<span class="st0">""</span>)~=AllMutators[i].<span class="me0">ClassName</span>))
</pre></li>
<li class="li1">
<pre class="de1">
						CurS.<span class="me0">setMutator</span>(AllMutators[i].<span class="me0">ClassName</span>,<span class="kw6">true</span>,<span class="kw6">true</span>);
</pre></li>
<li class="li2">
<pre class="de2">
					<span class="kw2">else</span> CurS.<span class="me0">setMutator</span>(AllMutators[i].<span class="me0">ClassName</span>,<span class="kw6">false</span>);
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (CurS.<span class="me0">HasMutator</span>(AllMutators[i].<span class="me0">ClassName</span>))
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						MClass[MClass.<span class="me0">Length</span>] = Mut<span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li2">
<pre class="de2">
						TempPCS.<span class="me0">AddProfileMutator</span>(AllMutators[i].<span class="me0">ClassName</span>,CurS.<span class="me0">MutRequired</span>(AllMutators[i].<span class="me0">ClassName</span>));
</pre></li>
<li class="li1">
<pre class="de1">
					}
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">else</span> TempPCS.<span class="me0">DelProfileMutator</span>(AllMutators[i].<span class="me0">ClassName</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;ConfigM.<span class="me0">ManagedActors</span>.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				TempSA = ConfigM.<span class="me0">ManagedActors</span>[i].<span class="me0">SA</span><span class="re0">${1}</span>&lt; ${3} &gt;
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (TempSA != <span class="kw5">None</span>)
</pre></li>
<li class="li2">
<pre class="de2">
				{
</pre></li>
<li class="li1">
<pre class="de1">
					TempStr = <span class="kw5">string</span>(ConfigM.<span class="me0">ManagedActors</span>[i].<span class="me0">SAClass</span>);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(TempStr,<span class="st0">""</span>) != <span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
						CurS.<span class="me0">setServerActor</span>(TempStr, <span class="kw6">True</span>, <span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">else</span> CurS.<span class="me0">setServerActor</span>(TempStr, <span class="kw6">False</span>);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">if</span> (CurS.<span class="me0">HasServerActor</span>(TempStr))
</pre></li>
<li class="li1">
<pre class="de1">
					{
</pre></li>
<li class="li1">
<pre class="de1">
						SAClass[SAClass.<span class="me0">Length</span>] = TempSA;
</pre></li>
<li class="li1">
<pre class="de1">
						TempPCS.<span class="me0">AddProfileServerActor</span>(TempStr,CurS.<span class="me0">SARequired</span>(TempStr));
</pre></li>
<li class="li2">
<pre class="de2">
					}
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">else</span> TempPCS.<span class="me0">DelProfileServerActor</span>(TempStr);
</pre></li>
<li class="li1">
<pre class="de1">
				}
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li2">
<pre class="de2">
			x = LoadThisPlayInfo(TempPI, GIClass, ACClass, MClass, SAClass);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">if</span> (x &gt;= <span class="nu0">0</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				ShowFramedMessage(Res, ErrorLoadingPlayInfoText[x],<span class="kw6">True</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">return</span>;
</pre></li>
<li class="li2">
<pre class="de2">
			}
</pre></li>
<li class="li1">
<pre class="de1">
			CurS.<span class="me0">setValue</span>(<span class="st0">"MaxMaps"</span>,Req.<span class="me0">GetVariable</span>(<span class="st0">"MaxMaps"</span>),<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
			TempPCS.<span class="me0">MaxMaps</span> = <span class="kw5">int</span>(CurS.<span class="me0">getValue</span>(<span class="st0">"MaxMaps"</span>));
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
			GIClass.<span class="kw1">static</span>.<span class="me0">LoadMapList</span>(GIClass.<span class="kw1">default</span>.<span class="me0">MapPrefix</span>, TempArr);
</pre></li>
<li class="li2">
<pre class="de2">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;TempArr.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (Req.<span class="me0">GetVariable</span>(TempArr[i],<span class="st0">""</span>)!=<span class="st0">""</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					CurS.<span class="me0">setMap</span>(TempArr[i],<span class="nu0">0</span>,<span class="kw6">true</span>,<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span> CurS.<span class="me0">setMap</span>(TempArr[i],<span class="nu0">0</span>,<span class="kw6">false</span>,<span class="kw6">false</span>);
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (CurS.<span class="me0">HasMap</span>(TempArr[i]))
</pre></li>
<li class="li1">
<pre class="de1">
					TempPCS.<span class="me0">AddProfileMap</span>(TempArr[i], CurS.<span class="me0">MapRequired</span>(TempArr[i]));
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">else</span> TempPCS.<span class="me0">DelProfileMap</span>(TempArr[i]);
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">for</span> (i=<span class="nu0">0</span>;i&lt;TempPI.<span class="me0">Settings</span>.<span class="me0">Length</span>;i++)
</pre></li>
<li class="li1">
<pre class="de1">
			{
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (TempPI.<span class="me0">Settings</span>[i].<span class="me0">SecLevel</span> &gt; CurAdmin.<span class="me0">MaxSecLevel</span>()) <span class="kw2">continue</span>;
</pre></li>
<li class="li1">
<pre class="de1">
				tmp = <span class="st0">""</span>; tmp1=<span class="st0">""</span>;
</pre></li>
<li class="li2">
<pre class="de2">
				<span class="kw2">if</span> (CurS.<span class="me0">getIdValue</span>(i,tmp,tmp1) == -<span class="nu0">1</span>)
</pre></li>
<li class="li1">
<pre class="de1">
					<span class="kw2">break</span>;
</pre></li>
<li class="li1">
<pre class="de1">
				<span class="kw2">if</span> (!TempPCS.<span class="me0">SetProfileNamedParam</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>, CurS.<span class="me0">getValue</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>,TempPI.<span class="me0">Settings</span>[i].<span class="me0">Value</span>)))
</pre></li>
<li class="li1">
<pre class="de1">
					TempPCS.<span class="me0">SetProfileParam</span>(TempPCS.<span class="me0">Count</span>(),TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>,CurS.<span class="me0">getValue</span>(TempPI.<span class="me0">Settings</span>[i].<span class="me0">SettingName</span>,TempPI.<span class="me0">Settings</span>[i].<span class="me0">Value</span>));
</pre></li>
<li class="li1">
<pre class="de1">
			}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
			TempPCS.<span class="me0">EndEdit</span>(<span class="kw6">true</span>);
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">else</span>
</pre></li>
<li class="li2">
<pre class="de2">
		{
</pre></li>
<li class="li1">
<pre class="de1">
			StatusError(Res,ErrorSavingProfile);
</pre></li>
<li class="li1">
<pre class="de1">
			QuerySubReview(Req, Res);
</pre></li>
<li class="li1">
<pre class="de1">
			<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
		}
</pre></li>
<li class="li2">
<pre class="de2">
		Tmp = CurS.<span class="me0">getValue</span>(<span class="st0">"ProfileName"</span>, PageCaption[<span class="nu0">0</span>]);
</pre></li>
<li class="li1">
<pre class="de1">
		<span class="kw2">if</span> (LadderRules.<span class="me0">GetRemainingMatches</span>() &gt; <span class="nu0">0</span> &amp;&amp; Tmp == LadderRules.<span class="me0">Profiles</span>[GetCurrentConfigIndex()].<span class="me0">ProfileName</span>)
</pre></li>
<li class="li1">
<pre class="de1">
			Tmp = Tmp @ LabelNumberMatchesLeft @ <span class="kw5">string</span>(LadderRules.<span class="me0">GetRemainingMatches</span>());
</pre></li>
<li class="li1">
<pre class="de1">
		Res.<span class="me0">Subst</span>(<span class="st0">"SubTitle"</span>, Tmp);
</pre></li>
<li class="li1">
<pre class="de1">
		ShowMessage(Res, TableTitle[<span class="nu0">6</span>], PageCaption[<span class="nu0">6</span>]);
</pre></li>
<li class="li2">
<pre class="de2">
		<span class="kw2">return</span>;
</pre></li>
<li class="li1">
<pre class="de1">
	}
</pre></li>
<li class="li1">
<pre class="de1">
 
</pre></li>
<li class="li1">
<pre class="de1">
	<span class="kw2">else</span> AccessDenied(Res);
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
<li class="li2">
<pre class="de2">
 
</pre></li>
<li class="li1">
<pre class="de1">
<span class="kw1">defaultproperties</span>
</pre></li>
<li class="li1">
<pre class="de1">
{
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">0</span>)=<span class="st0">"BR-Anubis"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">1</span>)=<span class="st0">"BR-Bifrost"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">2</span>)=<span class="st0">"BR-Disclosure"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">3</span>)=<span class="st0">"BR-IceFields"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">4</span>)=<span class="st0">"BR-Skyline"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">5</span>)=<span class="st0">"BR-Slaughterhouse"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">6</span>)=<span class="st0">"BR-TwinTombs"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">7</span>)=<span class="st0">"CTF-Chrome"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">8</span>)=<span class="st0">"CTF-Citadel"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">9</span>)=<span class="st0">"CTF-December"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">10</span>)=<span class="st0">"CTF-Face3"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">11</span>)=<span class="st0">"CTF-Geothermal"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">12</span>)=<span class="st0">"CTF-Lostfaith"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">13</span>)=<span class="st0">"CTF-Magma"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">14</span>)=<span class="st0">"CTF-Maul"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">15</span>)=<span class="st0">"CTF-Orbital2"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">16</span>)=<span class="st0">"DM-Antalus"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">17</span>)=<span class="st0">"DM-Asbestos"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">18</span>)=<span class="st0">"DM-Compressed"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">19</span>)=<span class="st0">"DM-Curse3"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">20</span>)=<span class="st0">"DM-Flux2"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">21</span>)=<span class="st0">"DM-Gael"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">22</span>)=<span class="st0">"DM-Inferno"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">23</span>)=<span class="st0">"DM-Insidious"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">24</span>)=<span class="st0">"DM-Leviathan"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">25</span>)=<span class="st0">"DM-Oceanic"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">26</span>)=<span class="st0">"DM-Phobos2"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">27</span>)=<span class="st0">"DM-Plunge"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">28</span>)=<span class="st0">"DM-Serpentine"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">29</span>)=<span class="st0">"DM-TokaraForest"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">30</span>)=<span class="st0">"DM-TrainingDay"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">31</span>)=<span class="st0">"DOM-Core"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">32</span>)=<span class="st0">"DOM-OutRigger"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">33</span>)=<span class="st0">"DOM-Ruination"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">34</span>)=<span class="st0">"DOM-ScorchedEarth"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">35</span>)=<span class="st0">"DOM-SepukkuGorge"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">36</span>)=<span class="st0">"DOM-Suntemple"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">37</span>)=<span class="st0">"Entry"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">38</span>)=<span class="st0">"NvidiaLogo"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">39</span>)=<span class="st0">"TUT-BR"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">40</span>)=<span class="st0">"TUT-CTF"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">41</span>)=<span class="st0">"TUT-DM"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">42</span>)=<span class="st0">"TUT-DOM"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">43</span>)=<span class="st0">"UT2-intro"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">44</span>)=<span class="st0">"VehicleDemo"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">45</span>)=<span class="st0">"endgame"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">46</span>)=<span class="st0">"Core"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">47</span>)=<span class="st0">"Editor"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">48</span>)=<span class="st0">"Engine"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">49</span>)=<span class="st0">"Fire"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">50</span>)=<span class="st0">"GamePlay"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">51</span>)=<span class="st0">"IpDrv"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">52</span>)=<span class="st0">"UWeb"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">53</span>)=<span class="st0">"UnrealEd"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">54</span>)=<span class="st0">"UnrealGame"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">55</span>)=<span class="st0">"Vehicles"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">56</span>)=<span class="st0">"XAdmin"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">57</span>)=<span class="st0">"XEffects"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">58</span>)=<span class="st0">"XGame"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">59</span>)=<span class="st0">"XGame_rc"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">60</span>)=<span class="st0">"XInterface"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">61</span>)=<span class="st0">"XPickups"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">62</span>)=<span class="st0">"XPickups_rc"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">63</span>)=<span class="st0">"XWeapons"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">64</span>)=<span class="st0">"XWeapons_rc"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">65</span>)=<span class="st0">"XWebAdmin"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">66</span>)=<span class="st0">"BR-DE-ElecFields"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">67</span>)=<span class="st0">"CTF-DE-ElecFields"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">68</span>)=<span class="st0">"CTF-DE-LavaGiant2"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">69</span>)=<span class="st0">"DM-DE-Grendelkeep"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">70</span>)=<span class="st0">"DM-DE-Ironic"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">71</span>)=<span class="st0">"DM-DE-Osiris2"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">72</span>)=<span class="st0">"BR-Canyon"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">73</span>)=<span class="st0">"CTF-Avaris"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">74</span>)=<span class="st0">"DM-1on1-Crash"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">75</span>)=<span class="st0">"DM-1on1-Mixer"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">76</span>)=<span class="st0">"DM-Icetomb"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">77</span>)=<span class="st0">"DM-Injector"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">78</span>)=<span class="st0">"DM-IronDeity"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">79</span>)=<span class="st0">"DM-Rustatorium"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">80</span>)=<span class="st0">"DOM-Junkyard"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">81</span>)=<span class="st0">"SkaarjPack"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     EpicPackages(<span class="nu0">82</span>)=<span class="st0">"SkaarjPack_rc"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">83</span>)=<span class="st0">"BonusPack"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     EpicPackages(<span class="nu0">84</span>)=<span class="st0">"OGGPlayer"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     MasterPage=<span class="st0">"ladder"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SubFrame=<span class="st0">"ladder_frame"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     SubFrameMenu=<span class="st0">"ladder_frame1"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SubFrameContent=<span class="st0">"ladder_frame2"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     IncludeTable=<span class="st0">"ladder_table"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     IncludeSection=<span class="st0">"ladder_section"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     IncludeRows=<span class="st0">"ladder_rows"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     IncludeCaptionButton=<span class="st0">"ladder_caption"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     IncludeMapSelect=<span class="st0">"ladder_mapselect"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     IncludeProfileName=<span class="st0">"ladder_name"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     IncludeGameType=<span class="st0">"ladder_gametype"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     IncludeCheckBox=<span class="st0">"ladder_checkrow"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     IncludeSwitch=<span class="st0">"ladder_switch"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileViewURI=<span class="st0">"ladder_view"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileEditURI=<span class="st0">"ladder_edit"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileMenuURI=<span class="st0">"ladder_menu"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileSwitchURI=<span class="st0">"ladder_switch"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     ProfileManageURI=<span class="st0">"ladder_manage"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SubFrameURI=<span class="st0">"profile_management"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SubFrameMenuURI=<span class="st0">"management_menu"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SubMapsURI=<span class="st0">"ladder_maps"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SubSavedURI=<span class="st0">"ladder_save"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     SubRulesURI=<span class="st0">"ladder_rules"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SubReviewURI=<span class="st0">"ladder_review"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SubGametypeURI=<span class="st0">"management_game_type"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SubMutatorsURI=<span class="st0">"ladder_mutators"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SubImportURI=<span class="st0">"profile_import"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     SubExportURI=<span class="st0">"profile_export"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LinkEditProfile=<span class="st0">"Edit Profiles"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LinkViewProfile=<span class="st0">"View Profiles"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LinkSwitchProfile=<span class="st0">"Switch Profiles"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LinkManageProfile=<span class="st0">"Manage Profiles"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     LinkImportProfile=<span class="st0">"Import Profile"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LinkExportProfile=<span class="st0">"Export Profile"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     TableTitle(<span class="nu0">0</span>)=<span class="st0">"Profile Management Portal"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     TableTitle(<span class="nu0">1</span>)=<span class="st0">"Profile GameType"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     TableTitle(<span class="nu0">2</span>)=<span class="st0">"Profile Mutators"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     TableTitle(<span class="nu0">3</span>)=<span class="st0">"Profile Maps"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     TableTitle(<span class="nu0">4</span>)=<span class="st0">"Profile Settings"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     TableTitle(<span class="nu0">5</span>)=<span class="st0">"Review Profile"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     TableTitle(<span class="nu0">6</span>)=<span class="st0">"Profile Saved"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     PageCaption(<span class="nu0">0</span>)=<span class="st0">"No Profile Loaded"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     PageCaption(<span class="nu0">1</span>)=<span class="st0">"Select the gametype that will be associated with this profile."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     PageCaption(<span class="nu0">2</span>)=<span class="st0">"Select the mutators that will be available in this profile."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     PageCaption(<span class="nu0">3</span>)=<span class="st0">"Select the maps that will be available in this profile."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     PageCaption(<span class="nu0">4</span>)=<span class="st0">"Select the settings that will be associated with this profile."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     PageCaption(<span class="nu0">5</span>)=<span class="st0">"Review all settings for accuracy before saving to file."</span>
</pre></li>
<li class="li2">
<pre class="de2">
     PageCaption(<span class="nu0">6</span>)=<span class="st0">"Settings were saved successfully!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileButtonName(<span class="nu0">0</span>)=<span class="st0">"Save Location"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileButtonName(<span class="nu0">1</span>)=<span class="st0">"GameType"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileButtonName(<span class="nu0">2</span>)=<span class="st0">"Mutators"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileButtonName(<span class="nu0">3</span>)=<span class="st0">"Maps"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     ProfileButtonName(<span class="nu0">4</span>)=<span class="st0">"Rules"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileButtonName(<span class="nu0">5</span>)=<span class="st0">"Review"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileButtonName(<span class="nu0">6</span>)=<span class="st0">"Saved"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileButtonValue(<span class="nu0">0</span>)=<span class="st0">"Proceed"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileButtonValue(<span class="nu0">1</span>)=<span class="st0">"Set GameType"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     ProfileButtonValue(<span class="nu0">2</span>)=<span class="st0">"Set Mutators"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileButtonValue(<span class="nu0">3</span>)=<span class="st0">"Set Maps"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileButtonValue(<span class="nu0">4</span>)=<span class="st0">"Set Rules"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileButtonValue(<span class="nu0">5</span>)=<span class="st0">"Save Profile"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ProfileButtonValue(<span class="nu0">6</span>)=<span class="st0">"Profile Saved"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     MapText=<span class="st0">"Maps"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorText=<span class="st0">"Error"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     MutatorText=<span class="st0">"Mutators"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     RequiredText=<span class="st0">"Required"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     AvailableText=<span class="st0">"Available"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     UnlimitedText=<span class="st0">"Unlimited"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     FollowingMaps=<span class="st0">"The following maps"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     AreAssignedText=<span class="st0">"are assigned to this profile and cannot be removed."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     AreAvailableText=<span class="st0">"may be added to this profile."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     FollowingMutators=<span class="st0">"The following mutators"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     CommandLineOptionsTitle=<span class="st0">"Command Line Options"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ButtonLoadProfile=<span class="st0">"Load Profile"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ButtonDeleteProfile=<span class="st0">"Delete Profile"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ButtonPreviewProfile=<span class="st0">"Load Profile"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ButtonApplyImportProfile=<span class="st0">"Import Profile"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     ButtonApplyExportProfile=<span class="st0">"Export Profile"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ButtonApplyProfileChanges=<span class="st0">"Apply Profile Changes"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelCopyProfile=<span class="st0">"Copy Profile"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelDeleteProfile=<span class="st0">"Delete Profile"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelImportProfile=<span class="st0">"Import Profile"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     LabelExportProfile=<span class="st0">"Export Profile"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelAddProfile=<span class="st0">"Add Profile"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelSelectActions=<span class="st0">"(Copy, Modify, Delete, Export)"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelTextboxActions=<span class="st0">"(Add, Copy, Import)"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelPlayInfo=<span class="st0">"Profile Game Parameters"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     LabelGeneralProfile=<span class="st0">"General Profile Information"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelGameType=<span class="st0">"Profile Game Type"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelProfileName=<span class="st0">"Profile Name"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelAccessControl=<span class="st0">"Profile Access Control"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelChooseAction=<span class="st0">"Choose action to perform:"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     LabelManagement=<span class="st0">"Profile Management"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelInputDescription=<span class="st0">"Actions which require input from this field are listed on the right."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelMaxMaps=<span class="st0">"Maximum maps allowed in this profile's maplist"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelNumberGames=<span class="st0">"Number of matches (0 = unlimited)"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelCheckAllMap=<span class="st0">"Select all maps"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     LabelRequiredMaps=<span class="st0">"Check each map that will be required (non-removable) for this profile."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelUncheckAllMap=<span class="st0">"Deselect all maps"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelChangeMaplist=<span class="st0">"Changes to the maplist are saved immediately."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelCheckAllMutator=<span class="st0">"Select all mutators"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelRequiredMutators=<span class="st0">"Check each mutator that will be required (non-removable) for this profile."</span>
</pre></li>
<li class="li2">
<pre class="de2">
     LabelNumberMatchesLeft=<span class="st0">"Matches Remaining:"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelUncheckAllMutator=<span class="st0">"Deselect all mutators"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelDelayProfileChange=<span class="st0">"Check to delay applying profile until end of current match."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelApplyImportProfile=<span class="st0">"Click Apply Import to make this profile available in your server's list of profiles."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     LabelApplyExportProfile=<span class="st0">"Click Apply Export to save this profile to a .txt file."</span>
</pre></li>
<li class="li2">
<pre class="de2">
     LabelModifyProfile=<span class="st0">"Modify Profile"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SuccessText=<span class="st0">"Success"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SuccessDeleteProfile=<span class="st0">"Profile successfully deleted!  It will no longer appear in your list of available profiles."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SuccessExportProfile=<span class="st0">"Profile exported successfully!  Exported profile has been saved to the server's System folder as "</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SuccessImportProfile=<span class="st0">"Profile imported successfully! The remote profile will now appear in your list of available profiles."</span>
</pre></li>
<li class="li2">
<pre class="de2">
     SuccessImportProfileTitle=<span class="st0">"Import Successful!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SuccessCopyProfile=<span class="st0">"Profile copied successfully! Copied profile will now be available in your list of available profiles."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     SuccessSwitchProfile=<span class="st0">"Profile successfully applied! Changes take effect at the end of the current match."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorLoadingPlayInfoText(<span class="nu0">0</span>)=<span class="st0">"Error while loading playinfo.  LoadThisPlayInfo() received bad playinfo object!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorLoadingPlayInfoText(<span class="nu0">1</span>)=<span class="st0">"Error while loading playinfo.  LoadThisPlayInfo() could not load incoming game class!"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     ErrorLoadingPlayInfoText(<span class="nu0">2</span>)=<span class="st0">"Error while loading playinfo.  LoadThisPlayInfo() could not load associated access control!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorLoadingPlayInfoText(<span class="nu0">3</span>)=<span class="st0">"Error while loading playinfo.  LoadThisPlayInfo() had exception while loading mutators!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorLoadingPlayInfoText(<span class="nu0">4</span>)=<span class="st0">"Error while loading playinfo.  LoadThisPlayInfo() had exception while loading server actors!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorGameClassText=<span class="st0">"No gametype was selected, or the files required by this gametype do not exist on this server."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorGameClassTitle=<span class="st0">"Invalid GameType"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     ErrorAccessControlText=<span class="st0">"Exception while loading access control.  Please double check the AccessControlClass= line of the [Engine.GameInfo] section of your server's .ini file."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorAccessControlTitle=<span class="st0">"Invalid Access Control"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorSameProfileName=<span class="st0">"Another profile already exists with that name. Please select a different name!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorRemoteMutator=<span class="st0">"Error loading mutator from remote profile. Could not find mutator package:"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorRemoteServerActor=<span class="st0">"Error loading ServerActor from remote profile.  Could not find ServerActor package:"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     ErrorSavingProfile=<span class="st0">"Exception while saving new profile! Please resubmit save request."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorDeletingProfile=<span class="st0">"Error deleting profile!  Please check server log for details."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorExportingProfile=<span class="st0">"Error exporting profile! Export class could not be spawned!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorNoProfilesExist=<span class="st0">"No profiles exist! Could not perform selected action!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorCopyFrom=<span class="st0">"Error copying profile.  No Profile Found!"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     ErrorCopyNoName=<span class="st0">"You must specify a unique name for the new profile!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorExcludeMapNotFound=<span class="st0">"Error! Exclude map not found:"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorIncludeMapNotFound=<span class="st0">"Error! Include map not found:"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorReplacingWebConnection=<span class="st0">"Exception replacing WebServer.AcceptClass! (Very bad) Please send an email to Evolution containing your server's ini and log files."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ImportClassSpawnError=<span class="st0">"Exception occured spawning connection class.  Please try again!"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     ImportProfileFailText=<span class="st0">"Error while importing profile.  Please ensure you have all the files necessary to load this remote profile."</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ImportProfileFailTitle=<span class="st0">"Import Failed!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorBind=<span class="st0">"Failed to bind port! Please try again!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorBadURL=<span class="st0">"URL must start with 'http://' !"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorServer=<span class="st0">"Unspecified error while importing profile!"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     ErrorResolve=<span class="st0">"URL could not be resolved!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorProfile=<span class="st0">"Attempted to import a file that does not contain a profile!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorTimeout=<span class="st0">"Timed out while waiting for response from foreign host!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorNotFound=<span class="st0">"Profile does not exist on remote server!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorForbidden=<span class="st0">"Remote profile could not be imported: Forbidden"</span>
</pre></li>
<li class="li2">
<pre class="de2">
     ErrorBadRequest=<span class="st0">"Request could not be processed by remote server!"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     ErrorUnauthorized=<span class="st0">"Remote profile could not be imported: Unauthorized"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     DefaultPage=<span class="st0">"ladder_main"</span>
</pre></li>
<li class="li1">
<pre class="de1">
     Title=<span class="st0">"Ladder"</span>
</pre></li>
<li class="li1">
<pre class="de1">
}
</pre></li>
</ol>
</div>
</div>

<!-- 
NewPP limit report
CPU time usage: 0.809 seconds
Real time usage: 0.812 seconds
Preprocessor visited node count: 13/1000000
Preprocessor generated node count: 77/1000000
Post‐expand include size: 492/2097152 bytes
Template argument size: 187/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    2.549      1 - -total
100.00%    2.549      1 - Template:Classbox
-->

<!-- Saved in parser cache with key wiki:pcache:idhash:1691-0!*!0!*!*!*!* and timestamp 20161215190911 and revision id 4179
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://wiki.beyondunreal.com/Legacy:LadderQuery?oldid=4179">https://wiki.beyondunreal.com/Legacy:LadderQuery?oldid=4179</a>"</div>
					<div id='catlinks' class='catlinks catlinks-allhidden'></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-legacy" class="selected"><a href="Legacy_LadderQuery.html">Legacy</a></li>
				<li id="ca-talk" class="new"><a href="https://wiki.beyondunreal.com/edit/Legacy_talk:LadderQuery?redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-edit"><a href="https://wiki.beyondunreal.com/edit/Legacy:LadderQuery" title="You can edit this page. Please use the preview button before saving [e]" accesskey="e">Edit</a></li>
				<li id="ca-history"><a href="https://wiki.beyondunreal.com/history/Legacy:LadderQuery" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=Legacy%3ALadderQuery&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=Legacy%3ALadderQuery" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="index.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-navigation" role="navigation">
		<h3>Navigation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-mainpage"><a href="index.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
											<li id="n-portal"><a href="Unreal_Wiki_Community_portal-2.html" title="About the project, what you can do, where to find things">Community portal</a></li>
											<li id="n-recentchanges"><a href="https://wiki.beyondunreal.com/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="https://wiki.beyondunreal.com/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
											<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											<li id="n-Forums-.28General.29"><a href="https://forums.beyondunreal.com/forums/wiki-general.250/" rel="nofollow">Forums (General)</a></li>
											<li id="n-Forums-.28Technical.29"><a href="https://forums.beyondunreal.com/forums/wiki-technical.251/" rel="nofollow">Forums (Technical)</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="https://wiki.beyondunreal.com/" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search Unreal Wiki [f]" accesskey="f" id="searchInput" />
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="https://wiki.beyondunreal.com/Special:WhatLinksHere/Legacy:LadderQuery" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="https://wiki.beyondunreal.com/Special:RecentChangesLinked/Legacy:LadderQuery" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="https://wiki.beyondunreal.com/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-print"><a href="https://wiki.beyondunreal.com/Legacy:LadderQuery?printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
											<li id="t-permalink"><a href="https://wiki.beyondunreal.com/Legacy:LadderQuery?oldid=4179" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="https://wiki.beyondunreal.com/info/Legacy:LadderQuery" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-copyrightico">
									<a href="https://creativecommons.org/licenses/by-nc-sa/3.0/"><img src="../licensebuttons.net/l/by-nc-sa/3.0/88x31.png" alt="Attribution-Noncommercial-Share Alike 3.0" width="88" height="31" /></a>
							</div>
					<div id="f-poweredbyico">
									<script async src="../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <!-- Home Page -->
        <ins class="adsbygoogle"
             style="display:inline-block;width:728px;height:90px"
             data-ad-client="ca-pub-9605963037553244"
             data-ad-slot="9528541415"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
							</div>
					<ul id="f-list">
									<li id="lastmod"> Last modified at 18:31, 19 March 2003.</li>
									<li id="copyright">Licensed as <a href="Unreal_Wiki_Copyrights.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>
									<li id="privacy"><a href="Unreal_Wiki_Privacy_policy.html" title="Unreal Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="Unreal_Wiki_About.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>
									<li id="disclaimer"><a href="Unreal_Wiki_General_disclaimer.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.beyondunreal.com/w/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=monobook\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":103});
}</script></body>
<!-- Mirrored from wiki.beyondunreal.com/Legacy:LadderQuery by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 10:55:55 GMT -->
</html>
