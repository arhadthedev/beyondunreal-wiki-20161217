<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.beyondunreal.com/Legacy:Creating_A_WebApplication by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 09:36:59 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>Legacy:Creating A WebApplication - Unreal Wiki</title>
<meta name="generator" content="MediaWiki 1.25.1" />
<link rel="alternate" type="application/x-wiki" title="Edit" href="https://wiki.beyondunreal.com/edit/Legacy:Creating_A_WebApplication" />
<link rel="edit" title="Edit" href="https://wiki.beyondunreal.com/edit/Legacy:Creating_A_WebApplication" />
<link rel="shortcut icon" href="w/uewiki-favicon.png" />
<link rel="search" type="application/opensearchdescription+xml" href="w/opensearch_desc.php" title="Unreal Wiki" />
<link rel="EditURI" type="application/rsd+xml" href="w/api251f.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="Legacy_Creating_A_WebApplication.html" />
<link rel="copyright" href="Unreal_Wiki_Copyrights.html" />
<link rel="alternate" type="application/atom+xml" title="Unreal Wiki Atom feed" href="https://wiki.beyondunreal.com/Special:RecentChanges?feed=atom" />
<link rel="stylesheet" href="w/load2743.css?debug=false&amp;lang=en&amp;modules=ext.geshi.language.uscript%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if IE 6]><link rel="stylesheet" href="/w/skins/MonoBook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/w/skins/MonoBook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="w/load484a.css?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wiki:resourceloader:filter:minify-css:7:29b70323345a439ab9ed7007e0c178a6 */</style>
<script src="w/load9316.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"Legacy","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":100,"wgPageName":"Legacy:Creating_A_WebApplication","wgTitle":"Creating A WebApplication","wgCurRevisionId":2255,"wgRevisionId":2255,"wgArticleId":797,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Legacy To Do"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Legacy:Creating_A_WebApplication","wgRelevantArticleId":797,"wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}"});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wiki:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-100 ns-subject page-Legacy_Creating_A_WebApplication skin-monobook action-view">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
									<div id="siteNotice"><div id="localNotice" lang="en" dir="ltr"><p>Once I get that upgrade to 36-hour days, I will tackle that. &#8211; Mychaeel
</p></div></div>
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Legacy:Creating A WebApplication</h1>

				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</div>
					<div id="contentSub"></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p><a href="Legacy_WebApplication.html" title="Legacy:WebApplication">WebApplications</a> are very useful for adding online administration to your mod. You could also use a WebApplication to display information about the server.</p>
<p>This document will describe how you can create your own WebApplication. This document is focused on <a href="Legacy_UT2003.html" title="Legacy:UT2003" class="mw-redirect">UT2003</a>, so something will not work the same if you use it for a other version.</p>
<p></p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Setup"><span class="tocnumber">1</span> <span class="toctext">Setup</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Configuration"><span class="tocnumber">1.1</span> <span class="toctext">Configuration</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Files"><span class="tocnumber">1.2</span> <span class="toctext">Files</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#WebApplication_class"><span class="tocnumber">2</span> <span class="toctext">WebApplication class</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#MyImageServer_class_.28optional.29"><span class="tocnumber">3</span> <span class="toctext">MyImageServer class (optional)</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Differences_between_UT2003_and_Devastation"><span class="tocnumber">4</span> <span class="toctext">Differences between UT2003 and Devastation</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Another_method_of_nationalization"><span class="tocnumber">5</span> <span class="toctext">Another method of nationalization</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_Topics"><span class="tocnumber">6</span> <span class="toctext">Related Topics</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Discussion"><span class="tocnumber">7</span> <span class="toctext">Discussion</span></a></li>
</ul>
</div>
<p></p>
<h2><span class="mw-headline" id="Setup">Setup</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Creating_A_WebApplication?section=1" title="Edit section: Setup">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Configuration">Configuration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Creating_A_WebApplication?section=2" title="Edit section: Configuration">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="br0">[</span>UWeb.<span class="me0">WebServer</span><span class="br0">]</span>
Applications<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="sy0">=</span>xWebAdmin.<span class="me0">UTServerAdmin</span>
ApplicationPaths<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="sy0">=/</span>ServerAdmin
Applications<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">=</span>xWebAdmin.<span class="me0">UTImageServer</span>
ApplicationPaths<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">=/</span>images
Applications<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="sy0">=</span>MyMod.<span class="me0">MyWebAdmin</span>
ApplicationPaths<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="sy0">=/</span>MyWebAdmin
Applications<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="sy0">=</span>MyMod.<span class="me0">MyImageServer</span>
ApplicationPaths<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="sy0">=/</span>MyImages
DefaultApplication<span class="sy0">=</span><span class="nu0">0</span>
bEnabled<span class="sy0">=</span><span class="kw6">True</span>
ListenPort<span class="sy0">=</span><span class="nu0">80</span>
MaxConnections<span class="sy0">=</span><span class="nu0">30</span>
ServerName<span class="sy0">=</span>myserver.<span class="me0">com</span>
ExpirationSeconds<span class="sy0">=</span><span class="nu0">86400</span>
</pre></div>
</div>
<p>In order to use your WebApplication you have to add it to the Applications list of the UWeb.WebServer. You can add up to 10 WebApplications. You also have to define the ApplicationPaths for your WebApplication. The ApplicationPath defines what WebApplication that should handle the request.</p>
<p>For example, when the request URL is:</p>
<pre>
 <a rel="nofollow" class="external free" href="http://myserver.com/ServerAdmin/somepage">http://myserver.com/ServerAdmin/somepage</a>
</pre>
<p>It will forward the request to the WebApplication with it's path set to: /ServerAdmin<br />
In this case that would be xWebAdmin.UTServerAdmin</p>
<p>If there's no Application assigned to the requested path it will load the default application.</p>
<h3><span class="mw-headline" id="Files">Files</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Creating_A_WebApplication?section=3" title="Edit section: Files">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>There are two ways to provide the data for the resulting pages.</p>
<p>The first method is to provide the output HTML inline with the code. This is a bad choice because it's ugly and difficult to maintain. It will also use more memory because the source code is much larger.</p>
<p>The second method is to provide the HTML (and images) as loose files in a directory.</p>
<p>All Web files are provided from the "Web" dir in your Unreal directory, when you include a file in the respons the location specified will be relative from this directory. It's best that you create a new subdirectory for your own WebApplication.</p>
<p>So your directory listing will look like this:</p>
<pre>
 UT2003
 |
 +- Web
    |
    +- images 
    +- ServerAdmin 
    +- MyWebAdmin   (place your HTML and CSS files here)
    +- MyImages     (for your graphics, if you use your own ImageServer)
</pre>
<p>For the rest of this document we assume we have the following files in the MyWebAdmin directory:</p>
<ul>
<li>index.html (the main document)</li>
<li>about.html (about document)</li>
</ul>
<p>And in the MyImages directory:</p>
<ul>
<li>title.gif</li>
</ul>
<h2><span class="mw-headline" id="WebApplication_class">WebApplication class</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Creating_A_WebApplication?section=4" title="Edit section: WebApplication class">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>TODO: note about <a href="Legacy_Modular_Mod.html" title="Legacy:Modular Mod">Modular_Mod</a></p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">class</span> MyWebAdmin <span class="kw1">extends</span> <span class="kw8">WebApplication</span>;
 
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> url_root;
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> file_default;
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> file_about;
</pre></div>
</div>
<p>Create a class that extends a WebApplication.</p>
<p>I've specified all files that this WebApplication serves as a localisable variable. This is usefull because it will prevents stupid typos in the filename, but also provides you with an easy way to localise your WebApplication. For an other language you just specify an other filename to use.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">event</span> Init<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
  <span class="co1">// do some init stuff</span>
  <span class="kw6">Super</span>.<span class="me0">Init</span><span class="br0">(</span><span class="br0">)</span>;
  <span class="kw3">log</span><span class="br0">(</span><span class="st0">"MyWebAdmin loaded"</span><span class="br0">)</span>;
<span class="br0">}</span>
</pre></div>
</div>
<p>The Init method is called when the WebApplication will be loaded. If you need to load some things, or find some references (find a mutator or something), you should do it here.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">event</span> <span class="kw5">bool</span> PreQuery<span class="br0">(</span><span class="kw8">WebRequest</span> Request, <span class="kw8">WebResponse</span> Response<span class="br0">)</span>
<span class="br0">{</span>
  <span class="kw2">if</span> <span class="br0">(</span><span class="sy0">!</span><span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">AccessControl</span>.<span class="me0">ValidLogin</span><span class="br0">(</span>Request.<span class="me0">Username</span>, Request.<span class="me0">Password</span><span class="br0">)</span><span class="br0">)</span>
  <span class="br0">{</span>
    Response.<span class="me0">FailAuthentication</span><span class="br0">(</span><span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">GameReplicationInfo</span>.<span class="me0">ServerName</span><span class="sy0">$</span><span class="st0">" MyWebAdmin"</span><span class="br0">)</span>;
    <span class="kw2">return</span> <span class="kw6">false</span>;
  <span class="br0">}</span>
  <span class="kw2">return</span> <span class="kw6">true</span>;
<span class="br0">}</span>
</pre></div>
</div>
<p>PreQuery is called before the Query is handled. If your WebApplication needs some authentication you should do it here.</p>
<p>In the above example I call the ValidLogin method of AccessControl, this will validate the username and password entered in the browser. If AccessControlIni is used it will check for a valid user/pass combination, otherwise it will just check if the adminpassword is correct.</p>
<p>When the username and password are correct it will return true and the WebApplication will continue with the Query event. Otherwise false is returned and query processes stops, a FailAuthentication is sent to the browser requiring the user to login again.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">function</span> Query<span class="br0">(</span><span class="kw8">WebRequest</span> Request, <span class="kw8">WebResponse</span> Response<span class="br0">)</span>
<span class="br0">{</span>
  <span class="kw2">switch</span> <span class="br0">(</span><span class="kw3">Mid</span><span class="br0">(</span>Request.<span class="me0">URI</span>, <span class="nu0">1</span><span class="br0">)</span><span class="br0">)</span>
  <span class="br0">{</span>
    <span class="kw2">case</span> <span class="st0">""</span>:
    <span class="kw2">case</span> file_default:  RequestIndex<span class="br0">(</span>Request, Response<span class="br0">)</span>; <span class="kw2">return</span>;
    <span class="kw2">case</span> file_about:    RequestAbout<span class="br0">(</span>Request, Response<span class="br0">)</span>; <span class="kw2">return</span>;
  <span class="br0">}</span>
  Response.<span class="me0">HTTPError</span><span class="br0">(</span><span class="nu0">404</span>, <span class="st0">""</span><span class="br0">)</span>;
<span class="br0">}</span>
</pre></div>
</div>
<p>Query event is called when a user requests a file. The Request.URI value is relative to the Application path defined for this application.</p>
<p>For example, when a user requests the following page:</p>
<pre>
 <a rel="nofollow" class="external free" href="http://myserver.com/ServerAdmin/index.html">http://myserver.com/ServerAdmin/index.html</a>
</pre>
<p>Request.URI will contain the following value:</p>
<pre>
 /index.html
</pre>
<p>We strip off the leading slash to check what file is requested. If the string is empty or same as the variable file_default we will call the RequestIndex method to handle.</p>
<p>If none of the cases match we will return a 404 HTTP Error.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">function</span> <span class="kw5">bool</span> RequestIndex<span class="br0">(</span><span class="kw8">WebRequest</span> Request, <span class="kw8">WebResponse</span> Response<span class="br0">)</span>
<span class="br0">{</span>
  Response.<span class="me0">Subst</span><span class="br0">(</span><span class="st0">"replace"</span>, <span class="st0">"withthis"</span><span class="br0">)</span>;
  Response.<span class="me0">IncludeUHTM</span><span class="br0">(</span>url_root<span class="sy0">$</span><span class="st0">"/"</span><span class="sy0">$</span>file_default<span class="br0">)</span>;
  Response.<span class="me0">ClearSubst</span><span class="br0">(</span><span class="br0">)</span>;
  <span class="kw2">return</span> <span class="kw6">true</span>;
<span class="br0">}</span>
</pre></div>
</div>
<p>The above method is called by Query when the client requests either "/" or "/index.html" (file_default = "index.html").</p>
<p>Response.Subst will replace all occurances of "&lt;%replace%&gt;" in the file to "withthis". Response.IncludeUHTM will include the HTML file to send. Response.ClearSubst will perform the substitutions in the included file.</p>
<p>Let's say that our index.html file looks like this:</p>
<pre>
 &lt;html&gt;
 &lt;head&gt;
   &lt;title&gt;MyWebAdmin&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
 &lt;img src="/MyImages/title.gif" alt="title image&gt;
 The replace item is replaced with: &lt;%replace%&gt; &lt;br&gt;
 &lt;a href="about.html"&gt;about this thing&lt;/a&gt;
 &lt;/body&gt;
 &lt;/html&gt;
</pre>
<p>The file returned by the server will look like this:</p>
<pre>
 &lt;html&gt;
 &lt;head&gt;
   &lt;title&gt;MyWebAdmin&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
 &lt;img src="/MyImages/title.gif" alt="title image&gt;
 The replace item is replaced with: withthis &lt;br&gt;
 &lt;a href="about.html"&gt;about this thing&lt;/a&gt;
 &lt;/body&gt;
 &lt;/html&gt;
</pre>
<p><i><b>Note:</b></i> I've added an image to the index.html doc, it refers to /MyImages/title.gif , if you do not provide your own ImageServer (this is usually not very useful to do) you should place your pictures in the UWeb/images dir and use /images/title.gif as image source.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">function</span> PostQuery<span class="br0">(</span><span class="kw8">WebRequest</span> Request, <span class="kw8">WebResponse</span> Response<span class="br0">)</span>
<span class="br0">{</span>
  <span class="co1">// do some cleanup here</span>
<span class="br0">}</span>
</pre></div>
</div>
<p>PostQuery is called after the the query was executed, you may want to do some clean up here.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">defaultproperties</span> 
<span class="br0">{</span>
  url_root<span class="sy0">=</span><span class="st0">"MyWebAdmin"</span>
  file_default<span class="sy0">=</span><span class="st0">"index.html"</span>
  file_about<span class="sy0">=</span><span class="st0">"about.html"</span>
<span class="br0">}</span>
</pre></div>
</div>
<p>Well these are the default values of the variable described above. If you have localized html files you could overwrite these within an .int file, so for file_default you could set it to: index-de.html (for german files) and index-fr.html (for french files)</p>
<h2><span class="mw-headline" id="MyImageServer_class_.28optional.29">MyImageServer class (optional)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Creating_A_WebApplication?section=5" title="Edit section: MyImageServer class (optional)">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">class</span> MyImageServer <span class="kw1">extends</span> ImageServer;
 
<span class="kw1">var</span> <span class="kw5">string</span> imagedir;
 
<span class="kw1">event</span> Query<span class="br0">(</span><span class="kw8">WebRequest</span> Request, <span class="kw8">WebResponse</span> Response<span class="br0">)</span>
<span class="br0">{</span>
  <span class="kw1">local</span> <span class="kw5">string</span> Image;
 
  Image <span class="sy0">=</span> <span class="kw3">Mid</span><span class="br0">(</span>Request.<span class="me0">URI</span>, <span class="nu0">1</span><span class="br0">)</span>;
  <span class="kw2">if</span><span class="br0">(</span> <span class="kw3">Right</span><span class="br0">(</span><span class="kw3">Caps</span><span class="br0">(</span>Image<span class="br0">)</span>, <span class="nu0">4</span><span class="br0">)</span> <span class="sy0">==</span> <span class="st0">".JPG"</span> <span class="sy0">||</span> <span class="kw3">Right</span><span class="br0">(</span><span class="kw3">Caps</span><span class="br0">(</span>Image<span class="br0">)</span>, <span class="nu0">5</span><span class="br0">)</span> <span class="sy0">==</span> <span class="st0">".JPEG"</span> <span class="br0">)</span>
  <span class="br0">{</span>
    Response.<span class="me0">SendStandardHeaders</span><span class="br0">(</span><span class="st0">"image/jpeg"</span>, <span class="kw6">true</span><span class="br0">)</span>;
  <span class="br0">}</span>
  <span class="kw2">else</span> <span class="kw2">if</span><span class="br0">(</span> <span class="kw3">Right</span><span class="br0">(</span><span class="kw3">Caps</span><span class="br0">(</span>Image<span class="br0">)</span>, <span class="nu0">4</span><span class="br0">)</span> <span class="sy0">==</span> <span class="st0">".GIF"</span> <span class="br0">)</span>
  <span class="br0">{</span>
    Response.<span class="me0">SendStandardHeaders</span><span class="br0">(</span><span class="st0">"image/gif"</span>, <span class="kw6">true</span><span class="br0">)</span>;
  <span class="br0">}</span>
  <span class="kw2">else</span> <span class="kw2">if</span><span class="br0">(</span> <span class="kw3">Right</span><span class="br0">(</span><span class="kw3">Caps</span><span class="br0">(</span>Image<span class="br0">)</span>, <span class="nu0">4</span><span class="br0">)</span> <span class="sy0">==</span> <span class="st0">".BMP"</span> <span class="br0">)</span>
  <span class="br0">{</span>
    Response.<span class="me0">SendStandardHeaders</span><span class="br0">(</span><span class="st0">"image/bmp"</span>, <span class="kw6">true</span><span class="br0">)</span>;
  <span class="br0">}</span>
  <span class="kw2">else</span> <span class="kw2">if</span><span class="br0">(</span> <span class="kw3">Right</span><span class="br0">(</span><span class="kw3">Caps</span><span class="br0">(</span>Image<span class="br0">)</span>, <span class="nu0">4</span><span class="br0">)</span> <span class="sy0">==</span> <span class="st0">".PNG"</span> <span class="br0">)</span>
  <span class="br0">{</span>
    Response.<span class="me0">SendStandardHeaders</span><span class="br0">(</span><span class="st0">"image/png"</span>, <span class="kw6">true</span><span class="br0">)</span>;
  <span class="br0">}</span>
  <span class="kw2">else</span>
  <span class="br0">{</span>
    Response.<span class="me0">HTTPError</span><span class="br0">(</span><span class="nu0">404</span><span class="br0">)</span>;
    <span class="kw2">return</span>;
  <span class="br0">}</span>
  Response.<span class="me0">IncludeBinaryFile</span><span class="br0">(</span> imagedir<span class="sy0">$</span><span class="st0">"/"</span><span class="sy0">$</span>Image <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw1">defaultproperties</span>
<span class="br0">{</span>
  imagedir<span class="sy0">=</span><span class="st0">"MyImages"</span>
<span class="br0">}</span>
</pre></div>
</div>
<p>Providing your own ImageServer is optional, and you should only do that if you provide a pretty large WebApplication with a lot of images.</p>
<p>The only thing diffirent from the default ImageServer and the above code is that this image server will serve the files from a diffirent directory (Web/MyImages) and I've added an extra mime type: "image/png"</p>
<h2><span class="mw-headline" id="Differences_between_UT2003_and_Devastation">Differences between UT2003 and Devastation</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Creating_A_WebApplication?section=6" title="Edit section: Differences between UT2003 and Devastation">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>There are a few differences between the code described above and that needed by <a href="Legacy_Devastation.html" title="Legacy:Devastation">Devastation</a>. These are detailed below. From the looks of the code the Devastation codebase is much closer to that of UT so these comments may apply to UT as well.</p>
<p>All files served by the Web Server application must be contained within the /Web directory. Files in sub-directories (or any filename containing a forwardslash or backslash will not be served. Instead you will see a <b>Dangerous characters in requested filename</b> error in your log.</p>
<p>The version of the engine used by Devastation does not support the <i>event bool PreQuery(WebRequest Request, WebResponse Response)</i> method within UScript (the function is defined as native). This means that a different approach needs to be taken for user authnentication. The code required is below.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="co1">// Add the following variables as class attributes.</span>
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">String</span> AdminRealm;
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">String</span> AdminUsername;
<span class="kw1">var</span> <span class="kw1">config</span> <span class="kw5">String</span> AdminPassword;
 
<span class="co1">// Add the following code at the start of your Query(WebRequest Request, WebResponse Response) function.</span>
<span class="co1">// Check authentication:</span>
<span class="kw2">if</span> <span class="br0">(</span><span class="br0">(</span>AdminUsername <span class="sy0">!=</span> <span class="st0">""</span> <span class="sy0">&amp;&amp;</span> <span class="kw3">Caps</span><span class="br0">(</span>Request.<span class="me0">Username</span><span class="br0">)</span> <span class="sy0">!=</span> <span class="kw3">Caps</span><span class="br0">(</span>AdminUsername<span class="br0">)</span><span class="br0">)</span> <span class="sy0">||</span> <span class="br0">(</span>AdminPassword <span class="sy0">!=</span> <span class="st0">""</span> <span class="sy0">&amp;&amp;</span> <span class="kw3">Caps</span><span class="br0">(</span>Request.<span class="me0">Password</span><span class="br0">)</span> <span class="sy0">!=</span> <span class="kw3">Caps</span><span class="br0">(</span>AdminPassword<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
  Response.<span class="me0">FailAuthentication</span><span class="br0">(</span>AdminRealm<span class="br0">)</span>;
  <span class="kw2">return</span>;
<span class="br0">}</span>
</pre></div>
</div>
<h2><span class="mw-headline" id="Another_method_of_nationalization">Another method of nationalization</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Creating_A_WebApplication?section=7" title="Edit section: Another method of nationalization">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>If you do not wish to store all of your pages in localized variables then an alternative is to prefix all of your files with the language identifier and an underscore.</p>
<p>Declare attributes on your class as follows:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">String</span> LangPrefix; <span class="co1">// This should be set to the language prefix (I use eng for English)</span>
<span class="kw1">var</span> <span class="kw5">String</span> pageDirectory;
</pre></div>
</div>
<p>Then add the following line of code to your Web Application's Init() function:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw6">self</span>.<span class="me0">pageDirectory</span> <span class="sy0">=</span> <span class="kw6">self</span>.<span class="me0">root_url</span><span class="sy0">$</span><span class="st0">"/"</span><span class="sy0">$</span>self.<span class="me0">LangPrefix</span><span class="sy0">$</span><span class="st0">"_"</span>;
</pre></div>
</div>
<p>The code to determine which page has been requested then becomes the following:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">function</span> Query<span class="br0">(</span><span class="kw8">WebRequest</span> Request, <span class="kw8">WebResponse</span> Response<span class="br0">)</span>
<span class="br0">{</span>
  <span class="kw1">local</span> <span class="kw5">int</span> underscorePos;
  <span class="kw1">local</span> <span class="kw5">String</span> requestedPage;
 
  underscorePos <span class="sy0">=</span> <span class="kw3">InStr</span><span class="br0">(</span> Request.<span class="me0">URI</span>, <span class="st0">"_"</span> <span class="br0">)</span>;
 
  <span class="kw2">if</span> <span class="br0">(</span>underscorePos <span class="sy0">==</span> <span class="sy0">-</span><span class="nu0">1</span> <span class="sy0">&amp;&amp;</span> <span class="kw3">Len</span><span class="br0">(</span>Request.<span class="me0">URI</span><span class="br0">)</span> <span class="sy0">&gt;</span> <span class="nu0">1</span><span class="br0">)</span>
  <span class="br0">{</span>
    <span class="kw3">Log</span><span class="br0">(</span> <span class="st0">"WebAdmin:: Bad URL requested - it has no underscore.  URL="</span><span class="sy0">$</span>Request.<span class="me0">URI</span> <span class="br0">)</span>;
  <span class="br0">}</span>
  <span class="kw2">else</span>
  <span class="br0">{</span>
    requestedPage <span class="sy0">=</span> <span class="kw3">Mid</span><span class="br0">(</span>Request.<span class="me0">URI</span>, underscorePos<span class="sy0">+</span><span class="nu0">1</span><span class="br0">)</span>;
    Response.<span class="me0">Subst</span><span class="br0">(</span> <span class="st0">"AdminDir"</span>, <span class="kw6">self</span>.<span class="me0">pageDirectory</span> <span class="br0">)</span>; <span class="co1">// Replacement for page locations done here as it applies to all pages</span>
    <span class="kw3">Log</span><span class="br0">(</span> <span class="st0">"DevWebAdmin:: Requested page is "</span><span class="sy0">$</span>requestedPage <span class="br0">)</span>;
 
    <span class="kw2">switch</span> <span class="br0">(</span> requestedPage <span class="br0">)</span>
    <span class="br0">{</span>
      <span class="kw2">case</span> <span class="st0">"/"</span>:
      <span class="kw2">case</span> <span class="st0">"index.html"</span>:
        RequestIndex<span class="br0">(</span>Request, Response<span class="br0">)</span>;
        <span class="kw2">return</span>;
      <span class="co1">// Rest of code follows as expected</span>
</pre></div>
</div>
<p>And finally, when declareing URLs within your html file you should use the following notation:</p>
<p>&lt;a href="&lt;%AdminDir%&gt;index.html"&gt;Home&lt;/a&gt;</p>
<h2><span class="mw-headline" id="Related_Topics">Related Topics</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Creating_A_WebApplication?section=8" title="Edit section: Related Topics">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul>
<li><a href="Legacy_Modular_Mod.html" title="Legacy:Modular Mod">Modular Mod</a></li>
<li><a href="Legacy_Sessions.html" title="Legacy:Sessions">Sessions</a></li>
<li><a href="Legacy_WebServer.html" title="Legacy:WebServer">WebServer</a></li>
</ul>
<h2><span class="mw-headline" id="Discussion">Discussion</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Creating_A_WebApplication?section=9" title="Edit section: Discussion">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><b>EntropicLqd:</b> Tarquin - I'm thinking of writing a tutorial for a fully working example based on the Devastation engine. Some of the content will obviously overlap the stuff on this page (I may be able to create the pages such that I avoid some duplication, but only by moving a fair amonut of content around) - any thoughts? Also, I'll be wanting to include the contents of the HTML pages used in the app. so I'll want to display the raw html. How do I do that using Wiki Markup. I can't see anything obvious on the Wiki Markup page (although it's quite possible I'm being particularly dense).</p>
<p><b>Tarquin:</b> Hmm... method 1: &lt;br /&gt; method 2:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="sy0">&lt;</span>br<span class="sy0">&gt;</span>
</pre></div>
</div>
<p>I know naaaaaathing (in the style of Manuel) about this topic, so do whatever you think is best&#160;:)</p>
<p><b>EntropicLqd:</b> Cool. I'll get on it. If I can send the kids outside to playin the street with cars over the weekend I might get it done this weekend - if not middle of next week. Considering you know nothing about it, the page is amazingly comprehensive. RE: The markup - I was being particuarly dense.</p>
<p><b>Tarquin:</b> I didn't write any of it...&#160;:) Is the page you mean <a href="Legacy_Devastation_Dedicated_Server.html" title="Legacy:Devastation Dedicated Server">Devastation Dedicated Server</a>? There's <a href="Legacy_Running_A_Dedicated_Server_With_UCC.html" title="Legacy:Running A Dedicated Server With UCC">Running A Dedicated Server With UCC</a> too. If all these are related can we try &amp; structure it around a hub page of some sort, eg <a href="https://wiki.beyondunreal.com/edit/Legacy:Dedicated_Server?redlink=1" class="new" title="Legacy:Dedicated Server (page does not exist)">Dedicated Server</a>?</p>
<p><b>EntropicLqd:</b> I'm sure it's related. And yes, a dedicated server page would probable make a lot of sense. Has anyone found a way of getting more than 24 hours into the day yet? I think I need to know how. So that's two areas on my work stack - this one (Web admin) and a dedicated server page. How nice.</p>
<p><b>Tarquin:</b> .... erm... just leave it for someone else to do, Ent! Don't stress it! <a href="Category_Legacy_To_Do.html" title="Category:Legacy To Do">Category:Legacy To Do</a>&#160;:p</p>
<p><b>ScratchMonkey:</b> Fixed the Subst examples. I spent a couple hours yesterday figuring out what I was doing wrong with a new UT2004 WebApplication subclass and called my brother in to compare my code to that of the XWebAdmin. He spotted the need for angle brackets in addition to the percent signs around the template variables in the HTML template file.</p>
<p>The Subst function actually registers a substitution, and the actual substitution happens when the file is rendered. I'm a little skeptical about the description of ClearSubst. I suspect it really removes the Subst entries from an internal table in the Response object.</p>

<!-- 
NewPP limit report
CPU time usage: 0.166 seconds
Real time usage: 0.168 seconds
Preprocessor visited node count: 169/1000000
Preprocessor generated node count: 370/1000000
Post‐expand include size: 25/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->

<!-- Saved in parser cache with key wiki:pcache:idhash:797-0!*!0!!en!*!* and timestamp 20161215153300 and revision id 2255
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://wiki.beyondunreal.com/Legacy:Creating_A_WebApplication?oldid=2255">https://wiki.beyondunreal.com/Legacy:Creating_A_WebApplication?oldid=2255</a>"</div>
					<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://wiki.beyondunreal.com/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="Category_Legacy_To_Do.html" title="Category:Legacy To Do">Legacy To Do</a></li></ul></div></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-legacy" class="selected"><a href="Legacy_Creating_A_WebApplication.html">Legacy</a></li>
				<li id="ca-talk" class="new"><a href="https://wiki.beyondunreal.com/edit/Legacy_talk:Creating_A_WebApplication?redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-edit"><a href="https://wiki.beyondunreal.com/edit/Legacy:Creating_A_WebApplication" title="You can edit this page. Please use the preview button before saving [e]" accesskey="e">Edit</a></li>
				<li id="ca-history"><a href="https://wiki.beyondunreal.com/history/Legacy:Creating_A_WebApplication" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-anonuserpage"><a href="User_188.162.37.html" class="new" title="The user page for the IP address you are editing as [.]" accesskey=".">188.162.37.3</a></li>
													<li id="pt-anontalk"><a href="User_talk_188.162.37.html" class="new" title="Discussion about edits from this IP address [n]" accesskey="n">Talk for this IP address</a></li>
													<li id="pt-createaccount"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=Legacy%3ACreating+A+WebApplication&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=Legacy%3ACreating+A+WebApplication" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="index.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-navigation" role="navigation">
		<h3>Navigation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-mainpage"><a href="index.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
											<li id="n-portal"><a href="Unreal_Wiki_Community_portal-2.html" title="About the project, what you can do, where to find things">Community portal</a></li>
											<li id="n-recentchanges"><a href="https://wiki.beyondunreal.com/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="https://wiki.beyondunreal.com/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
											<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											<li id="n-Forums-.28General.29"><a href="https://forums.beyondunreal.com/forums/wiki-general.250/" rel="nofollow">Forums (General)</a></li>
											<li id="n-Forums-.28Technical.29"><a href="https://forums.beyondunreal.com/forums/wiki-technical.251/" rel="nofollow">Forums (Technical)</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="https://wiki.beyondunreal.com/" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search Unreal Wiki [f]" accesskey="f" id="searchInput" />
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="https://wiki.beyondunreal.com/Special:WhatLinksHere/Legacy:Creating_A_WebApplication" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="https://wiki.beyondunreal.com/Special:RecentChangesLinked/Legacy:Creating_A_WebApplication" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="https://wiki.beyondunreal.com/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-print"><a href="https://wiki.beyondunreal.com/Legacy:Creating_A_WebApplication?printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
											<li id="t-permalink"><a href="https://wiki.beyondunreal.com/Legacy:Creating_A_WebApplication?oldid=2255" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="https://wiki.beyondunreal.com/info/Legacy:Creating_A_WebApplication" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-copyrightico">
									<a href="https://creativecommons.org/licenses/by-nc-sa/3.0/"><img src="../licensebuttons.net/l/by-nc-sa/3.0/88x31.png" alt="Attribution-Noncommercial-Share Alike 3.0" width="88" height="31" /></a>
							</div>
					<div id="f-poweredbyico">
									<script async src="../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <!-- Home Page -->
        <ins class="adsbygoogle"
             style="display:inline-block;width:728px;height:90px"
             data-ad-client="ca-pub-9605963037553244"
             data-ad-slot="9528541415"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
							</div>
					<ul id="f-list">
									<li id="lastmod"> Last modified at 21:39, 2 December 2005.</li>
									<li id="copyright">Licensed as <a href="Unreal_Wiki_Copyrights.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>
									<li id="privacy"><a href="Unreal_Wiki_Privacy_policy.html" title="Unreal Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="Unreal_Wiki_About.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>
									<li id="disclaimer"><a href="Unreal_Wiki_General_disclaimer.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.beyondunreal.com/w/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=monobook\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":94});
}</script></body>
<!-- Mirrored from wiki.beyondunreal.com/Legacy:Creating_A_WebApplication by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 09:36:59 GMT -->
</html>
