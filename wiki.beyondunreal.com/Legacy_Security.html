<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.beyondunreal.com/Legacy:Security by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 09:20:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>Legacy:Security - Unreal Wiki</title>
<meta name="generator" content="MediaWiki 1.25.1" />
<link rel="alternate" type="application/x-wiki" title="Edit" href="https://wiki.beyondunreal.com/edit/Legacy:Security" />
<link rel="edit" title="Edit" href="https://wiki.beyondunreal.com/edit/Legacy:Security" />
<link rel="shortcut icon" href="w/uewiki-favicon.png" />
<link rel="search" type="application/opensearchdescription+xml" href="w/opensearch_desc.php" title="Unreal Wiki" />
<link rel="EditURI" type="application/rsd+xml" href="w/api251f.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="Legacy_Security.html" />
<link rel="copyright" href="Unreal_Wiki_Copyrights.html" />
<link rel="alternate" type="application/atom+xml" title="Unreal Wiki Atom feed" href="https://wiki.beyondunreal.com/Special:RecentChanges?feed=atom" />
<link rel="stylesheet" href="w/load6852.css?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if IE 6]><link rel="stylesheet" href="/w/skins/MonoBook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/w/skins/MonoBook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="w/load484a.css?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wiki:resourceloader:filter:minify-css:7:29b70323345a439ab9ed7007e0c178a6 */</style>
<script src="w/load9316.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"Legacy","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":100,"wgPageName":"Legacy:Security","wgTitle":"Security","wgCurRevisionId":7727,"wgRevisionId":7727,"wgArticleId":2906,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Legacy Class (UT2003)","Legacy Class (UT2004)"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Legacy:Security","wgRelevantArticleId":2906,"wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}"});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wiki:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-100 ns-subject page-Legacy_Security skin-monobook action-view">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
									<div id="siteNotice"><div id="localNotice" lang="en" dir="ltr"><p>My program doesn't have bugs. It just develops random features.
</p></div></div>
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Legacy:Security</h1>

				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</div>
					<div id="contentSub"></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="infobox infobox-class infobox-legacy"><a href="Legacy_UT2003.html" title="Legacy:UT2003" class="mw-redirect">UT2003</a>&#160;:: <a href="Legacy_Actor.html" title="Legacy:Actor">Actor</a> &gt;&gt; <a href="Legacy_Info.html" title="Legacy:Info">Info</a> &gt;&gt; Security (Package: Engine)</div>
<p>Base class for UT200x client security actors. It provides methods to perform MD5 checks on any file or loaded game package.</p>
<p>Download UTSecure and <a href="Legacy_BatchExportCommandlet.html" title="Legacy:BatchExportCommandlet">export its code</a> if you want an example for using this class.</p>
<h2><span class="mw-headline" id="Properties">Properties</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Security?section=1" title="Edit section: Properties">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl>
<dt>int LastType&#160;</dt>
<dd>Stores the last type of check requested.</dd>
<dt>string LastParams[2]&#160;</dt>
<dd>Stores the last values of the two additional parameters of ClientPerform().</dd>
</dl>
<h2><span class="mw-headline" id="Methods">Methods</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Security?section=2" title="Edit section: Methods">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<dl>
<dt>NativePerform (int SecType, string Param1, string Param2) [native]&#160;</dt>
</dl>
<p>Performs a check based on the SecType and Params specified and calls ServerCallback() with the check results.</p>
<table class="wikitable">
<tr>
<td style="text-align: center"><b>SecType</b></td>
<td style="text-align: center"><b>Param1</b></td>
<td style="text-align: center"><b>Param2</b></td>
<td style="text-align: center"><b>Result</b></td>
</tr>
<tr>
<td>0</td>
<td>package name</td>
<td style="text-align: center">→</td>
<td>QuickMD5 of the specified package if it's loaded.</td>
</tr>
<tr>
<td>1</td>
<td>Package.ClassName.FunctionName</td>
<td style="text-align: center">→</td>
<td>CodeMD5 of the function (1)</td>
</tr>
<tr>
<td>2</td>
<td>file name, can contain path name</td>
<td style="text-align: center">→</td>
<td>FullMD5 of the specified file</td>
</tr>
<tr>
<td>3</td>
<td style="text-align: center">→</td>
<td style="text-align: center">→</td>
<td>pipe-separated ( | ) list of all packages loaded on the client (2)</td>
</tr>
</table>
<ol>
<li>CodeMD5 is unusable in all versions of UT200x: it returns a different MD5 every time you use it. The code (in memory) uses pointers to FName and UProperty objects as opposed to static index references to tables (i.e. name, import, and export tables) thus causing the client to calculate a different MD5 each time the game is loaded due to the randomness of memory allocation (i.e. the pointers in the code will point to different addresses every time the game loads.)<br />
It can, however, still be used to detect <i>if</i> a certain function exists.</li>
<li>Usually this list is far too large to be replicated through ServerCallback(), to it will not reach the server. You will have to prevent ServerCallback from being replicated by spawning the Security actor on the client if you want to use the SecType=3 with NativePerform.</li>
</ol>
<p><br /></p>
<dl>
<dt>LocalPerform (int SecType, string Param1, string Param2, out array&lt;string&gt; Results) [native]&#160;</dt>
</dl>
<p><i>Only UT2004.</i> Performs a check based on the SecType and Params specified and puts the results in the Results[] array.</p>
<table class="wikitable">
<tr>
<td style="text-align: center"><b>SecType</b></td>
<td style="text-align: center"><b>Param1</b></td>
<td style="text-align: center"><b>Param2</b></td>
<td style="text-align: center"><b>Result</b></td>
</tr>
<tr>
<td>0</td>
<td>package name</td>
<td style="text-align: center">→</td>
<td>QuickMD5 and GUID of the specified package as 64-digit hexadecimal number (1)</td>
</tr>
<tr>
<td>1</td>
<td>Package.ClassName.FunctionName</td>
<td style="text-align: center">→</td>
<td>CodeMD5 of the function (2)</td>
</tr>
<tr>
<td>2</td>
<td>file name, can contain path name</td>
<td style="text-align: center">→</td>
<td>FullMD5 of the specified file</td>
</tr>
<tr>
<td>3</td>
<td style="text-align: center">→</td>
<td style="text-align: center">→</td>
<td>List of packages loaded with their GUID and QuickMD5 and whether they are code packages (3)</td>
</tr>
<tr>
<td>100</td>
<td style="text-align: center">→</td>
<td style="text-align: center">→</td>
<td>List of <a href="Legacy_Input.html" title="Legacy:Input">Input</a> aliases (UT2004 v3270)</td>
</tr>
<tr>
<td>101</td>
<td style="text-align: center">→</td>
<td style="text-align: center">→</td>
<td>List of <a href="Legacy_Input.html" title="Legacy:Input">Input</a> keybinds (UT2004 v3270)</td>
</tr>
</table>
<ol>
<li>This is put into Results[0]. Left(Results[0], 32) gives the MD5, Right(Results[0], 32) gives the GUID.</li>
<li>CodeMD5 is broken in all versions of UT200x: it returns a different MD5 every time you use it.</li>
<li>The package list uses one array element per package and each array element consists of the package name, the package's GUID, the QuickMD5 and 0 for data package or 1 for code package like this:<br />
Engine:17158B3B4FF9A24F520996A03FACE2BE:daa163bc08d4aa79e46ea9e5e4e3eca5:1<br />
Shiptech:A0ADCAED408630B21D18DA933BE94B97:9aabf3549fbda7e8f49333f58bdd8af1:0</li>
</ol>
<p><br /></p>
<dl>
<dt>ClientPerform (int SecType, string Param1, string Param2) [simulated, replicated to client]&#160;</dt>
<dd>This just calls NativePerform with the specified parameters.</dd>
</dl>
<dl>
<dt>ServerCallback (int SecType, string Data) [replicated to server]&#160;</dt>
<dd>Called by the NativePerform function with the result of the checks. On success SecType will match the SecType specified for NativePerform and Data will contain the check result. On error SecType will be 255 and Data contains the error message like "Package not loaded" for a failed QuickMD5 or "File not found" for a failed FullMD5.</dd>
</dl>
<dl>
<dt>Perform (int SecType, string Param1, string Param2, float TimeOut)&#160;</dt>
<dd>This sets the LastType and LastParams class properties to the parameters specified, calls ClientPerform() with the specified parameters, sets the timer and goes to state Probation, which contains the Timer() function for detecting the timeout. You will most likely want to completely ignore this function in your security subclass just like UTSecure and Anti TCC do.</dd>
</dl>
<dl>
<dt>BadClient (int Code, string Data)&#160;</dt>
<dd>Called when the check times out. Again, you will most likely want to replace this with your own timeout handling.</dd>
</dl>
<dl>
<dt>ClientMessage (string s) [simulated, replicated to client]&#160;</dt>
<dd>By default this only logs the specified string, but you can also do something more interesting with the string. Anti TCC writes it to the ingame console, the client's main log file and a special Anti TCC client log file, for example.</dd>
</dl>
<h2><span class="mw-headline" id="Known_Subclasses">Known Subclasses</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Security?section=3" title="Edit section: Known Subclasses">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul>
<li><a href="https://wiki.beyondunreal.com/edit/Legacy:UnrealSecurity?redlink=1" class="new" title="Legacy:UnrealSecurity (page does not exist)">UnrealSecurity</a></li>
</ul>

<!-- 
NewPP limit report
CPU time usage: 0.025 seconds
Real time usage: 0.026 seconds
Preprocessor visited node count: 35/1000000
Preprocessor generated node count: 111/1000000
Post‐expand include size: 344/2097152 bytes
Template argument size: 105/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    2.295      1 - -total
100.00%    2.295      1 - Template:Classbox
-->

<!-- Saved in parser cache with key wiki:pcache:idhash:2906-0!*!0!!*!*!* and timestamp 20161215145517 and revision id 7727
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://wiki.beyondunreal.com/Legacy:Security?oldid=7727">https://wiki.beyondunreal.com/Legacy:Security?oldid=7727</a>"</div>
					<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://wiki.beyondunreal.com/Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="Category_Legacy_Class_(UT2003).html" title="Category:Legacy Class (UT2003)">Legacy Class (UT2003)</a></li><li><a href="Category_Legacy_Class_(UT2004).html" title="Category:Legacy Class (UT2004)">Legacy Class (UT2004)</a></li></ul></div></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-legacy" class="selected"><a href="Legacy_Security.html">Legacy</a></li>
				<li id="ca-talk" class="new"><a href="https://wiki.beyondunreal.com/edit/Legacy_talk:Security?redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-edit"><a href="https://wiki.beyondunreal.com/edit/Legacy:Security" title="You can edit this page. Please use the preview button before saving [e]" accesskey="e">Edit</a></li>
				<li id="ca-history"><a href="https://wiki.beyondunreal.com/history/Legacy:Security" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=Legacy%3ASecurity&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=Legacy%3ASecurity" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="index.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-navigation" role="navigation">
		<h3>Navigation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-mainpage"><a href="index.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
											<li id="n-portal"><a href="Unreal_Wiki_Community_portal-2.html" title="About the project, what you can do, where to find things">Community portal</a></li>
											<li id="n-recentchanges"><a href="https://wiki.beyondunreal.com/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="https://wiki.beyondunreal.com/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
											<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											<li id="n-Forums-.28General.29"><a href="https://forums.beyondunreal.com/forums/wiki-general.250/" rel="nofollow">Forums (General)</a></li>
											<li id="n-Forums-.28Technical.29"><a href="https://forums.beyondunreal.com/forums/wiki-technical.251/" rel="nofollow">Forums (Technical)</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="https://wiki.beyondunreal.com/" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search Unreal Wiki [f]" accesskey="f" id="searchInput" />
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="https://wiki.beyondunreal.com/Special:WhatLinksHere/Legacy:Security" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="https://wiki.beyondunreal.com/Special:RecentChangesLinked/Legacy:Security" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="https://wiki.beyondunreal.com/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-print"><a href="https://wiki.beyondunreal.com/Legacy:Security?printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
											<li id="t-permalink"><a href="https://wiki.beyondunreal.com/Legacy:Security?oldid=7727" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="https://wiki.beyondunreal.com/info/Legacy:Security" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-copyrightico">
									<a href="https://creativecommons.org/licenses/by-nc-sa/3.0/"><img src="../licensebuttons.net/l/by-nc-sa/3.0/88x31.png" alt="Attribution-Noncommercial-Share Alike 3.0" width="88" height="31" /></a>
							</div>
					<div id="f-poweredbyico">
									<script async src="../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <!-- Home Page -->
        <ins class="adsbygoogle"
             style="display:inline-block;width:728px;height:90px"
             data-ad-client="ca-pub-9605963037553244"
             data-ad-slot="9528541415"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
							</div>
					<ul id="f-list">
									<li id="lastmod"> Last modified at 03:24, 25 March 2008.</li>
									<li id="copyright">Licensed as <a href="Unreal_Wiki_Copyrights.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>
									<li id="privacy"><a href="Unreal_Wiki_Privacy_policy.html" title="Unreal Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="Unreal_Wiki_About.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>
									<li id="disclaimer"><a href="Unreal_Wiki_General_disclaimer.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.beyondunreal.com/w/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=monobook\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":77});
}</script></body>
<!-- Mirrored from wiki.beyondunreal.com/Legacy:Security by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 09:20:57 GMT -->
</html>
