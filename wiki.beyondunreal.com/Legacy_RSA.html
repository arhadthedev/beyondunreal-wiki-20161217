<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.beyondunreal.com/Legacy:RSA by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 07:56:53 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>Legacy:RSA - Unreal Wiki</title>
<meta name="generator" content="MediaWiki 1.25.1" />
<link rel="alternate" type="application/x-wiki" title="Edit" href="https://wiki.beyondunreal.com/edit/Legacy:RSA" />
<link rel="edit" title="Edit" href="https://wiki.beyondunreal.com/edit/Legacy:RSA" />
<link rel="shortcut icon" href="w/uewiki-favicon.png" />
<link rel="search" type="application/opensearchdescription+xml" href="w/opensearch_desc.php" title="Unreal Wiki" />
<link rel="EditURI" type="application/rsd+xml" href="w/api251f.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="Legacy_RSA.html" />
<link rel="copyright" href="Unreal_Wiki_Copyrights.html" />
<link rel="alternate" type="application/atom+xml" title="Unreal Wiki Atom feed" href="https://wiki.beyondunreal.com/Special:RecentChanges?feed=atom" />
<link rel="stylesheet" href="w/load2743.css?debug=false&amp;lang=en&amp;modules=ext.geshi.language.uscript%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if IE 6]><link rel="stylesheet" href="/w/skins/MonoBook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/w/skins/MonoBook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="w/load484a.css?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wiki:resourceloader:filter:minify-css:7:29b70323345a439ab9ed7007e0c178a6 */</style>
<script src="w/load9316.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"Legacy","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":100,"wgPageName":"Legacy:RSA","wgTitle":"RSA","wgCurRevisionId":40304,"wgRevisionId":40304,"wgArticleId":2614,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Legacy Algorithm"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Legacy:RSA","wgRelevantArticleId":2614,"wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}"});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wiki:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-100 ns-subject page-Legacy_RSA skin-monobook action-view">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
									<div id="siteNotice"><div id="localNotice" lang="en" dir="ltr"><p>My program doesn't have bugs. It just develops random features.
</p></div></div>
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Legacy:RSA</h1>

				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</div>
					<div id="contentSub"></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>R.S.A. stands for Rivest, Shamir and Adleman - the three cryptographers who invented this public key cryptosystem.</p>
<p>For information about RSA encryption see <a href="http://en.wikipedia.org/wiki/RSA" class="extiw" title="wikipedia:RSA">Wikipedia:RSA</a> and the related documents section below.</p>
<p></p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Code"><span class="tocnumber">1</span> <span class="toctext">Code</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#PowerMod"><span class="tocnumber">1.1</span> <span class="toctext">PowerMod</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#RSAGCD"><span class="tocnumber">1.2</span> <span class="toctext">_RSAGCD</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#RSAEncodeKeygen"><span class="tocnumber">1.3</span> <span class="toctext">RSAEncodeKeygen</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#RSADecodeKeygen"><span class="tocnumber">1.4</span> <span class="toctext">RSADecodeKeygen</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#NumBits"><span class="tocnumber">1.5</span> <span class="toctext">NumBits</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#RSAEncodeStream"><span class="tocnumber">1.6</span> <span class="toctext">RSAEncodeStream</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#RSADecodeStream"><span class="tocnumber">1.7</span> <span class="toctext">RSADecodeStream</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Example_usage"><span class="tocnumber">2</span> <span class="toctext">Example usage</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Comments"><span class="tocnumber">3</span> <span class="toctext">Comments</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Related_documents"><span class="tocnumber">4</span> <span class="toctext">Related documents</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Related_Topics"><span class="tocnumber">5</span> <span class="toctext">Related Topics</span></a></li>
</ul>
</div>
<p></p>
<h2><span class="mw-headline" id="Code">Code</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:RSA?section=1" title="Edit section: Code">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This code uses integers, integers are 32bit in UnrealScript. Because of this the encryption as shown in the document isn't very secure. The improved code can have encryption up to 23bit, the previous implementation was limited to 13bits.</p>
<p>Using floats is not an option because they will lose signification at a certain point.</p>
<p>This code can be used under the terms of the <a rel="nofollow" class="external text" href="http://www.opensource.org/licenses/zlib-license.php">ZLib/LibPNG</a> license:</p>
<pre>
Copyright (c) 2004 Michiel Hendriks &amp; UnrealWiki Contributers
http://wiki.beyondunreal.com/edit/Legacy:RSA

This software is provided 'as-is', without any express or implied
warranty. In no event will the authors be held liable for any damages
arising from the use of this software.

Permission is granted to anyone to use this software for any purpose,
including commercial applications, and to alter it and redistribute it
freely, subject to the following restrictions:

    1. The origin of this software must not be misrepresented; you must not
    claim that you wrote the original software. If you use this software
    in a product, an acknowledgment in the product documentation would be
    appreciated but is not required.

    2. Altered source versions must be plainly marked as such, and must not be
    misrepresented as being the original software.

    3. This notice may not be removed or altered from any source
    distribution.
</pre>
<h3><span class="mw-headline" id="PowerMod">PowerMod</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:RSA?section=2" title="Edit section: PowerMod">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Support function to calculate <code>b^e mod m</code>. Because float signification you can't just use <code>C**D%N</code></p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">function</span> <span class="kw5">int</span> PowerMod<span class="br0">(</span><span class="kw5">int</span> C, <span class="kw5">int</span> D, <span class="kw5">int</span> N<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">local</span> <span class="kw5">int</span> p;
    c <span class="sy0">=</span> mod<span class="br0">(</span>c, n<span class="br0">)</span>;
    <span class="kw2">if</span> <span class="br0">(</span>c <span class="sy0">&lt;</span> <span class="nu0">0</span><span class="br0">)</span> c <span class="sy0">+=</span> n;
    p <span class="sy0">=</span> <span class="nu0">1</span>;
    <span class="kw2">while</span> <span class="br0">(</span>d <span class="sy0">&gt;=</span> <span class="nu0">1</span><span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw2">if</span> <span class="br0">(</span><span class="br0">(</span>d <span class="sy0">&amp;</span> <span class="nu0">1</span><span class="br0">)</span> <span class="sy0">==</span> <span class="nu0">1</span><span class="br0">)</span> p <span class="sy0">=</span> mulmod<span class="br0">(</span>c, p, n<span class="br0">)</span>;
        c <span class="sy0">=</span> mulmod<span class="br0">(</span>c, c, n<span class="br0">)</span>;
        d <span class="sy0">=</span> d <span class="sy0">/</span> <span class="nu0">2</span>;
    <span class="br0">}</span>
    <span class="kw2">return</span> p;
<span class="br0">}</span>
 
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">function</span> <span class="kw5">int</span> mulmod<span class="br0">(</span><span class="kw5">int</span> C, <span class="kw5">int</span> D, <span class="kw5">int</span> N<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">local</span> <span class="kw5">int</span> p;
    c <span class="sy0">=</span> mod<span class="br0">(</span>c, n<span class="br0">)</span>;
    <span class="kw2">if</span> <span class="br0">(</span>c <span class="sy0">&lt;</span> <span class="nu0">0</span><span class="br0">)</span> c <span class="sy0">+=</span> n;
    p <span class="sy0">=</span> <span class="nu0">0</span>;
    <span class="kw2">while</span> <span class="br0">(</span>d <span class="sy0">&gt;=</span> <span class="nu0">1</span><span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw2">if</span> <span class="br0">(</span><span class="br0">(</span>d <span class="sy0">&amp;</span> <span class="nu0">1</span><span class="br0">)</span> <span class="sy0">==</span> <span class="nu0">1</span><span class="br0">)</span> p <span class="sy0">=</span> mod<span class="br0">(</span>c <span class="sy0">+</span> p, n<span class="br0">)</span>;
        c <span class="sy0">=</span> mod<span class="br0">(</span>c <span class="sy0">*</span> <span class="nu0">2</span>, n<span class="br0">)</span>;
        d <span class="sy0">=</span> d <span class="sy0">/</span> <span class="nu0">2</span>;
    <span class="br0">}</span>
    <span class="kw2">return</span> p;
<span class="br0">}</span>
 
<span class="coMULTI">/**
 * int precision modulo function.
 * Like the % operator, this function returns a negative result for negative a.
 */</span>
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">function</span> <span class="kw5">int</span> mod<span class="br0">(</span><span class="kw5">int</span> a, <span class="kw5">int</span> n<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw2">return</span> a <span class="sy0">-</span> <span class="br0">(</span>a <span class="sy0">/</span> n<span class="br0">)</span> <span class="sy0">*</span> n;
<span class="br0">}</span>
</pre></div>
</div>
<h3><span class="mw-headline" id="RSAGCD">_RSAGCD</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:RSA?section=3" title="Edit section: RSAGCD">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>A private function to calculate the Greatest Common Divider, this is use to calculate the encryption key</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">private</span> <span class="kw1">function</span> <span class="kw5">int</span> _RSAGCD<span class="br0">(</span><span class="kw5">int</span> e, <span class="kw5">int</span> PHI<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">local</span> <span class="kw5">int</span> great, a;
    <span class="kw2">if</span> <span class="br0">(</span>e <span class="sy0">&gt;</span> PHI<span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw2">while</span> <span class="br0">(</span>mod<span class="br0">(</span>e, PHI<span class="br0">)</span> <span class="sy0">!=</span> <span class="nu0">0</span><span class="br0">)</span>
        <span class="br0">{</span>
            a <span class="sy0">=</span> mod<span class="br0">(</span>e, PHI<span class="br0">)</span>;
            e <span class="sy0">=</span> PHI;
            PHI <span class="sy0">=</span> a;
        <span class="br0">}</span>
        great <span class="sy0">=</span> PHI;
    <span class="br0">}</span>
    <span class="kw2">else</span> <span class="br0">{</span>
        <span class="kw2">while</span> <span class="br0">(</span>mod<span class="br0">(</span>PHI, e<span class="br0">)</span> <span class="sy0">!=</span> <span class="nu0">0</span><span class="br0">)</span>
        <span class="br0">{</span>
            a <span class="sy0">=</span> mod<span class="br0">(</span>PHI, e<span class="br0">)</span>;
            PHI <span class="sy0">=</span> e;
            e <span class="sy0">=</span> a;
        <span class="br0">}</span>
        great <span class="sy0">=</span> e;
    <span class="br0">}</span>
    <span class="kw2">return</span> great;
<span class="br0">}</span>
</pre></div>
</div>
<h3><span class="mw-headline" id="RSAEncodeKeygen">RSAEncodeKeygen</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:RSA?section=4" title="Edit section: RSAEncodeKeygen">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This method will calculate the encryption key E from the prime numbers you supply.</p>
<p>P and Q have to be prime and unequal. N=P*Q and must be large enough to contain all possible values you need to encrypt..</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">function</span> <span class="kw5">int</span> RSAPublicKeygen<span class="br0">(</span><span class="kw5">int</span> p, <span class="kw5">int</span> q<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">local</span> <span class="kw5">int</span> PHI, E, great;
    PHI <span class="sy0">=</span> <span class="br0">(</span>p<span class="sy0">-</span><span class="nu0">1</span><span class="br0">)</span><span class="sy0">*</span><span class="br0">(</span>q<span class="sy0">-</span><span class="nu0">1</span><span class="br0">)</span>;
    great <span class="sy0">=</span> <span class="nu0">0</span>;
    E <span class="sy0">=</span> <span class="nu0">2</span>;
    <span class="kw2">while</span> <span class="br0">(</span>great <span class="sy0">!=</span> <span class="nu0">1</span><span class="br0">)</span>
    <span class="br0">{</span>
        E<span class="sy0">++</span>;
        great <span class="sy0">=</span> _RSAGCD<span class="br0">(</span>E, PHI<span class="br0">)</span>;
    <span class="br0">}</span>
    <span class="kw2">return</span> E;
<span class="br0">}</span>
</pre></div>
</div>
<h3><span class="mw-headline" id="RSADecodeKeygen">RSADecodeKeygen</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:RSA?section=5" title="Edit section: RSADecodeKeygen">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This will calculate the decrypt key D for the corresponding encrypt key</p>
<p>Use the same P and Q as you did with the encrypt key</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">function</span> <span class="kw5">int</span> RSAPrivateKeygen<span class="br0">(</span><span class="kw5">int</span> E, <span class="kw5">int</span> p, <span class="kw5">int</span> q<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">local</span> <span class="kw5">int</span> PHI, u1, u2, u3, v1, v2, v3, t1, t2, t3, z;
    PHI <span class="sy0">=</span> <span class="br0">(</span>p<span class="sy0">-</span><span class="nu0">1</span><span class="br0">)</span><span class="sy0">*</span><span class="br0">(</span>q<span class="sy0">-</span><span class="nu0">1</span><span class="br0">)</span>;
    u1 <span class="sy0">=</span> <span class="nu0">1</span>;
    u2 <span class="sy0">=</span> <span class="nu0">0</span>;
    u3 <span class="sy0">=</span> PHI;
    v1 <span class="sy0">=</span> <span class="nu0">0</span>;
    v2 <span class="sy0">=</span> <span class="nu0">1</span>;
    v3 <span class="sy0">=</span> E;
    <span class="kw2">while</span> <span class="br0">(</span>v3 <span class="sy0">!=</span> <span class="nu0">0</span><span class="br0">)</span>
    <span class="br0">{</span>
        z <span class="sy0">=</span> u3<span class="sy0">/</span>v3;
        t1 <span class="sy0">=</span> u1<span class="sy0">-</span>z<span class="sy0">*</span>v1;
        t2 <span class="sy0">=</span> u2<span class="sy0">-</span>z<span class="sy0">*</span>v2;
        t3 <span class="sy0">=</span> u3<span class="sy0">-</span>z<span class="sy0">*</span>v3;
        u1 <span class="sy0">=</span> v1;
        u2 <span class="sy0">=</span> v2;
        u3 <span class="sy0">=</span> v3;
        v1 <span class="sy0">=</span> t1;
        v2 <span class="sy0">=</span> t2;
        v3 <span class="sy0">=</span> t3;
    <span class="br0">}</span>
    <span class="kw2">if</span> <span class="br0">(</span>u2 <span class="sy0">&lt;</span> <span class="nu0">0</span><span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw2">return</span> u2 <span class="sy0">+</span> PHI;
    <span class="br0">}</span>
    <span class="kw2">else</span> <span class="br0">{</span>
        <span class="kw2">return</span> u2;
    <span class="br0">}</span>
<span class="br0">}</span>
</pre></div>
</div>
<h3><span class="mw-headline" id="NumBits">NumBits</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:RSA?section=6" title="Edit section: NumBits">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This will return the number of bits used in an integer.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">function</span> <span class="kw5">int</span> NumBits<span class="br0">(</span><span class="kw5">int</span> sample<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">local</span> <span class="kw5">int</span> bits;
    bits <span class="sy0">=</span> <span class="nu0">0</span>;
    <span class="kw2">while</span> <span class="br0">(</span>sample <span class="sy0">&gt;</span> <span class="nu0">0</span><span class="br0">)</span>
    <span class="br0">{</span>
        sample <span class="sy0">=</span> sample <span class="sy0">&gt;&gt;&gt;</span> <span class="nu0">1</span>;
        bits<span class="sy0">++</span>;
    <span class="br0">}</span>
    <span class="kw2">return</span> bits;
<span class="br0">}</span>
</pre></div>
</div>
<h3><span class="mw-headline" id="RSAEncodeStream">RSAEncodeStream</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:RSA?section=7" title="Edit section: RSAEncodeStream">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This will encode the string using the keys E and N <code>(=P*Q)</code>. the output will be stored in the int array data2.</p>
<p>It will automactially adjust to window size according to the size of N. When N is more than 15 bits two characters will put in a single integer.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">function</span> RSAEncodeStream<span class="br0">(</span><span class="kw1">coerce</span> <span class="kw5">string</span> data, <span class="kw5">int</span> E, <span class="kw5">int</span> N, <span class="kw1">out</span> array<span class="sy0">&lt;</span>int<span class="sy0">&gt;</span> data2<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">local</span> <span class="kw5">int</span> i, c, window, j;
    window <span class="sy0">=</span> NumBits<span class="br0">(</span>N<span class="br0">)</span><span class="sy0">/</span><span class="nu0">8</span>;
    <span class="kw2">for</span> <span class="br0">(</span>i <span class="sy0">=</span> <span class="nu0">0</span>; i <span class="sy0">&lt;</span> <span class="kw3">len</span><span class="br0">(</span>data<span class="br0">)</span>; i <span class="sy0">=</span> i<span class="sy0">+</span>window<span class="br0">)</span>
    <span class="br0">{</span>
        c <span class="sy0">=</span> <span class="nu0">0</span>;
        <span class="kw2">for</span> <span class="br0">(</span>j <span class="sy0">=</span> <span class="nu0">0</span>; j <span class="sy0">&lt;</span> window; j<span class="sy0">++</span><span class="br0">)</span>
        <span class="br0">{</span>
            c <span class="sy0">+=</span> <span class="kw3">Asc</span><span class="br0">(</span><span class="kw3">Mid</span><span class="br0">(</span>data,i<span class="sy0">+</span>j,<span class="nu0">1</span><span class="br0">)</span><span class="br0">)</span> <span class="sy0">&lt;&lt;</span> <span class="br0">(</span>window<span class="sy0">-</span>j<span class="sy0">-</span><span class="nu0">1</span><span class="br0">)</span><span class="sy0">*</span><span class="nu0">8</span>;
        <span class="br0">}</span>
        data2<span class="br0">[</span>data2.<span class="me0">length</span><span class="br0">]</span> <span class="sy0">=</span> PowerMod<span class="br0">(</span>c,E,N<span class="br0">)</span>;
    <span class="br0">}</span>
<span class="br0">}</span>
</pre></div>
</div>
<h3><span class="mw-headline" id="RSADecodeStream">RSADecodeStream</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:RSA?section=8" title="Edit section: RSADecodeStream">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This will decrypt the array data to the correct string value.</p>
<p>It will automactially adjust to window size according to the size of N.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">function</span> <span class="kw5">string</span> RSADecodeStream<span class="br0">(</span>array<span class="sy0">&lt;</span>int<span class="sy0">&gt;</span> data, <span class="kw5">int</span> D, <span class="kw5">int</span> N<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">local</span> <span class="kw5">int</span> i, c, window;
    <span class="kw1">local</span> <span class="kw5">string</span> result;
    window <span class="sy0">=</span> NumBits<span class="br0">(</span>N<span class="br0">)</span><span class="sy0">/</span><span class="nu0">8</span>;
    <span class="kw2">for</span> <span class="br0">(</span>i <span class="sy0">=</span> <span class="nu0">0</span>; i <span class="sy0">&lt;</span> data.<span class="me0">length</span>; i<span class="sy0">++</span><span class="br0">)</span>
    <span class="br0">{</span>
        c <span class="sy0">=</span> PowerMod<span class="br0">(</span>data<span class="br0">[</span>i<span class="br0">]</span>,D,N<span class="br0">)</span>;
        <span class="kw2">if</span> <span class="br0">(</span>window <span class="sy0">&gt;</span> <span class="nu0">3</span><span class="br0">)</span> result <span class="sy0">$=</span> <span class="kw3">chr</span><span class="br0">(</span><span class="br0">(</span>c <span class="sy0">&amp;</span> 0xff000000<span class="br0">)</span> <span class="sy0">&gt;&gt;</span> <span class="nu0">24</span><span class="br0">)</span>;
        <span class="kw2">if</span> <span class="br0">(</span>window <span class="sy0">&gt;</span> <span class="nu0">2</span><span class="br0">)</span> result <span class="sy0">$=</span> <span class="kw3">chr</span><span class="br0">(</span><span class="br0">(</span>c <span class="sy0">&amp;</span> 0x00ff0000<span class="br0">)</span> <span class="sy0">&gt;&gt;</span> <span class="nu0">16</span><span class="br0">)</span>;
        <span class="kw2">if</span> <span class="br0">(</span>window <span class="sy0">&gt;</span> <span class="nu0">1</span><span class="br0">)</span> result <span class="sy0">$=</span> <span class="kw3">chr</span><span class="br0">(</span><span class="br0">(</span>c <span class="sy0">&amp;</span> 0x0000ff00<span class="br0">)</span> <span class="sy0">&gt;&gt;</span> <span class="nu0">8</span><span class="br0">)</span>;
        result <span class="sy0">$=</span> <span class="kw3">chr</span><span class="br0">(</span><span class="br0">(</span>c <span class="sy0">&amp;</span> 0x000000ff<span class="br0">)</span><span class="br0">)</span>;
    <span class="br0">}</span>
    <span class="kw2">return</span> result;
<span class="br0">}</span>
</pre></div>
</div>
<h2><span class="mw-headline" id="Example_usage">Example usage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:RSA?section=9" title="Edit section: Example usage">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Here's an example that creates the keys, encrypts and decrypts and checks if they're equal. It will also print the encrypted data.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">function</span> <span class="kw5">bool</span> EncTest<span class="br0">(</span><span class="kw5">int</span> p, <span class="kw5">int</span> q, <span class="kw5">string</span> testData<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">local</span> <span class="kw5">string</span> s2;
    <span class="kw1">local</span> <span class="kw5">int</span> n,e,d;
    <span class="kw1">local</span> array<span class="sy0">&lt;</span>int<span class="sy0">&gt;</span> ia;
 
    n <span class="sy0">=</span> p<span class="sy0">*</span>q;
 
    <span class="kw2">if</span> <span class="br0">(</span>NumBits<span class="br0">(</span>N<span class="br0">)</span> <span class="sy0">&lt;</span> <span class="nu0">8</span><span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw3">warn</span><span class="br0">(</span><span class="st0">"Not enough bits for encrypting the data"</span><span class="br0">)</span>;
        <span class="kw2">return</span> <span class="kw6">false</span>;
    <span class="br0">}</span>
 
    e <span class="sy0">=</span> RSAEncodeKeygen<span class="br0">(</span>p, q<span class="br0">)</span>;
    d <span class="sy0">=</span> RSADecodeKeygen<span class="br0">(</span>e, p, q<span class="br0">)</span>;
 
    <span class="kw3">log</span><span class="br0">(</span><span class="st0">"p="</span><span class="sy0">$</span>p<span class="sy0">@</span><span class="st0">"q="</span><span class="sy0">$</span>q<span class="sy0">@</span><span class="st0">"n="</span><span class="sy0">$</span>n<span class="sy0">@</span><span class="st0">"e="</span><span class="sy0">$</span>e<span class="sy0">@</span><span class="st0">"d="</span><span class="sy0">$</span>d<span class="sy0">@</span><span class="st0">"bits="</span><span class="sy0">$</span>NumBits<span class="br0">(</span>N<span class="br0">)</span><span class="br0">)</span>;
 
    <span class="kw3">log</span><span class="br0">(</span><span class="st0">"Source:"</span><span class="sy0">$</span>chr<span class="br0">(</span><span class="nu0">9</span><span class="br0">)</span><span class="sy0">$</span>chr<span class="br0">(</span><span class="nu0">9</span><span class="br0">)</span><span class="sy0">@</span>testData<span class="br0">)</span>;
    RSAEncodeStream<span class="br0">(</span>testData, e, n, ia<span class="br0">)</span>;
    <span class="kw3">log</span><span class="br0">(</span><span class="st0">"Encrypted:"</span><span class="sy0">$</span>chr<span class="br0">(</span><span class="nu0">9</span><span class="br0">)</span><span class="sy0">@</span>printByteArray<span class="br0">(</span>ia<span class="br0">)</span><span class="br0">)</span>;
    s2 <span class="sy0">=</span> RSADecodeStream<span class="br0">(</span>ia, d, n<span class="br0">)</span>;
    <span class="kw3">log</span><span class="br0">(</span><span class="st0">"Decrypted:"</span><span class="sy0">$</span>chr<span class="br0">(</span><span class="nu0">9</span><span class="br0">)</span><span class="sy0">@</span>s2<span class="br0">)</span>;
 
    <span class="kw2">return</span> s2 <span class="sy0">==</span> testData;
<span class="br0">}</span>
</pre></div>
</div>
<p>When called with <code>EncTest(2851, 2927, "012345 hello world")</code> it will output:</p>
<pre>
p=2851 q=2927 n=8344877 e=13 d=2565877 bits=23
Source:          012345 hello world
Encrypted:       001075070001d062007efb6800542d6800471922003fc53e00692eae005a3a310074b044
Decrypted:       012345 hello world
</pre>
<p>Note that I left in the values of <code>p</code> and <code>q</code> in the above example. You should remove the usage of <code>p</code> and <code>q</code> when you no longer need them. When you have decided what <code>p</code> and <code>q</code> to use calculate the <code>n</code>, <code>e</code> and <code>d</code> values and use them in the rest of your code.</p>
<h2><span class="mw-headline" id="Comments">Comments</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:RSA?section=10" title="Edit section: Comments">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><b>Sixpack_Shambler:</b> Hmmmm....I've tried this code out and when I decrypt a string I don't even have to use the decrypt string to decrypt it, I just converted every signgle byte in the encrypted array to big string and it came out as EXACTLY the same string as what I put in&#160;:/</p>
<p><b>El Muerte:</b> then you didn't pick correct prime numbers. I've improved the implementation, it can now encrypt up to 23bits, thus allowing a window size of 2 bytes.</p>
<p><b>UsAaR33:</b> Do you think it would be possible to perhaps rewrite some math algorithms? With structures and some funky overloading, you could probably use much higher bit encryption. Right now, you can factor out the private key in seconds...</p>
<p><b>El Muerte:</b> both me and PJMODOS once started on an BigInt implementation, but neither of use ever finished it (at least not ebough to have all required operators). But it should be possible to create a BigInt type, but it won't be as nice\fast as a C or Pascal implementation (w.r.t. normal execution time in unrealscript).</p>
<h2><span class="mw-headline" id="Related_documents">Related documents</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:RSA?section=11" title="Edit section: Related documents">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul>
<li><a rel="nofollow" class="external free" href="http://pajhome.org.uk/crypt/rsa">http://pajhome.org.uk/crypt/rsa</a></li>
<li><a rel="nofollow" class="external free" href="http://www.di-mgt.com.au/rsa_alg.html">http://www.di-mgt.com.au/rsa_alg.html</a></li>
</ul>
<h2><span class="mw-headline" id="Related_Topics">Related Topics</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:RSA?section=12" title="Edit section: Related Topics">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul>
<li><a href="Legacy_Open_Source.html" title="Legacy:Open Source">Open Source</a></li>
<li><a href="Legacy_WUtils.html" title="Legacy:WUtils">WUtils</a></li>
</ul>

<!-- 
NewPP limit report
CPU time usage: 0.119 seconds
Real time usage: 0.120 seconds
Preprocessor visited node count: 129/1000000
Preprocessor generated node count: 240/1000000
Postâ€expand include size: 3/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->

<!-- Saved in parser cache with key wiki:pcache:idhash:2614-0!*!0!!en!*!* and timestamp 20161215143210 and revision id 40304
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://wiki.beyondunreal.com/Legacy:RSA?oldid=40304">https://wiki.beyondunreal.com/Legacy:RSA?oldid=40304</a>"</div>
					<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://wiki.beyondunreal.com/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="Category_Legacy_Algorithm.html" title="Category:Legacy Algorithm">Legacy Algorithm</a></li></ul></div></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-legacy" class="selected"><a href="Legacy_RSA.html">Legacy</a></li>
				<li id="ca-talk"><a href="Legacy_talk_RSA.html" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-edit"><a href="https://wiki.beyondunreal.com/edit/Legacy:RSA" title="You can edit this page. Please use the preview button before saving [e]" accesskey="e">Edit</a></li>
				<li id="ca-history"><a href="https://wiki.beyondunreal.com/history/Legacy:RSA" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=Legacy%3ARSA&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=Legacy%3ARSA" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="index.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-navigation" role="navigation">
		<h3>Navigation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-mainpage"><a href="index.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
											<li id="n-portal"><a href="Unreal_Wiki_Community_portal-2.html" title="About the project, what you can do, where to find things">Community portal</a></li>
											<li id="n-recentchanges"><a href="https://wiki.beyondunreal.com/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="https://wiki.beyondunreal.com/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
											<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											<li id="n-Forums-.28General.29"><a href="https://forums.beyondunreal.com/forums/wiki-general.250/" rel="nofollow">Forums (General)</a></li>
											<li id="n-Forums-.28Technical.29"><a href="https://forums.beyondunreal.com/forums/wiki-technical.251/" rel="nofollow">Forums (Technical)</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="https://wiki.beyondunreal.com/" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search Unreal Wiki [f]" accesskey="f" id="searchInput" />
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="https://wiki.beyondunreal.com/Special:WhatLinksHere/Legacy:RSA" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="https://wiki.beyondunreal.com/Special:RecentChangesLinked/Legacy:RSA" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="https://wiki.beyondunreal.com/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-print"><a href="https://wiki.beyondunreal.com/Legacy:RSA?printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
											<li id="t-permalink"><a href="https://wiki.beyondunreal.com/Legacy:RSA?oldid=40304" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="https://wiki.beyondunreal.com/info/Legacy:RSA" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-copyrightico">
									<a href="https://creativecommons.org/licenses/by-nc-sa/3.0/"><img src="../licensebuttons.net/l/by-nc-sa/3.0/88x31.png" alt="Attribution-Noncommercial-Share Alike 3.0" width="88" height="31" /></a>
							</div>
					<div id="f-poweredbyico">
									<script async src="../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <!-- Home Page -->
        <ins class="adsbygoogle"
             style="display:inline-block;width:728px;height:90px"
             data-ad-client="ca-pub-9605963037553244"
             data-ad-slot="9528541415"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
							</div>
					<ul id="f-list">
									<li id="lastmod"> Last modified at 08:44, 26 November 2009.</li>
									<li id="copyright">Licensed as <a href="Unreal_Wiki_Copyrights.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>
									<li id="privacy"><a href="Unreal_Wiki_Privacy_policy.html" title="Unreal Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="Unreal_Wiki_About.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>
									<li id="disclaimer"><a href="Unreal_Wiki_General_disclaimer.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.beyondunreal.com/w/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=monobook\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":161});
}</script></body>
<!-- Mirrored from wiki.beyondunreal.com/Legacy:RSA by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 07:56:53 GMT -->
</html>
