<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.beyondunreal.com/Legacy:AssociativeArray by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 09:34:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>Legacy:AssociativeArray - Unreal Wiki</title>
<meta name="generator" content="MediaWiki 1.25.1" />
<link rel="alternate" type="application/x-wiki" title="Edit" href="https://wiki.beyondunreal.com/edit/Legacy:AssociativeArray" />
<link rel="edit" title="Edit" href="https://wiki.beyondunreal.com/edit/Legacy:AssociativeArray" />
<link rel="shortcut icon" href="w/uewiki-favicon.png" />
<link rel="search" type="application/opensearchdescription+xml" href="w/opensearch_desc.php" title="Unreal Wiki" />
<link rel="EditURI" type="application/rsd+xml" href="w/api251f.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="Legacy_AssociativeArray.html" />
<link rel="copyright" href="Unreal_Wiki_Copyrights.html" />
<link rel="alternate" type="application/atom+xml" title="Unreal Wiki Atom feed" href="https://wiki.beyondunreal.com/Special:RecentChanges?feed=atom" />
<link rel="stylesheet" href="w/load2743.css?debug=false&amp;lang=en&amp;modules=ext.geshi.language.uscript%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if IE 6]><link rel="stylesheet" href="/w/skins/MonoBook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/w/skins/MonoBook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="w/load484a.css?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wiki:resourceloader:filter:minify-css:7:29b70323345a439ab9ed7007e0c178a6 */</style>
<script src="w/load9316.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"Legacy","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":100,"wgPageName":"Legacy:AssociativeArray","wgTitle":"AssociativeArray","wgCurRevisionId":1469,"wgRevisionId":1469,"wgArticleId":440,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Legacy:AssociativeArray","wgRelevantArticleId":440,"wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}"});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wiki:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-100 ns-subject page-Legacy_AssociativeArray skin-monobook action-view">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
									<div id="siteNotice"><div id="localNotice" lang="en" dir="ltr"><p>Mostly Harmless
</p></div></div>
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Legacy:AssociativeArray</h1>

				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</div>
					<div id="contentSub"></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>When learning <a href="Legacy_UnrealScript.html" title="Legacy:UnrealScript">UnrealScript</a> I found the idea of operator overloading very enticing. These pages describe the design and implementation of an associative array, providing (I hope) some insight into how UnrealScript operators are overloaded.</p>
<p></p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Data_Structure"><span class="tocnumber">2</span> <span class="toctext">Data Structure</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Operators"><span class="tocnumber">3</span> <span class="toctext">Operators</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Diversion:_Picking_Operators"><span class="tocnumber">3.1</span> <span class="toctext">Diversion: Picking Operators</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Diversion:_Operator_Precedence"><span class="tocnumber">3.2</span> <span class="toctext">Diversion: Operator Precedence</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Iterator"><span class="tocnumber">4</span> <span class="toctext">Iterator</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Extensions"><span class="tocnumber">5</span> <span class="toctext">Extensions</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Related_Topics"><span class="tocnumber">6</span> <span class="toctext">Related Topics</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Discussion"><span class="tocnumber">7</span> <span class="toctext">Discussion</span></a></li>
</ul>
</div>
<p></p>
<h2><span class="mw-headline" id="Overview">Overview</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:AssociativeArray?section=1" title="Edit section: Overview">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>An <a href="http://en.wikipedia.org/wiki/associative_array" class="extiw" title="wikipedia:associative array">Wikipedia:associative array</a> is an array that is indexed by something <i>other</i> than a sequence of small integers. C++ has <tt>std::map</tt>, Perl has its <tt>hash</tt>, and JavaScript has its structures. The power of these structures is that using them is <i>just like</i> using a regular array; assuming that <tt>AA</tt> is a <tt>map</tt> from string to string, the following C++ code should make sense:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
AA<span class="br0">[</span><span class="st0">"pet"</span><span class="br0">]</span> <span class="sy0">=</span> <span class="st0">"dog"</span>;
AA<span class="br0">[</span><span class="st0">"car"</span><span class="br0">]</span> <span class="sy0">=</span> <span class="st0">"jaguar"</span>;
AA<span class="br0">[</span><span class="st0">"programming language"</span><span class="br0">]</span> <span class="sy0">=</span> <span class="st0">"UnrealScript"</span>;
 
cout <span class="sy0">&lt;&lt;</span> AA<span class="br0">[</span><span class="st0">"programming language"</span><span class="br0">]</span> <span class="sy0">&lt;&lt;</span> endl;   <span class="co1">// C++ output statement</span>
</pre></div>
</div>
<p><br />
Associative arrays are powerful data structures; much of their power stems from their "natural" notation. <a href="Legacy_UnrealScript.html" title="Legacy:UnrealScript">UnrealScript's</a> <a href="Legacy_Scripting_Operators.html" title="Legacy:Scripting Operators">operator overloading</a> provides a chance to implement associative arrays with a "natural" notation (for an appropriately loose definition of natural).</p>
<p>This proof of concept focuses on implementing an associative array indexed by strings and containing strings. There are three phases of implementation:</p>
<ul>
<li>Selecting a <a href="Legacy_AssociativeArray/DataStructure.html" title="Legacy:AssociativeArray/DataStructure">datastructure</a> to associate key/value pairs of strings.</li>
<li>Selecting <a href="Legacy_AssociativeArray/OperatorOverloading.html" title="Legacy:AssociativeArray/OperatorOverloading">operators</a> to wrap the data structure in "natural" notation.</li>
<li>Making <a href="Legacy_AssociativeArray/Iterator.html" title="Legacy:AssociativeArray/Iterator">iterators</a> to traverse the contents of the associative array.</li>
</ul>
<p>The remainder of this page discusses the high-level design of the each phase; the copiously commented code for each phase is included in its own subpage.</p>
<h2><span class="mw-headline" id="Data_Structure">Data Structure</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:AssociativeArray?section=2" title="Edit section: Data Structure">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>An associtive array associates keys drawn from some domain with values drawn from some domain. Thus it is a mapping from key space to value space.</p>
<p>Depending on speed requirements and restrictions placed on key and vlaue types, such a mapping could be implemented with a hard-coded function, a linear array of pairs, a haash table of pairs, or a tree of pairs. This is a representative rather than an exhaustive list.</p>
<p>A function is a good, compact representation if it is easy to hard-code the relationship between key and value types. Not an option for associative arrays.</p>
<p>A linear list of pairs could be implemented as a <a href="Legacy_Dynamic_Array.html" title="Legacy:Dynamic Array">UT2K3 dynamic array</a> of structs or objects. An unsorted list is easy to insert into but costly to look things up in; a sorted list is faster for lookup but more costly for insertion. The overall cost is just a little bit too high; besides, this is a chance to play with <a href="Legacy_UnrealScript.html" title="Legacy:UnrealScript">UnrealScript</a> and that seems too easy.</p>
<p>A hash table is fast for lookup and insertion but a good hash function is difficult to design. Also, a hash table makes in-order traversal of the data difficult without another data structure.</p>
<p>A binary search tree is a good compromise with fairly fast insertion, fairly fast lookup, and easy ordered traversal (assuming the tree is close to balanced). Other, more complex, trees can make tight guarantees on performance. This proof of concept uses a simple BST</p>
<p>For demonstration purposes, we use strings as both keys and values. The only real restriction on the types is that key values must be comparable with <tt>&lt;</tt> and <tt>----</tt>. The ordering requirement can be relaxed with a linear list or hash table.</p>
<p><a href="Legacy_AssociativeArray/DataStructure.html" title="Legacy:AssociativeArray/DataStructure">Legacy:AssociativeArray/DataStructure</a> presents the code that implements the BST nodes and BST. The decision was made that an associative array is single valued.</p>
<h2><span class="mw-headline" id="Operators">Operators</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:AssociativeArray?section=3" title="Edit section: Operators">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>After implementing an association between keys and values, it is necessary to wrap calls to the impelemntation functions in <a href="Legacy_UnrealScript.html" title="Legacy:UnrealScript">UnrealScript</a> operators.</p>
<h3><span class="mw-headline" id="Diversion:_Picking_Operators">Diversion: Picking Operators</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:AssociativeArray?section=4" title="Edit section: Diversion: Picking Operators">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>By preference, overloading either <tt>[]</tt> or <tt>()</tt> would make the associative array notation most natural. <a href="Legacy_UnrealScript.html" title="Legacy:UnrealScript">UnrealScript</a> does not treat either pair of symbols as an operator so they cannot be overloaded. The UT <a href="Legacy_Dynamic_Array.html" title="Legacy:Dynamic Array">dynamic arrays</a> implementation used the <tt>&lt;&lt;</tt> operator for assignment and paired the <tt>&lt;&gt;</tt> operators for refering to elements in the array. Treating the <tt>&lt;</tt> and <tt>&gt;</tt> operators as angle brackets produced a pleasing appearance as in</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw2">if</span> <span class="br0">(</span>best<span class="sy0">&lt;</span><span class="st0">"movie"</span><span class="sy0">&gt;</span> <span class="sy0">==</span> <span class="st0">"Road Warrior"</span><span class="br0">)</span>
  <span class="kw3">log</span><span class="br0">(</span><span class="st0">"Programmer is too old."</span><span class="br0">)</span>;
</pre></div>
</div>
<p>The only thing missing is an assignment operator. Using the left-shift operator breaks the "naturalness" of using the associative array as an array and the assignment operator (<tt>=</tt>) is not available for redefinition. <tt>&gt;=</tt> (greater-than equals) <i>is</i> available and it can make for some very "natural" assignment statements:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
best<span class="sy0">&lt;</span><span class="st0">"icecream"</span><span class="sy0">&gt;=</span> <span class="st0">"vanilla"</span>;
best<span class="sy0">&lt;</span><span class="st0">"vegetable"</span><span class="sy0">&gt;=</span> <span class="st0">"califlower"</span>;
best<span class="sy0">&lt;</span><span class="st0">"stooge"</span><span class="sy0">&gt;=</span> <span class="st0">"moe"</span>;
</pre></div>
</div>
<p>There cannot be a space between the <tt>&gt;</tt> and the <tt>=</tt> (it has to parse as a single symbol for the operator look up to trigger) but that is a small price to pay for something that looks like assignment to an element in an array.</p>
<hr />
<p>Now for the hard part: <tt>best&lt;"icecream</tt> can be the prefix to either an assignment statement <i>or</i> an evaluation of a value in the associative array. In computer science speak, we want <tt>best&lt;"icecream</tt> to represent either an <i>l-value</i> (left-hand side of an assignment) or an <i>r-value</i> (right-hand side of an assignemnt statement). Note that <a href="Legacy_UnrealScript.html" title="Legacy:UnrealScript">UnrealScript</a> has no way of knowing, parsing left-to-right, what the following context of the given prefix is.</p>
<p>In C++ (and in Perl, under the hood) the problem is solved using <i>references</i>; the <tt>[]</tt> operator typically returns a reference to the element in the "array" and the compiler can convert a reference (really an l-value) into an r-value at need. <a href="Legacy_UnrealScript.html" title="Legacy:UnrealScript">UnrealScript</a> has no reference type so that solution is not possible.</p>
<p>Inspired by the <a href="Legacy_Dynamic_Array.html" title="Legacy:Dynamic Array">Dynamic_Array</a> for UT, this solution uses a <i>proxy</i> class. In <a href="Legacy_Dynamic_Array.html" title="Legacy:Dynamic Array">Dynamic_Array</a> the author uses a special type to represent the indices for setting values; here the prefix expression (the array, the angle bracket, and the key string) will return a type that can behave as either an l-value or an r-value.</p>
<p><tt>AAProxy</tt> serves this role by keeping track of a location inside an associative array. If it is followed by a <tt>&gt;</tt> it returns the value stored at that location. If it is followed by a <tt>&gt;=</tt> it sets the value at that location to the value of the expression following the operator. Yes, this is far, far too clever to be considered good code; in my humble opinion, it is also far, far too clever to be considered bad code.</p>
<h3><span class="mw-headline" id="Diversion:_Operator_Precedence">Diversion: Operator Precedence</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:AssociativeArray?section=5" title="Edit section: Diversion: Operator Precedence">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Both <a href="Legacy_Operators.html" title="Legacy:Operators">Operators</a> and <a href="Legacy_Scripting_Operators.html" title="Legacy:Scripting Operators">Scripting_Operators</a> cover operator precedence. <a href="Legacy_Scripting_Operators.html" title="Legacy:Scripting Operators">Scripting_Operators</a> does leave the impression that when scripting an operator, the compiler pays attention to the precedence number you set for the operator. This may be the case when defining operators that are not already part of the system. It is most definitely <b>not</b> the case when defining (or should that be redefining) operators that already exist. So the <tt>&gt;=</tt> operator has precedence 24 as defined in <tt>Object.uc</tt> and any version I define will have that same precedence <i>no matter what number I put as its precedence</i>.</p>
<p>This became a problem when defining the <tt>&gt;=</tt> operator. It is supposed to be an assignment operator so it should bind very loosely. In particular, it should probably bind more loosely than <tt>$</tt> so that the following line assigns "golden-delicious" to the associative array entry "apple":</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
AA<span class="sy0">&lt;</span><span class="st0">"apple"</span><span class="sy0">&gt;=</span><span class="st0">"golden"</span><span class="sy0">$</span><span class="st0">"-delicious"</span>;
</pre></div>
</div>
<p>Unfortunately, the line assigns the value "golden" to the entry, concatenates "golden" with "-delicious" and throws away the value of the expression. The following parentheses are necessary:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
AA<span class="sy0">&lt;</span><span class="st0">"apple"</span><span class="sy0">&gt;=</span><span class="br0">(</span><span class="st0">"golden"</span><span class="sy0">$</span><span class="st0">"-delicious"</span><span class="br0">)</span>;
</pre></div>
</div>
<hr />
<p><a href="Legacy_AssociativeArray/OperatorOverloading.html" title="Legacy:AssociativeArray/OperatorOverloading">Legacy:AssociativeArray/OperatorOverloading</a> presents the code for the <tt>AAProxy</tt> and the demonstration commandlet. <a href="Legacy_UnrealScript.html" title="Legacy:UnrealScript">UnrealScript</a> restricts the use of overloaded operators to the decendents of the class defining them; without access to <tt>Object</tt>, the associative array operators are defined in the commandlet. This limits the usefulness of the associative array.</p>
<h2><span class="mw-headline" id="Iterator">Iterator</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:AssociativeArray?section=6" title="Edit section: Iterator">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>It is not possible to write an <a href="Legacy_UnrealScript.html" title="Legacy:UnrealScript">UnrealScript</a> <a href="Legacy_Iterator.html" title="Legacy:Iterator">iterator</a> in script alone. Without access to the engine source code, the <tt>AssociativeArrayIterator</tt> was designed to emulate the iterators in C++'s STL. So the iterator is a class that behaves like a pointer at a location in the associative array. The "only" way to get an iterator is through a call to an iterator generating function of an associated array: <tt>AssociativeArray::begin()</tt> or <tt>AssociativeArray::end()</tt>.</p>
<p><tt>begin()</tt> returns an <tt>AssociativeArrayIterator</tt> that refers to the first element in the array (if there is one) and <tt>end()</tt> returns an iterator that is one <i>past</i> the last element in the associative array (this is C++'s standard asymetry). With appropriately defined <tt>++</tt> and <tt>!=</tt> operators for iterators, the following loop should visit every element in the associative array:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">local</span> AssociatveArrayIterator it;
 
<span class="kw2">for</span> <span class="br0">(</span>it <span class="sy0">=</span> best.<span class="kw2">begin</span><span class="br0">(</span><span class="br0">)</span>; it <span class="sy0">!=</span> best.<span class="me0">end</span><span class="br0">(</span><span class="br0">)</span>; <span class="sy0">++</span>i<span class="br0">)</span> <span class="br0">{</span>
  <span class="co1">// visit element referred to by it here</span>
<span class="br0">}</span>
</pre></div>
</div>
<p>We need some manner of "visiting" the elements. One solution is to use two functions, one to get the key and the other to get the value at the location referred to by the iterator. This is done here with <tt>first()</tt> and <tt>second()</tt> so to log the key/value pairs, the following code works:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw2">for</span> <span class="br0">(</span>it <span class="sy0">=</span> best.<span class="kw2">begin</span><span class="br0">(</span><span class="br0">)</span>; it <span class="sy0">!=</span> best.<span class="me0">end</span><span class="br0">(</span><span class="br0">)</span>; <span class="sy0">++</span>i<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw3">log</span><span class="br0">(</span>it.<span class="me0">first</span><span class="br0">(</span><span class="br0">)</span> <span class="sy0">$</span> <span class="st0">"/"</span> <span class="sy0">$</span> it.<span class="me0">second</span><span class="br0">(</span><span class="br0">)</span>, <span class="st0">'AssociativeArray'</span><span class="br0">)</span>;
<span class="br0">}</span>
</pre></div>
</div>
<p>This is nice. Could we use operators? Sure. Assume you only need the value (not the key) associated with each element. Then the following notation works:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw2">for</span> <span class="br0">(</span>it <span class="sy0">=</span> best.<span class="kw2">begin</span><span class="br0">(</span><span class="br0">)</span>; it <span class="sy0">!=</span> best.<span class="me0">end</span><span class="br0">(</span><span class="br0">)</span>; <span class="sy0">++</span>i<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw3">log</span><span class="br0">(</span><span class="st0">"Value: "</span> <span class="sy0">$</span> <span class="sy0">&lt;</span>it<span class="sy0">&gt;</span> , <span class="st0">'AssociativeArray'</span><span class="br0">)</span>;
<span class="br0">}</span>
</pre></div>
</div>
<p>But what if we wanted to append "'s" to every value. Could it be done? With the mechanics we have already developed, having <tt>&lt;it</tt> return an <tt>AAProxy</tt>, it can use the same r-value/l-value determination used for regular array access with iterators. So you can add the "'s" with the following code:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw2">for</span> <span class="br0">(</span>it <span class="sy0">=</span> best.<span class="kw2">begin</span><span class="br0">(</span><span class="br0">)</span>; it <span class="sy0">!=</span> best.<span class="me0">end</span><span class="br0">(</span><span class="br0">)</span>; <span class="sy0">++</span>i<span class="br0">)</span> <span class="br0">{</span>
    <span class="sy0">&lt;</span>it<span class="sy0">&gt;=</span> <span class="sy0">&lt;</span>it<span class="sy0">&gt;</span> <span class="sy0">$</span> <span class="st0">"'s"</span>;
<span class="br0">}</span>
</pre></div>
</div>
<p><a href="Legacy_AssociativeArray/Iterator.html" title="Legacy:AssociativeArray/Iterator">Legacy:AssociativeArray/Iterator</a> presents the code for the iterator and its supporting stack. The actual algorithm for traversing a BST is described in the embedded comments.</p>
<h2><span class="mw-headline" id="Extensions">Extensions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:AssociativeArray?section=7" title="Edit section: Extensions">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>It may be hard to believe after looking at the amount written about this silly proof of concept but there is more that could be done. The operations on the array could be extended (but notation would have to be found), iterators could be extended (forward and reverse, iterator invalidation), and it could easily be made more efficient.</p>
<p>The BST implementation could be extended with a mechanism for removing nodes. It would be nice to come up with an obvious, natural notation for deleting a node. There is also no way to check whether a given key is in the associative array (no way to differentiate between a stored empty string and a key that is not present).</p>
<p>The iterator could be more closely associated with the associative array in such a way that the iterator could be invalidated (or corrected, perahps) when the associative array changes. Invalidation could be accomplished with a list of active iterators (iterators on the array) that is checked when the array changes.</p>
<p>Using <tt>new</tt> is the standard way of allocating binary search tree nodes. In <a href="Legacy_UnrealScript.html" title="Legacy:UnrealScript">UnrealScript</a> it would be more efficient to maintain a dynamic array of BST nodes; this would be even more advantageous when deletion is possible. The associative array could keep a free list threaded through the dynamic array or it could compact the array on occasion (iterators would have to be invalidated in this case, too).</p>
<h2><span class="mw-headline" id="Related_Topics">Related Topics</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:AssociativeArray?section=8" title="Edit section: Related Topics">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul>
<li><a href="Legacy_UnrealScript.html" title="Legacy:UnrealScript">UnrealScript</a></li>
<li><a href="Legacy_Dynamic_Array.html" title="Legacy:Dynamic Array">Dynamic Array</a></li>
<li><a href="Legacy_Operators.html" title="Legacy:Operators">Operators</a></li>
<li><a href="Legacy_Scripting_Operators.html" title="Legacy:Scripting Operators">Scripting Operators</a></li>
<li><a href="Legacy_Iterator.html" title="Legacy:Iterator">Iterator</a></li>
</ul>
<h2><span class="mw-headline" id="Discussion">Discussion</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:AssociativeArray?section=9" title="Edit section: Discussion">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><b>El Muerte TDS:</b> Nice concept, too bad that this adds a lot of overhead. Usualy it's better to just create a Key-Value struct and a dynamic array of this struct. The engine does support associative arrays, it's called Map. But there are no unrealscript bindings for it.</p>
<p><i><b>Bcladd:</b></i> Of course this adds a great deal of overhead; all the preparation is done so the loop for traversing the structure appears "natural". Only argument against the straight dynamic array of key/value pairs is the cost of lookup and insertion (both O(<i>n</i>)). Actually, the implementation of associative array (and iterator) could be changed very easily and the operator notation still used. Note that I wrote this implementation before I had ever seen the insides of the engine.</p>
<p><b>El Muerte TDS:</b> The cost of lookup and insertion for a dynamic array is less than using object references and function calls in unreal script. Functions have to be lookup in each object before they are executed.</p>
<p><i><b>Bcladd:</b></i> Point taken: the constant cost of multiple (recursive) function calls from script outweights the asymptotic performance benefits of the binary tree for any realistic number of entries. This really is just a write up of my playing with operator overloading from script. Since I got great pleasure out of the <a href="Legacy_Dynamic_Array.html" title="Legacy:Dynamic Array">UT dynamic array</a> code, I thought someone might find the hackery here interesting.</p>
<p><b>Mychaeel:</b> El Muerte – Without wanting to go into details at this time (and without claiming intimate knowledge of the Unreal engine), I am rather sure that function invocations in UnrealScript are constant-time and rather efficient at that. I expect that after loading an UnrealScript class into memory all function references in function calls are directly resolved as pointers to the C++ "UnrealScript function" objects that are stored as such in UnrealScript code packages; involving any sort of hash or array lookup in calling an UnrealScript function on engine level would strike me as needlessly inefficient.</p>
<p>Bcladd – It's a real pity I don't have the time to look into your code right now, but from what I've seen at a first glance I'm pretty intrigued by your approach. I'll certainly have a closer look when I've got my normal share of free time back.</p>

<!-- 
NewPP limit report
CPU time usage: 0.127 seconds
Real time usage: 0.129 seconds
Preprocessor visited node count: 152/1000000
Preprocessor generated node count: 316/1000000
Post‐expand include size: 132/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->

<!-- Saved in parser cache with key wiki:pcache:idhash:440-0!*!0!!en!*!* and timestamp 20161215152755 and revision id 1469
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://wiki.beyondunreal.com/Legacy:AssociativeArray?oldid=1469">https://wiki.beyondunreal.com/Legacy:AssociativeArray?oldid=1469</a>"</div>
					<div id='catlinks' class='catlinks catlinks-allhidden'></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-legacy" class="selected"><a href="Legacy_AssociativeArray.html">Legacy</a></li>
				<li id="ca-talk" class="new"><a href="https://wiki.beyondunreal.com/edit/Legacy_talk:AssociativeArray?redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-edit"><a href="https://wiki.beyondunreal.com/edit/Legacy:AssociativeArray" title="You can edit this page. Please use the preview button before saving [e]" accesskey="e">Edit</a></li>
				<li id="ca-history"><a href="https://wiki.beyondunreal.com/history/Legacy:AssociativeArray" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=Legacy%3AAssociativeArray&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=Legacy%3AAssociativeArray" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="index.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-navigation" role="navigation">
		<h3>Navigation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-mainpage"><a href="index.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
											<li id="n-portal"><a href="Unreal_Wiki_Community_portal-2.html" title="About the project, what you can do, where to find things">Community portal</a></li>
											<li id="n-recentchanges"><a href="https://wiki.beyondunreal.com/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="https://wiki.beyondunreal.com/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
											<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											<li id="n-Forums-.28General.29"><a href="https://forums.beyondunreal.com/forums/wiki-general.250/" rel="nofollow">Forums (General)</a></li>
											<li id="n-Forums-.28Technical.29"><a href="https://forums.beyondunreal.com/forums/wiki-technical.251/" rel="nofollow">Forums (Technical)</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="https://wiki.beyondunreal.com/" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search Unreal Wiki [f]" accesskey="f" id="searchInput" />
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="https://wiki.beyondunreal.com/Special:WhatLinksHere/Legacy:AssociativeArray" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="https://wiki.beyondunreal.com/Special:RecentChangesLinked/Legacy:AssociativeArray" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="https://wiki.beyondunreal.com/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-print"><a href="https://wiki.beyondunreal.com/Legacy:AssociativeArray?printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
											<li id="t-permalink"><a href="https://wiki.beyondunreal.com/Legacy:AssociativeArray?oldid=1469" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="https://wiki.beyondunreal.com/info/Legacy:AssociativeArray" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-copyrightico">
									<a href="https://creativecommons.org/licenses/by-nc-sa/3.0/"><img src="../licensebuttons.net/l/by-nc-sa/3.0/88x31.png" alt="Attribution-Noncommercial-Share Alike 3.0" width="88" height="31" /></a>
							</div>
					<div id="f-poweredbyico">
									<script async src="../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <!-- Home Page -->
        <ins class="adsbygoogle"
             style="display:inline-block;width:728px;height:90px"
             data-ad-client="ca-pub-9605963037553244"
             data-ad-slot="9528541415"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
							</div>
					<ul id="f-list">
									<li id="lastmod"> Last modified at 15:23, 18 November 2005.</li>
									<li id="copyright">Licensed as <a href="Unreal_Wiki_Copyrights.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>
									<li id="privacy"><a href="Unreal_Wiki_Privacy_policy.html" title="Unreal Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="Unreal_Wiki_About.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>
									<li id="disclaimer"><a href="Unreal_Wiki_General_disclaimer.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.beyondunreal.com/w/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=monobook\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":79});
}</script></body>
<!-- Mirrored from wiki.beyondunreal.com/Legacy:AssociativeArray by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 09:34:58 GMT -->
</html>
