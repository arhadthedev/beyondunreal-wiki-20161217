<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.beyondunreal.com/User:Wormbo/Random_useful_code_snippets by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 07:52:49 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>User:Wormbo/Random useful code snippets - Unreal Wiki</title>
<meta name="generator" content="MediaWiki 1.25.1" />
<link rel="shortcut icon" href="../w/uewiki-favicon.png" />
<link rel="search" type="application/opensearchdescription+xml" href="../w/opensearch_desc.php" title="Unreal Wiki" />
<link rel="EditURI" type="application/rsd+xml" href="../w/api251f.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="Random_useful_code_snippets.html" />
<link rel="copyright" href="../Unreal_Wiki_Copyrights.html" />
<link rel="alternate" type="application/atom+xml" title="Unreal Wiki Atom feed" href="https://wiki.beyondunreal.com/Special:RecentChanges?feed=atom" />
<link rel="stylesheet" href="../w/load2743.css?debug=false&amp;lang=en&amp;modules=ext.geshi.language.uscript%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if IE 6]><link rel="stylesheet" href="/w/skins/MonoBook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/w/skins/MonoBook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="../w/load484a.css?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wiki:resourceloader:filter:minify-css:7:29b70323345a439ab9ed7007e0c178a6 */</style>
<script src="../w/load9316.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"User","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":2,"wgPageName":"User:Wormbo/Random_useful_code_snippets","wgTitle":"Wormbo/Random useful code snippets","wgCurRevisionId":45928,"wgRevisionId":45928,"wgArticleId":29140,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["UnrealScript utils"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"User:Wormbo/Random_useful_code_snippets","wgRelevantArticleId":29140,"wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgRelevantUserName":"Wormbo","wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}"});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wiki:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-2 ns-subject page-User_Wormbo_Random_useful_code_snippets skin-monobook action-view">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
									<div id="siteNotice"><div id="localNotice" lang="en" dir="ltr"><p>I love the smell of UnrealEd crashing in the morning. &#8211; tarquin
</p></div></div>
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">User:Wormbo/Random useful code snippets</h1>

				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</div>
					<div id="contentSub"><span class="subpages">&lt; <a href="../User_Wormbo.html" title="User:Wormbo">User:Wormbo</a></span></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>On this page I will post various code snippets that are too useful to keep them to myself. Some of these probably deserve their own article pages with background information, and maybe I'll create them at some point.</p>
<p></p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Linear_search_one-liner"><span class="tocnumber">1</span> <span class="toctext">Linear search one-liner</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Binary_Search"><span class="tocnumber">2</span> <span class="toctext">Binary Search</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Finding_common_string_prefix"><span class="tocnumber">3</span> <span class="toctext">Finding common string prefix</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Collapsing_whitespace"><span class="tocnumber">4</span> <span class="toctext">Collapsing whitespace</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Integer_modulo_operator"><span class="tocnumber">5</span> <span class="toctext">Integer modulo operator</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#ArcTan_function"><span class="tocnumber">6</span> <span class="toctext">ArcTan function</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Vector_magic"><span class="tocnumber">7</span> <span class="toctext">Vector magic</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Distance_of_point_from_line"><span class="tocnumber">7.1</span> <span class="toctext">Distance of point from line</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#In_front_or_behind.3F"><span class="tocnumber">7.2</span> <span class="toctext">In front or behind?</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Closest_point_on_a_line"><span class="tocnumber">7.3</span> <span class="toctext">Closest point on a line</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Vector_to_Rotator_alternative"><span class="tocnumber">7.4</span> <span class="toctext">Vector to Rotator alternative</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#Float_to_int_cast"><span class="tocnumber">8</span> <span class="toctext">Float to int cast</span></a></li>
</ul>
</div>
<p></p>
<h2><span class="mw-headline" id="Linear_search_one-liner">Linear search one-liner</span></h2>
<p>The most simple way to search for a value in an array is <a href="http://en.wikipedia.org/wiki/linear_search" class="extiw" title="wp:linear search">linear search</a>. The following implementation is (almost) a one-liner that works on all arrays, sorted or not.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">local</span> <span class="kw5">int</span> i;
 
i <span class="sy0">=</span> A.<span class="me0">Length</span>;
<span class="kw2">do</span> <span class="br0">{</span><span class="br0">}</span> until <span class="br0">(</span><span class="sy0">--</span>i <span class="sy0">&lt;</span> <span class="nu0">0</span> <span class="sy0">||</span> A<span class="br0">[</span>i<span class="br0">]</span> <span class="sy0">==</span> Value<span class="br0">)</span>;
</pre></div>
</div>
<p>Success is indicated by <code>i &gt;= 0</code>, failure by <code>i == -1</code> or <code>i == INDEX_NONE</code> in UE3.</p>
<p>If the array is sorted and has more than just a few elements, you should consider using binary search instead.</p>
<h2><span class="mw-headline" id="Binary_Search">Binary Search</span></h2>
<p>The following very simply piece of code implements the <a href="http://en.wikipedia.org/wiki/binary_search_algorithm" class="extiw" title="wp:binary search algorithm">binary search algorithm</a> with deferred detection of equality, looking for <i>Value</i> in array <i>A</i>. If <i>Value</i> isn't in <i>A</i>, the code returns the index where <i>Value</i> would have to be inserted.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">local</span> <span class="kw5">int</span> Low, High, Middle;
 
Low <span class="sy0">=</span> <span class="nu0">0</span>;
High <span class="sy0">=</span> A.<span class="me0">Length</span>;
<span class="kw2">while</span> <span class="br0">(</span>Low <span class="sy0">&lt;</span> High<span class="br0">)</span> <span class="br0">{</span>
  Middle <span class="sy0">=</span> <span class="br0">(</span>High <span class="sy0">+</span> Low<span class="br0">)</span> <span class="sy0">/</span> <span class="nu0">2</span>;
  <span class="kw2">if</span> <span class="br0">(</span>A<span class="br0">[</span>Middle<span class="br0">]</span> <span class="sy0">&lt;</span> Value<span class="br0">)</span>
    Low <span class="sy0">=</span> Middle <span class="sy0">+</span> <span class="nu0">1</span>;
  <span class="kw2">else</span>
    High <span class="sy0">=</span> Middle;
<span class="br0">}</span>
</pre></div>
</div>
<p>As you can see, the advantage here is that each loop iteration only performs a single less-than comparison between the search value and an array element.</p>
<p>So, why would you combine the equality and greater-than comparisons and give up early abort? Quite simple: The equality comparison would fail most of the time anyway, so it doesn't actually give that much of an advantage, considering binary search only has an overall worst case time complexity of <code>O(log<sub>2</sub>n)</code>. And, well, you only need to implement a less-than comparison for custom data types as opposed to less-then and greater-than. Here "less than" could actually mean "greater than" if the array is sorted in descending order or anything else, as long as it is a <a href="http://en.wikipedia.org/wiki/strict_total_order" class="extiw" title="wp:strict total order">strict total order</a> on the possible values for the array's <a href="../Type.html" title="Type" class="mw-redirect">type</a>.</p>
<p>To figure out whether you found the value or not, an additional comparison is required:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw2">if</span> <span class="br0">(</span>Low <span class="sy0">&lt;</span> A.<span class="me0">Length</span> <span class="sy0">&amp;&amp;</span> A<span class="br0">[</span>Low<span class="br0">]</span> <span class="sy0">==</span> Value<span class="br0">)</span>
  <span class="co1">// found it</span>
<span class="kw2">else</span>
  <span class="co1">// not found</span>
</pre></div>
</div>
<p>You can assume that <i>Low</i> always is a valid insert index less than or equal to <code>A.Length</code>, so <code>A.Insert(Low, 1); A[Low] = Value;</code> (or <code>A.InsertItem(Low, Value);</code> in <a href="../UE3.html" title="UE3" class="mw-redirect">UE3</a>) will always work correctly.</p>
<p>It is guaranteed that <code>Low &lt; A.Length</code> implies <code>A[Low] &gt;= Value</code> and <code>Low &gt; 0</code> implies <code>A[Low-1] &lt; Value</code>. That means if you want to remove all values less than <i>Value</i>, you can simply do <code>A.Remove(0, Low)</code>. To remove all values greater than or equal to <i>Value</i>, you use <code>A.Remove(Low, A.Length - Low)</code>.</p>
<p>To find the first index with a value greater than <i>Value</i>, you just need a tiny modification:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">local</span> <span class="kw5">int</span> Low, High, Middle;
 
Low <span class="sy0">=</span> <span class="nu0">0</span>;
High <span class="sy0">=</span> A.<span class="me0">Length</span>;
<span class="kw2">while</span> <span class="br0">(</span>Low <span class="sy0">&lt;</span> High<span class="br0">)</span> <span class="br0">{</span>
  Middle <span class="sy0">=</span> <span class="br0">(</span>High <span class="sy0">+</span> Low<span class="br0">)</span> <span class="sy0">/</span> <span class="nu0">2</span>;
  <span class="kw2">if</span> <span class="br0">(</span>A<span class="br0">[</span>Middle<span class="br0">]</span> <span class="sy0">&lt;=</span> Value<span class="br0">)</span>
    Low <span class="sy0">=</span> Middle <span class="sy0">+</span> <span class="nu0">1</span>;
  <span class="kw2">else</span>
    High <span class="sy0">=</span> Middle;
<span class="br0">}</span>
</pre></div>
</div>
<p>This version can be used if you want to ensure that new instances of values considered as "equal" are inserted after all previous instances, whereas the other version of the algorithm finds an insert location before all other equal instances.</p>
<p>Again you can assume that <i>Low</i> always is a valid insert index less than or equal to <code>A.Length</code>. It is guaranteed that <code>Low &lt; A.Length</code> implies <code>A[Low] &gt; Value</code> and <code>Low &gt; 0</code> implies <code>A[Low-1] &lt;= Value</code>. That means if you want to remove all values less than or equal to <i>Value</i>, you can simply do <code>A.Remove(0, Low)</code>. To remove all values greater than <i>Value</i>, you use <code>A.Remove(Low, A.Length - Low)</code>. Note how the "or equal to" now is part of the other side of the array.</p>
<h2><span class="mw-headline" id="Finding_common_string_prefix">Finding common string prefix</span></h2>
<p>For <a href="http://en.wikipedia.org/wiki/incremental_encoding" class="extiw" title="wp:incremental encoding">incremental encoding</a> you need to find the common prefix of two strings. Usually you'd do that by comparing corresponding characters of both strings, starting from the front, but UnrealScript is quite inefficient for that. I found that, at least in UT2004, you could use the StrCmp() function to compare string prefixes. Now you only need to find the largest prefix length at which both string starts are still equal. Technically this is a searching operation and the easy way to do it would be a linear search. But if there's a reasonably good chance the strings have large common parts, you could even abuse binary search for this. The following code snippet finds the largest common prefix length of strings A and B:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">local</span> <span class="kw5">int</span> Low, High, Middle;
 
Low <span class="sy0">=</span> <span class="nu0">0</span>;
High <span class="sy0">=</span> <span class="kw3">Min</span><span class="br0">(</span><span class="kw3">Len</span><span class="br0">(</span>A<span class="br0">)</span>, <span class="kw3">Len</span><span class="br0">(</span>B<span class="br0">)</span><span class="br0">)</span>;
<span class="kw2">while</span> <span class="br0">(</span>Low <span class="sy0">&lt;</span> High<span class="br0">)</span> <span class="br0">{</span>
  Middle <span class="sy0">=</span> <span class="br0">(</span>High <span class="sy0">+</span> Low<span class="br0">)</span> <span class="sy0">/</span> <span class="nu0">2</span>;
  <span class="kw2">if</span> <span class="br0">(</span><span class="kw3">StrCmp</span><span class="br0">(</span>A, B, Middle<span class="br0">)</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">)</span>
    Low <span class="sy0">=</span> Middle <span class="sy0">+</span> <span class="nu0">1</span>;
  <span class="kw2">else</span>
    High <span class="sy0">=</span> Middle;
<span class="br0">}</span>
</pre></div>
</div>
<p>Looks scary? I hope so.&#160;;-)</p>
<h2><span class="mw-headline" id="Collapsing_whitespace">Collapsing whitespace</span></h2>
<p>This code will remove leading and trailing whitespace from a string and simultaneously collapse any sequence of space and tab characters into a single space:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">function</span> <span class="kw5">string</span> CollapseAndTrimWhitespace<span class="br0">(</span><span class="kw5">string</span> S<span class="br0">)</span>
<span class="br0">{</span>
  S <span class="sy0">=</span> <span class="st0">" "</span> <span class="sy0">$</span> <span class="kw3">Repl</span><span class="br0">(</span>S, <span class="kw3">Chr</span><span class="br0">(</span><span class="nu0">9</span><span class="br0">)</span>, <span class="st0">" "</span><span class="br0">)</span> <span class="sy0">$</span> <span class="st0">" "</span>; <span class="co1">// replace tabs with spaces and enclose in space chars for collapsing</span>
  <span class="kw2">while</span> <span class="br0">(</span><span class="kw3">InStr</span><span class="br0">(</span>S, <span class="st0">"  "</span><span class="br0">)</span> <span class="sy0">!=</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">)</span> <span class="br0">{</span> <span class="co1">// need whitespace collapsing?</span>
    S <span class="sy0">=</span> <span class="kw3">Repl</span><span class="br0">(</span>S, <span class="st0">"  "</span>, <span class="st0">" "</span><span class="br0">)</span>; <span class="co1">// collapse two adjacent spaces to a single space</span>
  <span class="br0">}</span>
  <span class="kw2">return</span> <span class="kw3">Mid</span><span class="br0">(</span>S, <span class="nu0">1</span>, <span class="kw3">Len</span><span class="br0">(</span>S<span class="br0">)</span> <span class="sy0">-</span> <span class="nu0">2</span><span class="br0">)</span>; <span class="co1">// remove enclosing space chars</span>
<span class="br0">}</span>
</pre></div>
</div>
<p>I know, InStr() and Repl() are really linear time operations, causing the algorithm to be something like O(n*logn). But as usual UnrealScript's slowness adds a high constant part to them, essentially making them constant time for reasonably short strings (up to a few hundred characters), and the whole function sort-of O(logn).</p>
<h2><span class="mw-headline" id="Integer_modulo_operator">Integer modulo operator</span></h2>
<p>The <a href="http://en.wikipedia.org/wiki/modulo_operation" class="extiw" title="wp:modulo operation">modulo</a> operator <code>%</code> in UnrealScript is only defined for float operands, which can cause bad rounding errors if you use it with large int values. The following code <a href="http://en.wikipedia.org/wiki/Operator_overloading" class="extiw" title="wp:Operator overloading">overloads</a> the modulo operator for int values:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">operator</span><span class="br0">(</span><span class="nu0">18</span><span class="br0">)</span> <span class="kw5">int</span> <span class="sy0">%</span> <span class="br0">(</span><span class="kw5">int</span> A, <span class="kw5">int</span> B<span class="br0">)</span>
<span class="br0">{</span>
  <span class="kw2">return</span> A <span class="sy0">-</span> <span class="br0">(</span>A <span class="sy0">/</span> B<span class="br0">)</span> <span class="sy0">*</span> B;
<span class="br0">}</span>
</pre></div>
</div>
<p>This has similar semantics as the float modulo operator, i.e. it may return negative values if you pass in negative operands. Note that (A/B)*B is not the same as A due to integer division dropping any potential remainder.</p>
<h2><span class="mw-headline" id="ArcTan_function">ArcTan function</span></h2>
<p>Need the standard one-parameter version of the <a href="http://en.wikipedia.org/wiki/arctan" class="extiw" title="wp:arctan">atan</a> function and your version of the game only provides the <a href="http://en.wikipedia.org/wiki/atan2" class="extiw" title="wp:atan2">two-parameter version</a>? Try this one:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">function</span> <span class="kw5">float</span> ArcTan<span class="br0">(</span><span class="kw5">float</span> A<span class="br0">)</span>
<span class="br0">{</span>
  <span class="kw2">return</span> <span class="kw3">ATan</span><span class="br0">(</span><span class="nu0">1</span>, A<span class="br0">)</span>;
<span class="br0">}</span>
</pre></div>
</div>
<h2><span class="mw-headline" id="Vector_magic">Vector magic</span></h2>
<h3><span class="mw-headline" id="Distance_of_point_from_line">Distance of point from line</span></h3>
<p>This one might be useful e.g. for determining by how much a shot missed a target:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
dist <span class="sy0">=</span> <span class="kw3">VSize</span><span class="br0">(</span><span class="kw3">Normal</span><span class="br0">(</span>ShotDir<span class="br0">)</span> cross <span class="br0">(</span>TargetLocation <span class="sy0">-</span> ShotStart<span class="br0">)</span><span class="br0">)</span>;
</pre></div>
</div>
<p>This formula relies on the fact that the length of the <a href="http://en.wikipedia.org/wiki/cross_product" class="extiw" title="wp:cross product">cross product</a> is the product of the two vector lengths times the <a href="http://en.wikipedia.org/wiki/sine" class="extiw" title="wp:sine">sine</a> of the angle between them. Note that the resulting vector of the cross product itself is actually orthogonal to both the shot direction and the vector pointing from the shot start to the target direction.</p>
<h3><span class="mw-headline" id="In_front_or_behind.3F">In front or behind?</span></h3>
<p>You'd probably use this one in combination with the above to figure out whether the target was actually shot at:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
bInFront <span class="sy0">=</span> <span class="br0">(</span>ShotDir dot <span class="br0">(</span>TargetLocation <span class="sy0">-</span> ShotStart<span class="br0">)</span><span class="br0">)</span> <span class="sy0">&gt;</span> <span class="nu0">0</span>;
</pre></div>
</div>
<p>If you normalize both vectors, the <a href="http://en.wikipedia.org/wiki/dot_product" class="extiw" title="wp:dot product">dot product</a> actually gives you the <a href="http://en.wikipedia.org/wiki/cosine" class="extiw" title="wp:cosine">cosine</a> of the angle between them. If you don't, the cosine is multiplied by the product of the two vectors' lengths. Either way, the cosine is positive for angles smaller than 90° and negative for angles greater than 90°.</p>
<h3><span class="mw-headline" id="Closest_point_on_a_line">Closest point on a line</span></h3>
<p>If you want to know the point on a line that is closest to some other point (usually) not on the line, you need to project the other point onto the line:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
ClosestPoint <span class="sy0">=</span> ShotStart <span class="sy0">+</span> <span class="kw3">Normal</span><span class="br0">(</span>ShotDir<span class="br0">)</span> <span class="sy0">*</span> <span class="br0">(</span><span class="kw3">Normal</span><span class="br0">(</span>ShotDir<span class="br0">)</span> dot <span class="br0">(</span>TargetLocation <span class="sy0">-</span> ShotStart<span class="br0">)</span><span class="br0">)</span>;
</pre></div>
</div>
<p>You can obviously skip normalization if the shot direction already is a <a href="http://en.wikipedia.org/wiki/unit_vector" class="extiw" title="wp:unit vector">unit vector</a>.</p>
<h3><span class="mw-headline" id="Vector_to_Rotator_alternative">Vector to Rotator alternative</span></h3>
<p>The following code converts a vector to a rotator. Instead of the yaw-then-pitch order of the <a href="../Typecasting.html#vector_to..." title="Typecasting">vector-&gt;rotator typecast</a>, this conversion sort-of applies pitch-then-yaw order. Short explanation:</p>
<ul>
<li>The typecast calculates a rotator that gets from vect(1,0,0) to the target direction by first rotating around the vertical axis, then around the resulting left/right axis.</li>
<li>This conversion calculates another rotator that gets from vect(1,0,0) to the target direction, but it first rotates around the left/right axis and then around the resulting upward axis.</li>
</ul>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">local</span> <span class="kw5">vector</span> Dir; <span class="co1">// input</span>
<span class="kw1">local</span> <span class="kw5">rotator</span> Result;
<span class="kw1">local</span> <span class="kw5">vector</span> X, Y, Z; <span class="co1">// temp</span>
 
Z <span class="sy0">=</span> <span class="kw3">Normal</span><span class="br0">(</span>Dir cross <span class="kw3">vect</span><span class="br0">(</span><span class="nu0">0</span>,<span class="nu0">1</span>,<span class="nu0">0</span><span class="br0">)</span><span class="br0">)</span>;
X <span class="sy0">=</span> <span class="kw3">Normal</span><span class="br0">(</span>Dir<span class="br0">)</span>;
Y <span class="sy0">=</span> Z cross X;
Result <span class="sy0">=</span> <span class="kw3">OrthoRotation</span><span class="br0">(</span>X, Y, Z<span class="br0">)</span>;
</pre></div>
</div>
<h2><span class="mw-headline" id="Float_to_int_cast">Float to int cast</span></h2>
<p>This isn't your standard typecast. Sometimes you want to access the actual bits a float value consist of, e.g. to send it via a TcpLink or UdpLink. UnrealScript doesn't provide any function to do that, but prior to Unreal Engine 3 it is possible to exploit loopholes in the compiler to achieve this kind of bitwise conversion.</p>
<p>To convert between float and int this way, you need two classes. Even if you only want to convert in one direction, you still need both. Don't ask how this works, I won't explain. And again: This will only work in Unreal Engine 1 and 2, because the compiler no longer allows it in Unreal Engine 3.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">class</span> IntConverter <span class="kw1">extends</span> <span class="kw8">Object</span> <span class="kw1">abstract</span>;
 
<span class="kw1">var</span> <span class="kw5">int</span> Value;
 
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">function</span> <span class="kw5">float</span> ToFloat<span class="br0">(</span><span class="kw5">int</span> value<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">default</span>.<span class="me0">Value</span> <span class="sy0">=</span> value;
    <span class="kw2">return</span> <span class="kw6">Super</span><span class="br0">(</span>FloatConverter<span class="br0">)</span>.<span class="me0">ReturnFloat</span><span class="br0">(</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">function</span> <span class="kw5">int</span> ReturnInt<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw2">return</span> <span class="kw1">default</span>.<span class="me0">Value</span>;
<span class="br0">}</span>
</pre></div>
</div>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">class</span> FloatConverter <span class="kw1">extends</span> <span class="kw8">Object</span> <span class="kw1">abstract</span>;
 
<span class="kw1">var</span> <span class="kw5">float</span> Value;
 
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">function</span> <span class="kw5">int</span> ToInt<span class="br0">(</span><span class="kw5">float</span> value<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">default</span>.<span class="me0">Value</span> <span class="sy0">=</span> value;
    <span class="kw2">return</span> <span class="kw6">Super</span><span class="br0">(</span>IntConverter<span class="br0">)</span>.<span class="me0">ReturnInt</span><span class="br0">(</span><span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="kw1">static</span> <span class="kw1">final</span> <span class="kw1">function</span> <span class="kw5">float</span> ReturnFloat<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw2">return</span> <span class="kw1">default</span>.<span class="me0">Value</span>;
<span class="br0">}</span>
</pre></div>
</div>
<p>To use the conversion, you simply call the static ToInt or ToFloat method:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">local</span> <span class="kw5">float</span> f;
<span class="kw1">local</span> <span class="kw5">int</span> i;
 
f <span class="sy0">=</span> <span class="nu0">123.45</span>;
<span class="kw3">log</span><span class="br0">(</span>f <span class="sy0">@</span> <span class="kw1">class</span><span class="st0">'FloatConverter'</span>.<span class="kw1">static</span>.<span class="me0">ToInt</span><span class="br0">(</span>f<span class="br0">)</span><span class="br0">)</span>;
 
i <span class="sy0">=</span> <span class="nu0">12345</span>;
<span class="kw3">log</span><span class="br0">(</span>i <span class="sy0">@</span> <span class="kw1">class</span><span class="st0">'IntConverter'</span>.<span class="kw1">static</span>.<span class="me0">ToFloat</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;
</pre></div>
</div>

<!-- 
NewPP limit report
CPU time usage: 0.198 seconds
Real time usage: 0.201 seconds
Preprocessor visited node count: 166/1000000
Preprocessor generated node count: 368/1000000
Post‐expand include size: 27/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->

<!-- Saved in parser cache with key wiki:pcache:idhash:29140-0!*!0!!en!*!* and timestamp 20161215141716 and revision id 45928
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://wiki.beyondunreal.com/User:Wormbo/Random_useful_code_snippets?oldid=45928">https://wiki.beyondunreal.com/User:Wormbo/Random_useful_code_snippets?oldid=45928</a>"</div>
					<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://wiki.beyondunreal.com/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="../Category_UnrealScript_utils.html" title="Category:UnrealScript utils">UnrealScript utils</a></li></ul></div></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-user" class="selected"><a href="Random_useful_code_snippets.html" title="View the user page [c]" accesskey="c">User page</a></li>
				<li id="ca-talk"><a href="../User_talk_Wormbo/Random_useful_code_snippets.html" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource"><a href="https://wiki.beyondunreal.com/edit/User:Wormbo/Random_useful_code_snippets" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="https://wiki.beyondunreal.com/history/User:Wormbo/Random_useful_code_snippets" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=User%3AWormbo%2FRandom+useful+code+snippets&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=User%3AWormbo%2FRandom+useful+code+snippets" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="../index.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-navigation" role="navigation">
		<h3>Navigation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-mainpage"><a href="../index.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
											<li id="n-portal"><a href="../Unreal_Wiki_Community_portal-2.html" title="About the project, what you can do, where to find things">Community portal</a></li>
											<li id="n-recentchanges"><a href="https://wiki.beyondunreal.com/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="https://wiki.beyondunreal.com/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
											<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											<li id="n-Forums-.28General.29"><a href="https://forums.beyondunreal.com/forums/wiki-general.250/" rel="nofollow">Forums (General)</a></li>
											<li id="n-Forums-.28Technical.29"><a href="https://forums.beyondunreal.com/forums/wiki-technical.251/" rel="nofollow">Forums (Technical)</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="https://wiki.beyondunreal.com/" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search Unreal Wiki [f]" accesskey="f" id="searchInput" />
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="https://wiki.beyondunreal.com/Special:WhatLinksHere/User:Wormbo/Random_useful_code_snippets" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="https://wiki.beyondunreal.com/Special:RecentChangesLinked/User:Wormbo/Random_useful_code_snippets" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-contributions"><a href="https://wiki.beyondunreal.com/Special:Contributions/Wormbo" title="A list of contributions of this user">User contributions</a></li>
											<li id="t-log"><a href="https://wiki.beyondunreal.com/Special:Log/Wormbo">Logs</a></li>
											<li id="t-specialpages"><a href="https://wiki.beyondunreal.com/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-print"><a href="https://wiki.beyondunreal.com/User:Wormbo/Random_useful_code_snippets?printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
											<li id="t-permalink"><a href="https://wiki.beyondunreal.com/User:Wormbo/Random_useful_code_snippets?oldid=45928" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="https://wiki.beyondunreal.com/info/User:Wormbo/Random_useful_code_snippets" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-copyrightico">
									<a href="https://creativecommons.org/licenses/by-nc-sa/3.0/"><img src="../../licensebuttons.net/l/by-nc-sa/3.0/88x31.png" alt="Attribution-Noncommercial-Share Alike 3.0" width="88" height="31" /></a>
							</div>
					<div id="f-poweredbyico">
									<script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <!-- Home Page -->
        <ins class="adsbygoogle"
             style="display:inline-block;width:728px;height:90px"
             data-ad-client="ca-pub-9605963037553244"
             data-ad-slot="9528541415"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
							</div>
					<ul id="f-list">
									<li id="lastmod"> Last modified at 08:05, 14 January 2014.</li>
									<li id="copyright">Licensed as <a href="../Unreal_Wiki_Copyrights.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>
									<li id="privacy"><a href="../Unreal_Wiki_Privacy_policy.html" title="Unreal Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="../Unreal_Wiki_About.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>
									<li id="disclaimer"><a href="../Unreal_Wiki_General_disclaimer.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.beyondunreal.com/w/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=monobook\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":89});
}</script></body>
<!-- Mirrored from wiki.beyondunreal.com/User:Wormbo/Random_useful_code_snippets by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 07:52:49 GMT -->
</html>
