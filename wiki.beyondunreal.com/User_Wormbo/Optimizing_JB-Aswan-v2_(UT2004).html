<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.beyondunreal.com/User:Wormbo/Optimizing_JB-Aswan-v2_(UT2004) by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 07:52:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>User:Wormbo/Optimizing JB-Aswan-v2 (UT2004) - Unreal Wiki</title>
<meta name="generator" content="MediaWiki 1.25.1" />
<link rel="shortcut icon" href="../w/uewiki-favicon.png" />
<link rel="search" type="application/opensearchdescription+xml" href="../w/opensearch_desc.php" title="Unreal Wiki" />
<link rel="EditURI" type="application/rsd+xml" href="../w/api251f.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="Optimizing_JB-Aswan-v2_(UT2004).html" />
<link rel="copyright" href="../Unreal_Wiki_Copyrights.html" />
<link rel="alternate" type="application/atom+xml" title="Unreal Wiki Atom feed" href="https://wiki.beyondunreal.com/Special:RecentChanges?feed=atom" />
<link rel="stylesheet" href="../w/load6852.css?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if IE 6]><link rel="stylesheet" href="/w/skins/MonoBook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/w/skins/MonoBook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="../w/load484a.css?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wiki:resourceloader:filter:minify-css:7:29b70323345a439ab9ed7007e0c178a6 */</style>
<script src="../w/load9316.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"User","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":2,"wgPageName":"User:Wormbo/Optimizing_JB-Aswan-v2_(UT2004)","wgTitle":"Wormbo/Optimizing JB-Aswan-v2 (UT2004)","wgCurRevisionId":35394,"wgRevisionId":35394,"wgArticleId":24398,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Mapping tutorials"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"User:Wormbo/Optimizing_JB-Aswan-v2_(UT2004)","wgRelevantArticleId":24398,"wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgRelevantUserName":"Wormbo","wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}"});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wiki:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-2 ns-subject page-User_Wormbo_Optimizing_JB-Aswan-v2_UT2004 skin-monobook action-view">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
									<div id="siteNotice"><div id="localNotice" lang="en" dir="ltr"><p>Always snap to grid
</p></div></div>
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">User:Wormbo/Optimizing JB-Aswan-v2 (UT2004)</h1>

				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</div>
					<div id="contentSub"><span class="subpages">&lt; <a href="../User_Wormbo.html" title="User:Wormbo">User:Wormbo</a></span></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>When I converted <a href="http://liandri.beyondunreal.com/DOM-Aswan" class="extiw" title="liandri:DOM-Aswan">DOM-Aswan</a> to a Jailbreak map, people reported bad framerates. Until then I only paid attention to setting up the Jailbreak-specific actors and just "reused" the original optimizations. To achieve better performance, I started "from scratch" by removing all <a href="https://wiki.beyondunreal.com/edit/Zone_portal?redlink=1" class="new" title="Zone portal (page does not exist)">zone portals</a>, <a href="../UE2_ZoneInfo_(UT2004).html" title="UE2:ZoneInfo (UT2004)">ZoneInfos</a> and <a href="../UE2_AntiPortalActor_(UT2004).html" title="UE2:AntiPortalActor (UT2004)">AntiPortalActors</a>, and disabling the <a href="../Anti_portal.html" title="Anti portal" class="mw-redirect">anti portal</a> flag of all <a href="https://wiki.beyondunreal.com/edit/BSP_surface?redlink=1" class="new" title="BSP surface (page does not exist)">BSP surfaces</a>.</p>
<p>For JB-Aswan-v2 I ended up using about all of the map optimization techniques UT2004 offers. This article will sum up their application and the ideas behind why they where applied this way.</p>
<p></p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Optimized_zoning"><span class="tocnumber">1</span> <span class="toctext">Optimized zoning</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Optimizing_zone_visibility"><span class="tocnumber">2</span> <span class="toctext">Optimizing zone visibility</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Forcing_actor_visibility_zones"><span class="tocnumber">3</span> <span class="toctext">Forcing actor visibility zones</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Using_anti_portals"><span class="tocnumber">4</span> <span class="toctext">Using anti portals</span></a></li>
</ul>
</div>
<p></p>
<h2><span class="mw-headline" id="Optimized_zoning">Optimized zoning</span></h2>
<p>The first step in successful optimization always is a proper zoning layout. Ideally the map doesn't have long lines of sight, but sometimes you don't really have a choice. In these cases it is important to make portal sheets between zones as small as possible, while still retaining a convex shape. Most importantly, zone portals do not need to overlap BSP geometry. It is enough if they fit the opening perfectly, and in fact, making them any larger is suboptimal for performance.</p>
<p>On Aswan this especially goes for the lower corridors from the side to the back rooms and for the exits of the side rooms. These originally used just square portal sheets that were quite a bit larger than the actually visible shape. An optimized shape would be a <a href="http://en.wikipedia.org/wiki/isosceles_trapezoid" class="extiw" title="wp:isosceles trapezoid">isosceles trapezoid</a> in both cases.</p>
<p>Another zoning consideration is whether to place just one portal in a small corridor or actually make the corridor a separate zone by using two portals. I decided to make the front entrances to the back rooms separate zones because there's enough chance that the second portal isn't visible from the first when viewing from an angle. If the portals were closer together this wouldn't happen often enough, and if only a small part of a portal sheet is visible, the entire portal is considered visible.</p>
<p>Other parts that got their own zones are the area below the upper walkway right outside the back rooms, the ramps between the back rooms and the lower corridors, and the top part of the back rooms which isn't visible from the outside. Those complex lightbox meshes in the back rooms are quite a performance hit, so best effort must be made to prevent them from being rendered if they aren't actually visible.</p>
<h2><span class="mw-headline" id="Optimizing_zone_visibility">Optimizing zone visibility</span></h2>
<p>For the next step, all zones should get their own ZoneInfo actor. Open the level in the game, fly around as spectator and use the command <b>rmode 1</b> to switch to wireframe mode. Now check the view through your zone portals. In this step you try to identify pairs of zones which are not actually visible from each other, yet the engine decides to render them.</p>
<p>For Aswan this is the case for the lower corridors from the side to the back rooms. They definitely aren't visible from each other, but because BSP doesn't occlude visibility, the zone portals "see" each other. This could probably be fixed with anti portals, but it is much cheaper and almost as efficient to just manually tell the engine that the zones aren't visible from each other by using <a href="https://wiki.beyondunreal.com/edit/Manual_excludes?redlink=1" class="new" title="Manual excludes (page does not exist)">manual excludes</a>. (ZoneInfo property <a href="../UE2_ZoneInfo_(UT2004).html#ManualExcludes" title="UE2:ZoneInfo (UT2004)">ManualExcludes</a>) For example, the red flak cannon corridor and the blue rocket launcher corridor are set as manual excludes for each other. It turned out that the engine also considers the red jail to be visible from either of those corridors, so the red jail zone is also added to the corridors' manual excludes.</p>
<p>Other manual excludes are the lower front entrance areas, which aren't visible from each other because the Double Damage pedestal in the middle blocks the view. The engine still renders them because their front portals are in the same zone.</p>
<p>If a zone doesn't have any zone portals or fake backdrop surfaces, it should be flagged as lonely zone. (ZoneInfo property <a href="../UE2_ZoneInfo_(UT2004).html#bLonelyZone" title="UE2:ZoneInfo (UT2004)">bLonelyZone</a>) This allows the engine to skip any considerations about rendering the zone when it renders other zones and about rendering other zones when it renders this zone. JB-Aswan-v2 uses this for the arena zone, because it is entirely separate.</p>
<h2><span class="mw-headline" id="Forcing_actor_visibility_zones">Forcing actor visibility zones</span></h2>
<p>Actors that are not entirely contained in a single zone are often considered visible from other zones even though other geometry or meshes block the view. On Aswan this mostly affects the lightbox meshes in the back rooms and some of the pillars on the front wall of the bases. For these large actors it makes sense to match their <a href="../UE2_Actor_properties_(UT2004).html#ForcedFisibilityZoneTag" title="UE2:Actor properties (UT2004)">ForcedFisibilityZoneTag</a> with the ZoneInfo Tag of the zones the actor really is contained in. For the lightboxes this is the red/blue backroom zone, and for the pillars it's the "outside", i.e. the outside zone and the front entrance zones. Similarly, the fluid surfaces are set to use their corresponding corridor as visibility zone.</p>
<h2><span class="mw-headline" id="Using_anti_portals">Using anti portals</span></h2>
<p>The final step of optimization is placing <a href="../Anti_portals.html" title="Anti portals">anti portals</a>. Good locations for these are e.g. large pillars that block much of the player's view. Anti portals should always have a simple shape, yet fill out as much space as possible because they are only considered separately for visibility occlusion.</p>
<p>On Aswan, the front row of pillars in front of the bases use six-sided cylinders as anti portals, the blocks between the jail bars contain upside-down four-sided pyramid shapes, the middle one cut off because it would reach into the escape tunnel. The entire wall with the escape tunnel door contains a large anti portal sheet that is tied to the escape door mover, the side walls of the middle area contain sheet anti portals, and finally the Double Damage pedestal contains an eight-sided cylinder anti portal. Additionally, some BSP surfaces are marked as anti portals, for example the upper walkway in front of the bases, which occlude the portals to the lower entrance areas.</p>

<!-- 
NewPP limit report
CPU time usage: 0.021 seconds
Real time usage: 0.022 seconds
Preprocessor visited node count: 15/1000000
Preprocessor generated node count: 20/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->

<!-- Saved in parser cache with key wiki:pcache:idhash:24398-0!*!0!!en!*!* and timestamp 20161215141637 and revision id 35394
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://wiki.beyondunreal.com/User:Wormbo/Optimizing_JB-Aswan-v2_(UT2004)?oldid=35394">https://wiki.beyondunreal.com/User:Wormbo/Optimizing_JB-Aswan-v2_(UT2004)?oldid=35394</a>"</div>
					<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://wiki.beyondunreal.com/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="../Category_Mapping_tutorials.html" title="Category:Mapping tutorials">Mapping tutorials</a></li></ul></div></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-user" class="selected"><a href="Optimizing_JB-Aswan-v2_(UT2004).html" title="View the user page [c]" accesskey="c">User page</a></li>
				<li id="ca-talk" class="new"><a href="https://wiki.beyondunreal.com/edit/User_talk:Wormbo/Optimizing_JB-Aswan-v2_(UT2004)?redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-viewsource"><a href="https://wiki.beyondunreal.com/edit/User:Wormbo/Optimizing_JB-Aswan-v2_(UT2004)" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				<li id="ca-history"><a href="https://wiki.beyondunreal.com/history/User:Wormbo/Optimizing_JB-Aswan-v2_(UT2004)" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=User%3AWormbo%2FOptimizing+JB-Aswan-v2+%28UT2004%29&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=User%3AWormbo%2FOptimizing+JB-Aswan-v2+%28UT2004%29" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="../index.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-navigation" role="navigation">
		<h3>Navigation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-mainpage"><a href="../index.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
											<li id="n-portal"><a href="../Unreal_Wiki_Community_portal-2.html" title="About the project, what you can do, where to find things">Community portal</a></li>
											<li id="n-recentchanges"><a href="https://wiki.beyondunreal.com/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="https://wiki.beyondunreal.com/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
											<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											<li id="n-Forums-.28General.29"><a href="https://forums.beyondunreal.com/forums/wiki-general.250/" rel="nofollow">Forums (General)</a></li>
											<li id="n-Forums-.28Technical.29"><a href="https://forums.beyondunreal.com/forums/wiki-technical.251/" rel="nofollow">Forums (Technical)</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="https://wiki.beyondunreal.com/" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search Unreal Wiki [f]" accesskey="f" id="searchInput" />
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="https://wiki.beyondunreal.com/Special:WhatLinksHere/User:Wormbo/Optimizing_JB-Aswan-v2_(UT2004)" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="https://wiki.beyondunreal.com/Special:RecentChangesLinked/User:Wormbo/Optimizing_JB-Aswan-v2_(UT2004)" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-contributions"><a href="https://wiki.beyondunreal.com/Special:Contributions/Wormbo" title="A list of contributions of this user">User contributions</a></li>
											<li id="t-log"><a href="https://wiki.beyondunreal.com/Special:Log/Wormbo">Logs</a></li>
											<li id="t-specialpages"><a href="https://wiki.beyondunreal.com/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-print"><a href="https://wiki.beyondunreal.com/User:Wormbo/Optimizing_JB-Aswan-v2_(UT2004)?printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
											<li id="t-permalink"><a href="https://wiki.beyondunreal.com/User:Wormbo/Optimizing_JB-Aswan-v2_(UT2004)?oldid=35394" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="https://wiki.beyondunreal.com/info/User:Wormbo/Optimizing_JB-Aswan-v2_(UT2004)" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-copyrightico">
									<a href="https://creativecommons.org/licenses/by-nc-sa/3.0/"><img src="../../licensebuttons.net/l/by-nc-sa/3.0/88x31.png" alt="Attribution-Noncommercial-Share Alike 3.0" width="88" height="31" /></a>
							</div>
					<div id="f-poweredbyico">
									<script async src="../../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <!-- Home Page -->
        <ins class="adsbygoogle"
             style="display:inline-block;width:728px;height:90px"
             data-ad-client="ca-pub-9605963037553244"
             data-ad-slot="9528541415"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
							</div>
					<ul id="f-list">
									<li id="lastmod"> Last modified at 04:30, 2 September 2009.</li>
									<li id="copyright">Licensed as <a href="../Unreal_Wiki_Copyrights.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>
									<li id="privacy"><a href="../Unreal_Wiki_Privacy_policy.html" title="Unreal Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="../Unreal_Wiki_About.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>
									<li id="disclaimer"><a href="../Unreal_Wiki_General_disclaimer.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.beyondunreal.com/w/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=monobook\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":100});
}</script></body>
<!-- Mirrored from wiki.beyondunreal.com/User:Wormbo/Optimizing_JB-Aswan-v2_(UT2004) by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 07:52:45 GMT -->
</html>
