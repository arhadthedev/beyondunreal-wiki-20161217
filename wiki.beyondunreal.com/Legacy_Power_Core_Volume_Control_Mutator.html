<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.beyondunreal.com/Legacy:Power_Core_Volume_Control_Mutator by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 07:56:30 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>Legacy:Power Core Volume Control Mutator - Unreal Wiki</title>
<meta name="generator" content="MediaWiki 1.25.1" />
<link rel="alternate" type="application/x-wiki" title="Edit" href="https://wiki.beyondunreal.com/edit/Legacy:Power_Core_Volume_Control_Mutator" />
<link rel="edit" title="Edit" href="https://wiki.beyondunreal.com/edit/Legacy:Power_Core_Volume_Control_Mutator" />
<link rel="shortcut icon" href="w/uewiki-favicon.png" />
<link rel="search" type="application/opensearchdescription+xml" href="w/opensearch_desc.php" title="Unreal Wiki" />
<link rel="EditURI" type="application/rsd+xml" href="w/api251f.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="Legacy_Power_Core_Volume_Control_Mutator.html" />
<link rel="copyright" href="Unreal_Wiki_Copyrights.html" />
<link rel="alternate" type="application/atom+xml" title="Unreal Wiki Atom feed" href="https://wiki.beyondunreal.com/Special:RecentChanges?feed=atom" />
<link rel="stylesheet" href="w/load2743.css?debug=false&amp;lang=en&amp;modules=ext.geshi.language.uscript%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if IE 6]><link rel="stylesheet" href="/w/skins/MonoBook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/w/skins/MonoBook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="w/load484a.css?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wiki:resourceloader:filter:minify-css:7:29b70323345a439ab9ed7007e0c178a6 */</style>
<script src="w/load9316.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"Legacy","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":100,"wgPageName":"Legacy:Power_Core_Volume_Control_Mutator","wgTitle":"Power Core Volume Control Mutator","wgCurRevisionId":6026,"wgRevisionId":6026,"wgArticleId":2515,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Legacy Tutorial"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Legacy:Power_Core_Volume_Control_Mutator","wgRelevantArticleId":2515,"wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}"});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wiki:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-100 ns-subject page-Legacy_Power_Core_Volume_Control_Mutator skin-monobook action-view">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
									<div id="siteNotice"><div id="localNotice" lang="en" dir="ltr"><p>Mostly Harmless
</p></div></div>
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Legacy:Power Core Volume Control Mutator</h1>

				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</div>
					<div id="contentSub"></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>After a team's Power Core has been destroyed in an <a href="Legacy_Onslaught.html" title="Legacy:Onslaught">Onslaught</a> game in <a href="Legacy_UT2004.html" title="Legacy:UT2004" class="mw-redirect">UT2004</a> it explodes. After the initial explosion a repetative and loud electricity-short-circuit type sound is played.</p>
<p>This tutorial will show you the steps required to write a small mutator that will allow the volume of both the Power Core's initial explosion and the subsequent electricity sound to be adjusted to your preference.</p>
<p></p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#How_does_the_Power_Core_explosion_actually_work"><span class="tocnumber">1</span> <span class="toctext">How does the Power Core explosion actually work</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Using_the_CheckReplacement.28.29_function"><span class="tocnumber">2</span> <span class="toctext">Using the CheckReplacement() function</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Controlling_Emitters_on_the_game_clients"><span class="tocnumber">3</span> <span class="toctext">Controlling Emitters on the game clients</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Catching_the_end_of_game"><span class="tocnumber">4</span> <span class="toctext">Catching the end of game</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Adding_the_VolumeControlGameRule_to_the_current_game-rule_set"><span class="tocnumber">5</span> <span class="toctext">Adding the VolumeControlGameRule to the current game-rule set</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Changing_the_Emitter_sound_volume"><span class="tocnumber">6</span> <span class="toctext">Changing the Emitter sound volume</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Making_the_power_core_volume_changes_configurable"><span class="tocnumber">7</span> <span class="toctext">Making the power core volume changes configurable</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Conclusion"><span class="tocnumber">8</span> <span class="toctext">Conclusion</span></a></li>
</ul>
</div>
<p></p>
<h2><span class="mw-headline" id="How_does_the_Power_Core_explosion_actually_work">How does the Power Core explosion actually work</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Power_Core_Volume_Control_Mutator?section=1" title="Edit section: How does the Power Core explosion actually work">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In order to change the volume of the Power Core's end of game sounds we must first find the code that is responsible for playing the sound and explosion. Since the explosion relates directly to the Power Core it would seem sensible to look for it within the Onslaught.<a href="https://wiki.beyondunreal.com/edit/Legacy:PowerCore?redlink=1" class="new" title="Legacy:PowerCore (page does not exist)">PowerCore</a> class. Sure enough conveniently tucked away within the class is the method <a href="Legacy_Power_Core_Volume_Control_Mutator/PowerCoreDestroyed.html" title="Legacy:Power Core Volume Control Mutator/PowerCoreDestroyed">Legacy:Power Core Volume Control Mutator/PowerCoreDestroyed</a>. The critical lines are shown below.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">simulated</span> <span class="kw1">function</span> PowerCoreDestroyed<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
  <span class="kw2">if</span> <span class="br0">(</span><span class="kw7">Level</span>.<span class="me0">NetMode</span> <span class="sy0">!=</span> NM_DedicatedServer<span class="br0">)</span> <span class="br0">{</span>
    <span class="co1">// If this code is running on either a Listen server or a pure game client then</span>
    <span class="co1">// create the Power Core's explosion effect and sound.</span>
    ExplosionEffect <span class="sy0">=</span> <span class="kw4">spawn</span><span class="br0">(</span><span class="kw1">class</span><span class="st0">'ONSPowerCoreBreachEffect'</span>, <span class="kw6">self</span><span class="br0">)</span>;
  <span class="br0">}</span>
<span class="br0">}</span>
</pre></div>
</div>
<p>The most important thing to note about this code is that the <i>ONSPowerCoreBreachEffect</i> object that is ultimately responsible for playing the sounds we wish to modify is <b>only</b> spawn on game clients. This object is <b>never</b> created on a dedicated server.</p>
<p>An inspection of the <a href="https://wiki.beyondunreal.com/edit/Legacy:ONSPowerCoreBreachEffect?redlink=1" class="new" title="Legacy:ONSPowerCoreBreachEffect (page does not exist)">ONSPowerCoreBreachEffect</a> code shows us two things.</p>
<ul>
<li>It is subclassed directly from Emitter.</li>
<li>All of it's properties are created as in-line objects within the defaultproperties sections.</li>
</ul>
<p><a href="Legacy_Emitter.html" title="Legacy:Emitter">Emitter</a> objects by default have two really impotant properties.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
  <span class="kw7">RemoteRole</span><span class="sy0">=</span><span class="kw7">ROLE_None</span> <span class="co1">// Emitters are never sent across the network</span>
  bNotOnDedServer<span class="sy0">=</span><span class="kw6">true</span> <span class="co1">// Emitters cannot be created on a dedicated server</span>
</pre></div>
</div>
<p>So, in order to change the sound volumes via our mutator we need to locate the ONSPowerCoreBreachEffect object on each of the game clients and then adjust the Emitter's sound properties.</p>
<h2><span class="mw-headline" id="Using_the_CheckReplacement.28.29_function">Using the CheckReplacement() function</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Power_Core_Volume_Control_Mutator?section=2" title="Edit section: Using the CheckReplacement() function">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>When changing the properties of objects (like sound volume, ammo counts etc) you would typically <i>catch</i> their creation within the Mutator's <i>CheckReplacement()</i> function as follows:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">class</span> PowerCoreVolumeControl <span class="kw1">extends</span> <span class="kw9">Mutator</span>;
<span class="kw1">function</span> <span class="kw5">bool</span> CheckReplacement<span class="br0">(</span><span class="kw9">Actor</span> Other, <span class="kw1">out</span> <span class="kw5">byte</span> bSuperRelevant<span class="br0">)</span> <span class="br0">{</span>
  <span class="kw2">if</span> <span class="br0">(</span> Other.<span class="kw3">IsA</span><span class="br0">(</span><span class="st0">'ONSPowerNodeEnergySphere'</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="co1">// Code to change volume goes in here.</span>
  <span class="br0">}</span>
<span class="br0">}</span>
</pre></div>
</div>
<p>Unfortunately the <i>CheckReplacement()</i> function is called <b>on the server</b> rather than any of the game's clients. As we discovered in the previous section the <a href="Legacy_Emitter.html" title="Legacy:Emitter">Emitter</a> responsible for the Power Core's destruction effects is only ever spawned on the client. We need another way of doing it.</p>
<h2><span class="mw-headline" id="Controlling_Emitters_on_the_game_clients">Controlling Emitters on the game clients</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Power_Core_Volume_Control_Mutator?section=3" title="Edit section: Controlling Emitters on the game clients">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Since we cannot use our Mutator to trap the creation of the Power Core's breach effect we need to do the next best thing. That is, find it once it has been spawned on the client. In order to do this we create an instance of a new class that can be spawned by our Mutator and replicated to the game clients.</p>
<p>The code to adjust the Emitter's sound volume has been left out for now and instead we write out a log message.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">class</span> VolumeControlClient <span class="kw1">extends</span> <span class="kw9">Actor</span>;
 
 
<span class="kw1">var</span> <span class="kw5">bool</span> bAdjustVolume; <span class="co1">// False once the volume has been changed.</span>
 
<span class="co1">// Every game tick we run through all of the current Emitter actors looking</span>
<span class="co1">// for the ONSPowerCoreBreachEffect Emitter.  Once we have found this we can</span>
<span class="co1">// update its volume settings and stop checking.</span>
<span class="kw1">simulated</span> <span class="kw1">event</span> <span class="kw4">Tick</span><span class="br0">(</span> <span class="kw5">float</span> DeltaTime <span class="br0">)</span> <span class="br0">{</span>
  <span class="kw1">local</span> ONSPowerCoreBreachEffect breachEffect;
  <span class="kw6">Super</span>.<span class="kw4">Tick</span><span class="br0">(</span> DeltaTime <span class="br0">)</span>;
 
  <span class="kw2">if</span> <span class="br0">(</span> <span class="kw6">self</span>.<span class="me0">bAdjustVolume</span> <span class="br0">)</span> <span class="br0">{</span>
    <span class="co1">// The foreach will examine every actor in the game!!!</span>
    <span class="co1">// This is an expensive (aka slow) operation.</span>
    <span class="kw2">foreach</span> <span class="kw2">AllActors</span><span class="br0">(</span><span class="kw1">class</span><span class="st0">'ONSPowerCoreBreachEffect'</span>, breachEffect<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw6">self</span>.<span class="me0">bAdjustVolume</span> <span class="sy0">=</span> <span class="kw6">False</span>;
      <span class="kw3">Log</span><span class="br0">(</span><span class="st0">"We found a breach effect so update its sound"</span><span class="br0">)</span>;
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span>
<span class="co1">// Set the remote role so that the client will run the tick function when the</span>
<span class="co1">// object is created there.</span>
<span class="co1">// If bAlwaysRelevant is not set to true then the object is never replicated</span>
<span class="co1">// to the game clients</span>
<span class="kw1">defaultproperties</span>
<span class="br0">{</span>
  bAdjustVolume<span class="sy0">=</span><span class="kw6">True</span>
  <span class="kw7">RemoteRole</span><span class="sy0">=</span><span class="kw7">ROLE_SimulatedProxy</span>
  bAlwaysRelevant<span class="sy0">=</span><span class="kw6">True</span>
<span class="br0">}</span>
</pre></div>
</div>
<p>Even though we only adjust our Emitters volume once as we set the <i>bAdjustVolume</i> property to <i>false</i> once we have adjusted the Emitters volume this is still a very inneficient way of doing things.</p>
<p>Running through all of the Actors in the game with <b>every</b> game tick is bad news. Since the Power Core's breach effect is only ever created when the game has been won we only really need to start looking for the Emitter after the game has ended.</p>
<h2><span class="mw-headline" id="Catching_the_end_of_game">Catching the end of game</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Power_Core_Volume_Control_Mutator?section=4" title="Edit section: Catching the end of game">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Luckily for us UT2004 has a class specifically designed to allow the game ending conditions to be trapped and/or overidden. We need to create a subclass of <a href="Legacy_GameRules.html" title="Legacy:GameRules">GameRules</a>. The GameRules class has a bunch of methods that are called whenever a player needs to start, scores a kill, etc. Most importantly it has a function that is called to see if the game has ended. Our GameRules subclass looks like this.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">class</span> VolumeControlGameRule <span class="kw1">extends</span> GameRules;
 
<span class="co1">// If the game has ended then create the object responsible for setting the</span>
<span class="co1">// Power Core's sound effects volume on the game-client machines.</span>
<span class="kw1">function</span> <span class="kw5">bool</span> CheckEndGame<span class="br0">(</span>PlayerReplicationInfo Winner, <span class="kw5">string</span> Reason<span class="br0">)</span> <span class="br0">{</span>
  <span class="kw1">local</span> VolumeControlClient volTracker;
  <span class="kw1">local</span> <span class="kw5">bool</span> bGameEnded;
 
  bGameEnded <span class="sy0">=</span> <span class="kw6">Super</span>.<span class="me0">CheckEndGame</span><span class="br0">(</span>Winner, Reason<span class="br0">)</span>;
  <span class="kw2">if</span> <span class="br0">(</span> bGameEnded <span class="br0">)</span> <span class="br0">{</span>
    volTracker <span class="sy0">=</span> <span class="kw4">Spawn</span><span class="br0">(</span><span class="kw1">class</span><span class="st0">'VolumeControlClient'</span><span class="br0">)</span>;
  <span class="br0">}</span>
  <span class="kw2">return</span> bGameEnded;
<span class="br0">}</span>
</pre></div>
</div>
<p>As you can see from the above code it doesn't do very much. We are not interested in changing the rules of the game - merely detecting when it happens so we pass on the "game ended" check to any other game rules that are currently active. If the game has ended then we spawn the object (a VolumeControlClient) that will actually handle the volume update.</p>
<p>So how do we get our VolumeControlGameRule object into the set of rules the game is using? Easy - we get our Mutator class to add our GameRule object to it.</p>
<h2><span class="mw-headline" id="Adding_the_VolumeControlGameRule_to_the_current_game-rule_set">Adding the VolumeControlGameRule to the current game-rule set</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Power_Core_Volume_Control_Mutator?section=5" title="Edit section: Adding the VolumeControlGameRule to the current game-rule set">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Adding an instance of our VolumeControlGameRule class to the current game rules is very easy. We can do it by adding the following code to our Mutator.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="co1">// Announce to the log file that we have started and create the</span>
<span class="co1">// GameRule object that will ultimately be responsible for spotting the end</span>
<span class="co1">// of the game and creating the object that will actually update the sound</span>
<span class="co1">// volumes we need.</span>
<span class="kw1">event</span> <span class="kw4">PostBeginPlay</span><span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
  <span class="kw1">local</span> GameRules volumeRule;
  <span class="kw6">Super</span>.<span class="kw4">PostBeginPlay</span><span class="br0">(</span><span class="br0">)</span>;
 
  volumeRule <span class="sy0">=</span> <span class="kw4">spawn</span><span class="br0">(</span><span class="kw1">class</span><span class="st0">'VolumeControlGameRule'</span><span class="br0">)</span>;
  <span class="kw2">if</span> <span class="br0">(</span> <span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">GameRulesModifiers</span> <span class="sy0">==</span> <span class="kw5">None</span> <span class="br0">)</span> <span class="br0">{</span>
    <span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">GameRulesModifiers</span> <span class="sy0">=</span> volumeRule;
  <span class="br0">}</span> <span class="kw2">else</span> <span class="br0">{</span>
    <span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">GameRulesModifiers</span>.<span class="me0">AddGameRules</span><span class="br0">(</span>volumeRule<span class="br0">)</span>;
  <span class="br0">}</span>
  <span class="co1">// NOTE: Vampire mutator calls Destroy() here!</span>
<span class="br0">}</span>
</pre></div>
</div>
<dl>
<dd>The only oddity about this function is that the Vampire mutator calls the Mutator's Destroy() function once it has spawned its game rule object. The implication of this is that game rules are <i>sticky</i>. By this I mean carried from one level to the next. However, in my testing I did not find that this was the case. It could be a minor performance enhancement - after all once our game rule object has been created the mutator object has no further use.</dd>
</dl>
<h2><span class="mw-headline" id="Changing_the_Emitter_sound_volume">Changing the Emitter sound volume</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Power_Core_Volume_Control_Mutator?section=6" title="Edit section: Changing the Emitter sound volume">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>At this point we have created our <i>PowerCoreVolumeControl</i> mutator class. This mutator exists solely for the purpose of adding a custom game rule (<i>VolumeControlGameRule</i>) to the current list of game rules. Our game rule class detects when the game has ended and creates a <i>VolumeControlClient</i> object. It is the <i>VolumeControlClient</i> object that is responsible for actually adjusting the volume of the emitter sound.</p>
<p>The Power Core's breach effect Emitter is actually a composition of 11 separate Emitters. All of these Emitters are stored in the Emitters property of the Emitter class. Adjusting the sound volume of the breach effect is simply a matter of looping through each of the emitters making up the breach effect and altering the volume of the sounds. The following code will do this.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="co1">// This is the function that actually updates the sound volume of the Emitter.</span>
<span class="co1">// It loops through each of the Emitter's attached to the the BreachEffect</span>
<span class="co1">// emitter and examines the sound attached to the "child" emitter updating as</span>
<span class="co1">// required.</span>
<span class="co1">// It is declared as simulated so it can be called from the simulated Tick() event.</span>
<span class="kw1">simulated</span> <span class="kw1">function</span> AdjustSoundVolume<span class="br0">(</span> <span class="kw9">Emitter</span> breachEffect <span class="br0">)</span> <span class="br0">{</span>
  <span class="kw1">local</span> <span class="kw5">int</span> i;
  <span class="kw2">for</span> <span class="br0">(</span>i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>breachEffect.<span class="me0">Emitters</span>.<span class="me0">Length</span>; i<span class="sy0">++</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="co1">// If the emitter we have found has a sound then check further.</span>
    <span class="kw2">if</span> <span class="br0">(</span> breachEffect.<span class="me0">Emitters</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me0">Sounds</span>.<span class="me0">Length</span> <span class="sy0">&gt;</span> <span class="nu0">0</span> <span class="br0">)</span> <span class="br0">{</span>
      <span class="kw2">if</span> <span class="br0">(</span> i <span class="sy0">==</span> <span class="nu0">8</span> <span class="sy0">||</span> i <span class="sy0">==</span> <span class="nu0">9</span> <span class="br0">)</span> <span class="br0">{</span>
        <span class="co1">// child emitters 8 and 9 are the electricity sound, so turn them off.</span>
        breachEffect.<span class="me0">Emitters</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me0">Sounds</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>.<span class="kw9">Volume</span>.<span class="kw3">Min</span> <span class="sy0">=</span> <span class="nu0">0.0</span>;
        breachEffect.<span class="me0">Emitters</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me0">Sounds</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>.<span class="kw9">Volume</span>.<span class="kw3">Max</span> <span class="sy0">=</span> <span class="nu0">0.0</span>;
      <span class="br0">}</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span>
</pre></div>
</div>
<p>The for .. loop in the above code is a little redundant. However it does make it a little easier to allow the change in volume of the power core explosion and the electricity sound to be made configurable.</p>
<h2><span class="mw-headline" id="Making_the_power_core_volume_changes_configurable">Making the power core volume changes configurable</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Power_Core_Volume_Control_Mutator?section=7" title="Edit section: Making the power core volume changes configurable">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In order to allow the user to configure the change in volume of the Power Core explosion and the electricity sound we need to update the signature of the class (to allow for the storage of the configuration information). We also need to add the configurable variables to the class definition. By the time you have done this your class should look something like that shown below.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">class</span> PowerCoreVolumeControl <span class="kw1">extends</span> <span class="kw9">Mutator</span> <span class="kw1">config</span> <span class="br0">(</span>MutPowerCoreVolumeControl<span class="br0">)</span>;
 
<span class="co1">// Values that will be stored within the MutPowerCoreColumeControl.ini file</span>
<span class="kw1">var</span><span class="br0">(</span><span class="br0">)</span> <span class="kw1">config</span> <span class="kw5">float</span> ExplosionVol;    <span class="co1">// The modifier for the explosion volume</span>
<span class="kw1">var</span><span class="br0">(</span><span class="br0">)</span> <span class="kw1">config</span> <span class="kw5">float</span> ElectricityVol;  <span class="co1">// The modifier for the electricity volume</span>
 
<span class="co1">// Create the GameRule object that will catch the end of the game</span>
<span class="kw1">event</span> <span class="kw4">PostBeginPlay</span><span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
  <span class="kw1">local</span> GameRules volumeRule;
  <span class="kw6">Super</span>.<span class="kw4">PostBeginPlay</span><span class="br0">(</span><span class="br0">)</span>;
 
  volumeRule <span class="sy0">=</span> <span class="kw4">spawn</span><span class="br0">(</span><span class="kw1">class</span><span class="st0">'VolumeControlGameRule'</span><span class="br0">)</span>;
  <span class="kw2">if</span> <span class="br0">(</span> <span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">GameRulesModifiers</span> <span class="sy0">==</span> <span class="kw5">None</span> <span class="br0">)</span> <span class="br0">{</span>
    <span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">GameRulesModifiers</span> <span class="sy0">=</span> volumeRule;
  <span class="br0">}</span> <span class="kw2">else</span> <span class="br0">{</span>
    <span class="kw7">Level</span>.<span class="kw7">Game</span>.<span class="me0">GameRulesModifiers</span>.<span class="me0">AddGameRules</span><span class="br0">(</span>volumeRule<span class="br0">)</span>;
  <span class="br0">}</span>
<span class="br0">}</span>
<span class="kw1">defaultproperties</span>
<span class="br0">{</span>
  ExplosionVol<span class="sy0">=</span><span class="nu0">1.0</span>
  ElectricityVol<span class="sy0">=</span><span class="nu0">0.1</span>
<span class="br0">}</span>
</pre></div>
</div>
<p>However, this still doesn't make the attributes configurable via the GUI. In order to do this we can make use of some new functions added in UT2004. The function's are shown below:</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="co1">// We need the following additional properties</span>
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> GIPropsDisplayText<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span>; <span class="co1">// Config property display names</span>
<span class="kw1">var</span> <span class="kw1">localized</span> <span class="kw5">string</span> GIPropDescText<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span>;     <span class="co1">// Config property descriptions</span>
 
<span class="co1">// This function is called when the Mutator Configuration window is displayed</span>
<span class="co1">// It is responsible for returning the widget information to be used to</span>
<span class="co1">// configure the mutator.</span>
<span class="kw1">static</span> <span class="kw1">function</span> FillPlayInfo<span class="br0">(</span><span class="kw8">PlayInfo</span> <span class="kw8">PlayInfo</span><span class="br0">)</span> <span class="br0">{</span>
  <span class="kw6">Super</span>.<span class="me0">FillPlayInfo</span><span class="br0">(</span><span class="kw8">PlayInfo</span><span class="br0">)</span>;
  <span class="kw8">PlayInfo</span>.<span class="me0">AddSetting</span><span class="br0">(</span> <span class="kw1">default</span>.<span class="me0">RulesGroup</span>, <span class="st0">"ExplosionVol"</span>, <span class="kw1">class</span><span class="st0">'PowerCoreVolumeControl'</span>.<span class="kw1">default</span>.<span class="me0">GIPropsDisplayText</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>, <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="st0">"Text"</span>, <span class="st0">"8;0.0:1.5"</span> <span class="br0">)</span>;
  <span class="kw8">PlayInfo</span>.<span class="me0">AddSetting</span><span class="br0">(</span> <span class="kw1">default</span>.<span class="me0">RulesGroup</span>, <span class="st0">"ElectricityVol"</span>, <span class="kw1">class</span><span class="st0">'PowerCoreVolumeControl'</span>.<span class="kw1">default</span>.<span class="me0">GIPropsDisplayText</span><span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span>, <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="st0">"Text"</span>, <span class="st0">"8;0.0:1.5"</span> <span class="br0">)</span>;
<span class="br0">}</span>
 
<span class="co1">// This function is called by the Mutator Configuration window when a</span>
<span class="co1">// description of the configuration property is required.</span>
<span class="kw1">static</span> <span class="kw1">event</span> <span class="kw5">string</span> GetDescriptionText<span class="br0">(</span><span class="kw5">string</span> PropName<span class="br0">)</span> <span class="br0">{</span>
  <span class="kw2">switch</span> <span class="br0">(</span>PropName<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">case</span> <span class="st0">"ExplosionVol"</span>:
      <span class="kw2">return</span> <span class="kw1">class</span><span class="st0">'PowerCoreVolumeControl'</span>.<span class="kw1">default</span>.<span class="me0">GIPropDescText</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>;
    <span class="kw2">case</span> <span class="st0">"ElectricityVol"</span>:
      <span class="kw2">return</span> <span class="kw1">class</span><span class="st0">'PowerCoreVolumeControl'</span>.<span class="kw1">default</span>.<span class="me0">GIPropDescText</span><span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span>;
  <span class="br0">}</span>
  <span class="kw2">return</span> <span class="kw6">Super</span>.<span class="me0">GetDescriptionText</span><span class="br0">(</span>PropName<span class="br0">)</span>;
<span class="br0">}</span>
</pre></div>
</div>
<p>The functions are relatively self explanatory. Note that the second parameter to the <i>PlayInfo.AddSetting()</i> function call, and that used in the case statement <b>must</b> match the class property name being changed. In this case we have allowed the properties to be assigned a value between 0.0 and 1.5.</p>
<p>We still haven't quite finished yet though. We hard-coded the volume setting within the function responsible for adjusting the volume. We now need to go back and fix that. The final function is reproduced below.</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="kw1">simulated</span> <span class="kw1">function</span> AdjustSoundVolume<span class="br0">(</span> <span class="kw9">Emitter</span> breachEffect <span class="br0">)</span> <span class="br0">{</span>
  <span class="kw1">local</span> <span class="kw5">int</span> i;
  <span class="kw2">for</span> <span class="br0">(</span>i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>breachEffect.<span class="me0">Emitters</span>.<span class="me0">Length</span>; i<span class="sy0">++</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">if</span> <span class="br0">(</span> breachEffect.<span class="me0">Emitters</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me0">Sounds</span>.<span class="me0">Length</span> <span class="sy0">&gt;</span> <span class="nu0">0</span> <span class="br0">)</span> <span class="br0">{</span>
      <span class="kw2">if</span> <span class="br0">(</span> i <span class="sy0">==</span> <span class="nu0">8</span> <span class="sy0">||</span> i <span class="sy0">==</span> <span class="nu0">9</span> <span class="br0">)</span> <span class="br0">{</span>
        breachEffect.<span class="me0">Emitters</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me0">Sounds</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>.<span class="kw9">Volume</span>.<span class="kw3">Min</span> <span class="sy0">*=</span> <span class="kw1">class</span><span class="st0">'PowerCoreVolumeControl'</span>.<span class="kw1">default</span>.<span class="me0">ElectricityVol</span>;
        breachEffect.<span class="me0">Emitters</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me0">Sounds</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>.<span class="kw9">Volume</span>.<span class="kw3">Max</span> <span class="sy0">*=</span> <span class="kw1">class</span><span class="st0">'PowerCoreVolumeControl'</span>.<span class="kw1">default</span>.<span class="me0">ElectricityVol</span>;
      <span class="br0">}</span> <span class="kw2">else</span> <span class="br0">{</span>
        breachEffect.<span class="me0">Emitters</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me0">Sounds</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>.<span class="kw9">Volume</span>.<span class="kw3">Min</span> <span class="sy0">*=</span> <span class="kw1">class</span><span class="st0">'PowerCoreVolumeControl'</span>.<span class="kw1">default</span>.<span class="me0">ExplosionVol</span>;
        breachEffect.<span class="me0">Emitters</span><span class="br0">[</span>i<span class="br0">]</span>.<span class="me0">Sounds</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>.<span class="kw9">Volume</span>.<span class="kw3">Max</span> <span class="sy0">*=</span> <span class="kw1">class</span><span class="st0">'PowerCoreVolumeControl'</span>.<span class="kw1">default</span>.<span class="me0">ExplosionVol</span>;
      <span class="br0">}</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span>
</pre></div>
</div>
<p>You will notice that at no point do I ever replicate the server's Mutator configuration values to the clients. This is done deliberately to allow each client to configure their own preferred volume settings.</p>
<h2><span class="mw-headline" id="Conclusion">Conclusion</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/Legacy:Power_Core_Volume_Control_Mutator?section=8" title="Edit section: Conclusion">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>If you got this far you should (in theory) have a working mutator that you can use to alter the volume of the Power Core's breach effects. Not only that but you should have an appreciation of Emitter structure. You should also be aware that Emitters are purely game-client constructions. That is, they will never exist on a dedicated server. I hope you found the tutorial useful.</p>
<p>If you ever find a better way of catching an Emitter's creation than searching for it within the Tick() event I'd love to hear about it.</p>
<p>The compiled code and source code for this mutator is available here: <a rel="nofollow" class="external free" href="http://www.snout-clan.co.uk/p.php?p=3065">http://www.snout-clan.co.uk/p.php?p=3065</a></p>

<!-- 
NewPP limit report
CPU time usage: 0.157 seconds
Real time usage: 0.159 seconds
Preprocessor visited node count: 128/1000000
Preprocessor generated node count: 260/1000000
Post‐expand include size: 72/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->

<!-- Saved in parser cache with key wiki:pcache:idhash:2515-0!*!0!!en!*!* and timestamp 20161215142740 and revision id 6026
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://wiki.beyondunreal.com/Legacy:Power_Core_Volume_Control_Mutator?oldid=6026">https://wiki.beyondunreal.com/Legacy:Power_Core_Volume_Control_Mutator?oldid=6026</a>"</div>
					<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://wiki.beyondunreal.com/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="Category_Legacy_Tutorial.html" title="Category:Legacy Tutorial">Legacy Tutorial</a></li></ul></div></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-legacy" class="selected"><a href="Legacy_Power_Core_Volume_Control_Mutator.html">Legacy</a></li>
				<li id="ca-talk" class="new"><a href="https://wiki.beyondunreal.com/edit/Legacy_talk:Power_Core_Volume_Control_Mutator?redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-edit"><a href="https://wiki.beyondunreal.com/edit/Legacy:Power_Core_Volume_Control_Mutator" title="You can edit this page. Please use the preview button before saving [e]" accesskey="e">Edit</a></li>
				<li id="ca-history"><a href="https://wiki.beyondunreal.com/history/Legacy:Power_Core_Volume_Control_Mutator" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=Legacy%3APower+Core+Volume+Control+Mutator&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=Legacy%3APower+Core+Volume+Control+Mutator" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="index.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-navigation" role="navigation">
		<h3>Navigation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-mainpage"><a href="index.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
											<li id="n-portal"><a href="Unreal_Wiki_Community_portal-2.html" title="About the project, what you can do, where to find things">Community portal</a></li>
											<li id="n-recentchanges"><a href="https://wiki.beyondunreal.com/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="https://wiki.beyondunreal.com/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
											<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											<li id="n-Forums-.28General.29"><a href="https://forums.beyondunreal.com/forums/wiki-general.250/" rel="nofollow">Forums (General)</a></li>
											<li id="n-Forums-.28Technical.29"><a href="https://forums.beyondunreal.com/forums/wiki-technical.251/" rel="nofollow">Forums (Technical)</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="https://wiki.beyondunreal.com/" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search Unreal Wiki [f]" accesskey="f" id="searchInput" />
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="https://wiki.beyondunreal.com/Special:WhatLinksHere/Legacy:Power_Core_Volume_Control_Mutator" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="https://wiki.beyondunreal.com/Special:RecentChangesLinked/Legacy:Power_Core_Volume_Control_Mutator" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="https://wiki.beyondunreal.com/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-print"><a href="https://wiki.beyondunreal.com/Legacy:Power_Core_Volume_Control_Mutator?printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
											<li id="t-permalink"><a href="https://wiki.beyondunreal.com/Legacy:Power_Core_Volume_Control_Mutator?oldid=6026" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="https://wiki.beyondunreal.com/info/Legacy:Power_Core_Volume_Control_Mutator" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-copyrightico">
									<a href="https://creativecommons.org/licenses/by-nc-sa/3.0/"><img src="../licensebuttons.net/l/by-nc-sa/3.0/88x31.png" alt="Attribution-Noncommercial-Share Alike 3.0" width="88" height="31" /></a>
							</div>
					<div id="f-poweredbyico">
									<script async src="../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <!-- Home Page -->
        <ins class="adsbygoogle"
             style="display:inline-block;width:728px;height:90px"
             data-ad-client="ca-pub-9605963037553244"
             data-ad-slot="9528541415"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
							</div>
					<ul id="f-list">
									<li id="lastmod"> Last modified at 12:36, 7 September 2004.</li>
									<li id="copyright">Licensed as <a href="Unreal_Wiki_Copyrights.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>
									<li id="privacy"><a href="Unreal_Wiki_Privacy_policy.html" title="Unreal Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="Unreal_Wiki_About.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>
									<li id="disclaimer"><a href="Unreal_Wiki_General_disclaimer.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.beyondunreal.com/w/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=monobook\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":79});
}</script></body>
<!-- Mirrored from wiki.beyondunreal.com/Legacy:Power_Core_Volume_Control_Mutator by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 07:56:30 GMT -->
</html>
