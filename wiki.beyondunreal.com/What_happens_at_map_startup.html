<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.beyondunreal.com/What_happens_at_map_startup by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 07:52:50 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>What happens at map startup - Unreal Wiki</title>
<meta name="generator" content="MediaWiki 1.25.1" />
<link rel="alternate" type="application/x-wiki" title="Edit" href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup" />
<link rel="edit" title="Edit" href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup" />
<link rel="shortcut icon" href="w/uewiki-favicon.png" />
<link rel="search" type="application/opensearchdescription+xml" href="w/opensearch_desc.php" title="Unreal Wiki" />
<link rel="EditURI" type="application/rsd+xml" href="w/api251f.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="What_happens_at_map_startup.html" />
<link rel="copyright" href="Unreal_Wiki_Copyrights.html" />
<link rel="alternate" type="application/atom+xml" title="Unreal Wiki Atom feed" href="https://wiki.beyondunreal.com/Special:RecentChanges?feed=atom" />
<link rel="stylesheet" href="w/load2743.css?debug=false&amp;lang=en&amp;modules=ext.geshi.language.uscript%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if IE 6]><link rel="stylesheet" href="/w/skins/MonoBook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/w/skins/MonoBook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="w/load484a.css?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wiki:resourceloader:filter:minify-css:7:29b70323345a439ab9ed7007e0c178a6 */</style>
<script src="w/load9316.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"What_happens_at_map_startup","wgTitle":"What happens at map startup","wgCurRevisionId":45927,"wgRevisionId":45927,"wgArticleId":28783,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Programming articles","Native code snippet"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"What_happens_at_map_startup","wgRelevantArticleId":28783,"wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgCategoryTreePageCategoryOptions":"{\"mode\":0,\"hideprefix\":20,\"showcount\":true,\"namespaces\":false}"});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wiki:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-What_happens_at_map_startup skin-monobook action-view">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
									<div id="siteNotice"><div id="localNotice" lang="en" dir="ltr"><p>Cogito, ergo sum
</p></div></div>
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">What happens at map startup</h1>

				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From Unreal Wiki, The Unreal Engine Documentation Site</div>
					<div id="contentSub"></div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>The information in this article are based on a snippet of native <a href="UT2004.html" title="UT2004" class="mw-redirect">UT2004</a> code posted by Steve Polge on Epic Game's ut2003mods mailing list. The code can be found as UnGame.cpp in the Engine\Src directory of the UT2004 <a href="UnrealScript_source_code.html" title="UnrealScript source code">UnrealScript source code</a> download.</p>
<p>This article only describes the map startup process. It applies to offline games, network servers and clients, including <a href="https://wiki.beyondunreal.com/edit/UTV?redlink=1" class="new" title="UTV (page does not exist)">UTV</a> clients (but not the UTV proxy server) and demo playback. Note that this article does not apply to loading saved game states in engine builds that support this. Those "simply continue" from where the game was saved. In UT2004 the <a href="UE2_Actor_events_(UT2004).html#PostLoadSavedGame" title="UE2:Actor events (UT2004)">PostLoadSavedGame() event</a> is called for all existing actors and all ragdolls are destroyed because their state cannot be stored in save game files.</p>
<p>The seamless travel feature of <a href="Unreal_Engine_3.html" title="Unreal Engine 3">Unreal Engine 3</a> seems to behave similarly to a regular map startup, except that the new map is loaded in the background. However, additional GameInfo events, such as GetSeamlessTravelActorList(), PostSeamlessTravel() and HandleSeamlessTravelPlayer() are called at some point during the map change process. <i>(This needs further research.)</i></p>
<p></p>
<div id="toc" class="toc">
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Summary_of_events"><span class="tocnumber">1</span> <span class="toctext">Summary of events</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Client_preparations"><span class="tocnumber">1.1</span> <span class="toctext">Client preparations</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#General_preparations"><span class="tocnumber">1.2</span> <span class="toctext">General preparations</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#GameInfo.InitGame.28.29"><span class="tocnumber">1.3</span> <span class="toctext">GameInfo.InitGame()</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#PreBeginPlay.28.29"><span class="tocnumber">1.4</span> <span class="toctext">PreBeginPlay()</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#BeginPlay.28.29"><span class="tocnumber">1.5</span> <span class="toctext">BeginPlay()</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Zones.2FVolumes"><span class="tocnumber">1.6</span> <span class="toctext">Zones/Volumes</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#PostBeginPlay.28.29"><span class="tocnumber">1.7</span> <span class="toctext">PostBeginPlay()</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#PostNetBeginPlay.28.29"><span class="tocnumber">1.8</span> <span class="toctext">PostNetBeginPlay()</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#SetInitialState.28.29"><span class="tocnumber">1.9</span> <span class="toctext">SetInitialState()</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Finding_bases"><span class="tocnumber">1.10</span> <span class="toctext">Finding bases</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Final_initialization_step"><span class="tocnumber">1.11</span> <span class="toctext">Final initialization step</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#The_actual_UnGame.cpp_snippet"><span class="tocnumber">2</span> <span class="toctext">The actual UnGame.cpp snippet</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Hints_for_reading_the_code"><span class="tocnumber">2.1</span> <span class="toctext">Hints for reading the code</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#General_notes_about_this_code_snippet"><span class="tocnumber">2.2</span> <span class="toctext">General notes about this code snippet</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Notes_for_Unreal_Engine_1"><span class="tocnumber">2.3</span> <span class="toctext">Notes for Unreal Engine 1</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Notes_for_Unreal_Engine_3"><span class="tocnumber">2.4</span> <span class="toctext">Notes for Unreal Engine 3</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#The_code"><span class="tocnumber">2.5</span> <span class="toctext">The code</span></a></li>
</ul>
</li>
</ul>
</div>
<p></p>
<h2><span class="mw-headline" id="Summary_of_events">Summary of events</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=1" title="Edit section: Summary of events">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Before any of the following events happen, the engine loads the map and any packages it depends on.</p>
<p>Next it spawns the <a href="GameInfo.html" title="GameInfo">GameInfo</a>, unless loading the map for a saved game or in a client environment. The engine always tries to load the GameInfo class from the <code>?game=</code> URL option. If that fails, a default game type for the map is determined, either using the <a href="https://wiki.beyondunreal.com/edit/LevelInfo?redlink=1" class="new" title="LevelInfo (page does not exist)">LevelInfo</a>'s <i>DefaultGameType</i> property (<a href="https://wiki.beyondunreal.com/edit/UE1?redlink=1" class="new" title="UE1 (page does not exist)">UE1</a> and <a href="https://wiki.beyondunreal.com/edit/UE2?redlink=1" class="new" title="UE2 (page does not exist)">UE2</a>) or the map prefix (<a href="UE3.html" title="UE3" class="mw-redirect">UE3</a>). If that fails as well, a default game type as specified in the main <a href="https://wiki.beyondunreal.com/edit/INI_file?redlink=1" class="new" title="INI file (page does not exist)">INI file</a> is used. The final fallback option is the GameInfo class itself.</p>
<p>Additionally, if running a listen or dedicated server, any actors mentioned in the <i>ServerActors</i> list of INI section [Engine.GameEngine] are created. Non-standard property values for these actors may be specified in the form <code><i>propertyname</i>=<i>value</i></code> on the ServerActors line, separated form the actor class and from each other by spaces.</p>
<p>Note that at this point there are no player actors in the level yet. Offline and on a listen server, the local player joins right after map startup completed. In network client environments (including UTV and demo playback), the local player actor is received through <a href="Replication.html" title="Replication" class="mw-redirect">replication</a> soon after map startup has completed.</p>
<p>During the events described here, the LevelInfo or WorldInfo's <i>bStartup</i> property is set to <code>True</code>.</p>
<h3><span class="mw-headline" id="Client_preparations">Client preparations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=2" title="Edit section: Client preparations">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>One of the first things the engine does in client environments is deleting all actors that have neither <i>bStatic</i> nor <i>bNoDelete</i> set to <code>True</code>. (UT2004 also treats xEmitters as undeletable in this context.)</p>
<p>Any remaining actors have their <i>Role</i> and <i>RemoteRole</i> swapped as if they were received through <a href="Replication.html" title="Replication" class="mw-redirect">replication</a>. The only exception are actors with <i>bClientAuthoritative</i> set to <code>True</code>, which only really applies to ClientMovers.</p>
<h3><span class="mw-headline" id="General_preparations">General preparations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=3" title="Edit section: General preparations">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>All actors start out touching nothing and using the level's DefaultPhysicsVolume as their current <i>PhysicsVolume</i>. Native code also initializes state support and Karma physics here.</p>
<p>Only at this point UnrealScript support is enabled for the actors in this level by setting the LevelInfo's <i>bBegunPlay</i> to <code>True</code>. Any actors spawned before this point did not get the UnrealScript events during <a href="What_happens_when_an_Actor_is_spawned.html" title="What happens when an Actor is spawned">what happens when an Actor is spawned</a> and any actors destroyed did not receive the events during <a href="What_happens_when_an_Actor_is_destroyed.html" title="What happens when an Actor is destroyed">what happens when an Actor is destroyed</a>.</p>
<h3><span class="mw-headline" id="GameInfo.InitGame.28.29">GameInfo.InitGame()</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=4" title="Edit section: GameInfo.InitGame()">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Offline and on network servers the GameInfo's InitGame() event is called now. UT2004 also calls SetGrammar() afterwards, which initializes speech recognition grammars.</p>
<p>InitGame() performs general and gametype-specific initialization. It parses the URL options and among other things also spawns the AccessControl, Mutators and similar actors. Those actors are initialized according to <a href="What_happens_when_an_Actor_is_spawned.html" title="What happens when an Actor is spawned">what happens when an Actor is spawned</a>. Starting with <a href="https://wiki.beyondunreal.com/edit/UE2?redlink=1" class="new" title="UE2 (page does not exist)">UE2</a> these actors exclude themselves from receiving the UnrealScript events mentioned below by setting their <i>bScriptInitialized</i> property to <code>True</code>, usually in their SetInitialState() event.</p>
<h3><span class="mw-headline" id="PreBeginPlay.28.29">PreBeginPlay()</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=5" title="Edit section: PreBeginPlay()">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Next the PreBeginPlay() function is called for all actors with <i>bScriptInitialized</i>=<code>False</code>.</p>
<p>The default implementation of PreBeginPlay() allows mutators to modify the actor while it is being initialized by calling the GameInfo's IsRelevant() in <a href="https://wiki.beyondunreal.com/edit/UE1?redlink=1" class="new" title="UE1 (page does not exist)">UE1</a>, the base mutator's CheckRelevance() in <a href="https://wiki.beyondunreal.com/edit/UE2?redlink=1" class="new" title="UE2 (page does not exist)">UE2</a> or the GameInfo's CheckRelevance() in <a href="UE3.html" title="UE3" class="mw-redirect">UE3</a>. These call <a href="https://wiki.beyondunreal.com/edit/Mutator?redlink=1" class="new" title="Mutator (page does not exist)">Mutator</a>.AlwaysKeep() and Mutator.IsRelevant(), which in turn calls Mutator.CheckReplacement().</p>
<p>The above logic doesn't apply if PreBeginPlay() is overridden without calling <a href="Super.html" title="Super" class="mw-redirect">Super</a>, the actor is flagged as <i>bGameRelevant</i>, the actor is <i>bStatic</i> (only UE3) or spawning happens on a network client.</p>
<h3><span class="mw-headline" id="BeginPlay.28.29">BeginPlay()</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=6" title="Edit section: BeginPlay()">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Then the BeginPlay() function is called for all actors with <i>bScriptInitialized</i>=<code>False</code>.</p>
<p>This event does nothing by default and no longer exists in Unreal Engine 3 as the same effect could be achieved by overriding PreBeginPlay() and calling Super.PreBeginPlay() first. It can be used to implement logic that should happen after mutators had a chance to modify the actor.</p>
<h3><span class="mw-headline" id="Zones.2FVolumes">Zones/Volumes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=7" title="Edit section: Zones/Volumes">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>At this point all actors' containing <a href="https://wiki.beyondunreal.com/edit/Zone?redlink=1" class="new" title="Zone (page does not exist)">zones</a> and <a href="https://wiki.beyondunreal.com/edit/PhysicsVolume?redlink=1" class="new" title="PhysicsVolume (page does not exist)">PhysicsVolumes</a> are initialized. Also, if the actor touches any <a href="https://wiki.beyondunreal.com/edit/Volume?redlink=1" class="new" title="Volume (page does not exist)">Volumes</a>, the actor and the Volume add each other to their list of touching actors.</p>
<p>Unlike for spawning actors, none of the actions in this startup stage cause UnrealScript events to be called.</p>
<h3><span class="mw-headline" id="PostBeginPlay.28.29">PostBeginPlay()</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=8" title="Edit section: PostBeginPlay()">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Now all actors with <i>bScriptInitialized</i>=<code>False</code> have their UnrealScript and C++ PostBeginPlay() functions called. These do nothing by default.</p>
<h3><span class="mw-headline" id="PostNetBeginPlay.28.29">PostNetBeginPlay()</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=9" title="Edit section: PostNetBeginPlay()">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Right after PostBeginPlay(), PostNetBeginPlay() is called on all actors with <i>bScriptInitialized</i>=<code>False</code>. This event does no longer exist in <a href="Unreal_Engine_3.html" title="Unreal Engine 3">Unreal Engine 3</a>.</p>
<p>Note that unlike for spawning actors, PostNetBeginPlay() is called <i>before</i> SetInitialSate().</p>
<h3><span class="mw-headline" id="SetInitialState.28.29">SetInitialState()</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=10" title="Edit section: SetInitialState()">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The SetInitialState() function is the last to be called on all actors (with <i>bScriptInitialized</i>=<code>False</code>) during initialization. As the name suggests, this function sets the actor's initial state. Using GotoState() it either switches to the state specified in the <a href="https://wiki.beyondunreal.com/edit/InitialState?redlink=1" class="new" title="InitialState (page does not exist)">InitialState</a> property or to the state marked with the <a href="Auto.html" title="Auto" class="mw-redirect">auto</a> modifier. As a result, the corresponding state's BeginState() event will be called.</p>
<p>Note that the <a href="UE2_Actor_native_functions_(UT2004).html#AddToPackageMap" title="UE2:Actor native functions (UT2004)">AddToPackageMap() function</a> in UT2004, which can dynamically add server packages at runtime, only works before this stage of map startup.</p>
<h3><span class="mw-headline" id="Finding_bases">Finding bases</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=11" title="Edit section: Finding bases">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In this step, any actors with an <i>AttachTag</i> are attached to the first actor with a matching <i>Tag</i> or <i>Name</i>. If a matching actor is found, it receives the Attach() event.</p>
<p>For actors without an <i>AttachTag</i>, that <i>bShouldBaseOnStartup</i>, have world collision enabled and have their <i>Physics</i> set to None or Rotating, a good base actor is determined. If a base is found, its Attach() event and this actor's BaseChange() event are called.</p>
<h3><span class="mw-headline" id="Final_initialization_step">Final initialization step</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=12" title="Edit section: Final initialization step">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The last iteration over all actors updates any <a href="https://wiki.beyondunreal.com/edit/Projector?redlink=1" class="new" title="Projector (page does not exist)">Projectors</a> and disables Karma simulation for high-detail actors in low-detail mode and for high-detail and client-only actors in dedicated server mode.</p>
<h2><span class="mw-headline" id="The_actual_UnGame.cpp_snippet">The actual UnGame.cpp snippet</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=13" title="Edit section: The actual UnGame.cpp snippet">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The following is a copy of the code snippet this article is based on. This particular piece of code is executed after a new map has been loaded and before the local player enters the game or any replication kicks in. Keep in mind that much of the initialization also happens at the UnrealScript level, so for a complete picture you should have the UT2004 sources ready and browse to the relevant UnrealScript functions.</p>
<h3><span class="mw-headline" id="Hints_for_reading_the_code">Hints for reading the code</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=14" title="Edit section: Hints for reading the code">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>A few things that will help understanding the code even if you're not into C++:</p>
<ul>
<li>The <code>-&gt;</code> operator does the same as the dot does in UnrealScript - it accessed variables or functions of an object.</li>
<li><code>GLevel</code> is a Level object. In UnrealScript this object is referenced by the XLevel property of any Actor.</li>
<li><code>GLevel-&gt;GetLevelInfo()</code> returns the actual LevelInfo object. The <code>Info</code> property also points to the LevelInfo.</li>
<li>Variables in UnrealScript objects have the same name in C++. For example <code>Info-&gt;bBegunPlay</code> refers to a variable you'd access as <code>Level.bBegunPlay</code> in UnrealScript code.</li>
<li>The LevelInfo's <code>bBegunPlay</code> acts as general gate to UnrealScript execution. During map load it is 0 (False), so no UnrealScript code will be executed until it is set to 1 (True) in this code snippet.</li>
<li>UnrealScript functions declared with the <i>event</i> keyword are called from C++ via <code>event<i>NameOfUScriptFunction</i>(<i>parameters</i>)</code>, for example <code>eventPreBeginPlay</code> calls the PreBeginPlay() function.</li>
<li><a href="Dynamic_arrays.html" title="Dynamic arrays">Dynamic arrays</a> have a slightly different syntax in native code. They are declared as <code>TArray&lt;<i>type</i>&gt;</code>, their length is returned via <code><i>array</i>.Num()</code> and individual elements are accessed via round parentheses instead of square brackets. <code><i>array</i>.Empty()</code> does what <code><i>aray</i>.Length = 0;</code> would do in UnrealScript.</li>
<li><code>GLevel-&gt;IsServer()</code> basically returns the same as <code>(Level.NetMode&#160;!= NM_Client)</code> in UnrealScript. Similarly <code>GIsClient</code> basically returns the same as <code>Level.NetMode&#160;!= NM_DedicatedServer</code> in UnrealScript.</li>
<li>The <code>GLevel-&gt;Actors</code> array is the same list that the AllActors iterator traverses in UnrealScript.</li>
<li>The native class name of Actor subclasses is prefixed with an A, the native name of non-Actor classes with a U and the native name of structs with an F, for example APhysicsVolume, UKarmaParams or FVector.</li>
<li><a href="Name.html" title="Name" class="mw-redirect">Name</a> literals do not exist. Instead, the values of all natively-used names are hard-coded as <code>NAME_<i>name</i></code>, for example NAME_None for 'None'.</li>
<li>Class <a href="Literals.html" title="Literals">literals</a> do exist, but look very different from UnrealScript. They are expressed as <code><i>nativeClassName</i>::StaticClass()</code>.</li>
<li><code>bScriptInitialized</code> is an Actor property that is set to True in the SetinitialState() event.</li>
<li><code>if (!<i>someObjectReference</i>)</code> checks if a variable actually points to an object, similar to the UnrealScript code <code>if (<i>someObjectReference</i>&#160;!= None)</code>.</li>
<li>Values for <a href="Bool.html" title="Bool" class="mw-redirect">bool</a> variables are 0 and 1, not False and True.</li>
<li><code>GetClass()-&gt;GetDefaultActor()</code> corresponds to UnrealScript's <code>.default.</code> syntax for <a href="Variables.html#Accessing_variables" title="Variables">accessing the default variable values</a> of a class.</li>
</ul>
<h3><span class="mw-headline" id="General_notes_about_this_code_snippet">General notes about this code snippet</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=15" title="Edit section: General notes about this code snippet">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul>
<li>When running as a (listen and dedicated) server, actors mentioned in the [Engine.GameEngine] ServerActors list in the main INI file (e.g. UnrealTournament.ini, UT2004.ini or UTEngine.ini) are created before this code is executed. UnrealScript execution is not yet enabled at that point, so these actors are initialized like any other actor already in the map.</li>
<li>Players do not exist while this code is executed. Any (local or remote) players join "much" later.</li>
</ul>
<h3><span class="mw-headline" id="Notes_for_Unreal_Engine_1">Notes for Unreal Engine 1</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=16" title="Edit section: Notes for Unreal Engine 1">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul>
<li>The <code>bScriptInitialized</code> variable does not exist in <a href="https://wiki.beyondunreal.com/edit/Unreal_Engine_1?redlink=1" class="new" title="Unreal Engine 1 (page does not exist)">Unreal Engine 1</a>, so unlike in later engine generations actors spawned during initialization may receive *BeginPlay() calls twice.</li>
<li>Unreal Engine 1 does not have volumes or Karma physics, so these parts of the code here do not apply.</li>
</ul>
<h3><span class="mw-headline" id="Notes_for_Unreal_Engine_3">Notes for Unreal Engine 3</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=17" title="Edit section: Notes for Unreal Engine 3">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul>
<li>The Actor's Level variable and the LevelInfo class are both called <i>WorldInfo</i> in <a href="Unreal_Engine_3.html" title="Unreal Engine 3">Unreal Engine 3</a>.</li>
<li>The BeginPlay() and PostNetBeginPlay() functions have been removed, with PostBeginPlay() now taking PostNetBeginPlay()'s role.</li>
<li>Unreal Engine 3 does not use zones, so the related parts of the code here do not apply.</li>
<li>Initialization of levels streamed in at runtime is not covered by this article.</li>
<li><a href="https://wiki.beyondunreal.com/edit/Kismet?redlink=1" class="new" title="Kismet (page does not exist)">Kismet</a> initialization is not covered in this article. <i>(More research is required on this.)</i></li>
</ul>
<h3><span class="mw-headline" id="The_code">The code</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup?section=18" title="Edit section: The code">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="uscript source-uscript">
<pre class="de1">
<span class="coMULTI">/*=============================================================================
	UnGame.cpp: Unreal game engine.
	Copyright 1997-2003 Epic Games, Inc. All Rights Reserved.
 
=============================================================================*/</span>
 
	GLevel<span class="sy0">-&gt;</span>iFirstDynamicActor <span class="sy0">=</span> <span class="nu0">0</span>;
	<span class="kw2">if</span><span class="br0">(</span> <span class="sy0">!</span>Info<span class="sy0">-&gt;</span>bBegunPlay <span class="br0">)</span>
	<span class="br0">{</span>
        appResetTimer<span class="br0">(</span><span class="br0">)</span>; <span class="co1">// sjs</span>
 
		<span class="co1">// fix up level problems</span>
		FixUpLevel<span class="br0">(</span><span class="br0">)</span>;
 
		<span class="co1">// Update draw distance.</span>
		<span class="kw2">if</span> <span class="br0">(</span>GIsClient<span class="br0">)</span>
		<span class="br0">{</span>
			GLevel<span class="sy0">-&gt;</span>GetLevelInfo<span class="br0">(</span><span class="br0">)</span><span class="sy0">-&gt;</span>InitDistanceFogLOD<span class="br0">(</span><span class="br0">)</span>;
			GLevel<span class="sy0">-&gt;</span>GetLevelInfo<span class="br0">(</span><span class="br0">)</span><span class="sy0">-&gt;</span>UpdateDistanceFogLOD<span class="br0">(</span> Client<span class="sy0">-&gt;</span>DrawDistanceLOD <span class="br0">)</span>;
		<span class="br0">}</span>
 
		<span class="co1">// Lock the level.</span>
		debugf<span class="br0">(</span> NAME_Log, TEXT<span class="br0">(</span><span class="st0">"Bringing %s up for play (%i) appSeconds: %f..."</span><span class="br0">)</span>, GLevel<span class="sy0">-&gt;</span>GetFullName<span class="br0">(</span><span class="br0">)</span>, appRound<span class="br0">(</span>GetMaxTickRate<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>, appSeconds<span class="br0">(</span><span class="br0">)</span> <span class="br0">)</span>; <span class="co1">// sjs</span>
		GLevel<span class="sy0">-&gt;</span>FinishedPrecaching <span class="sy0">=</span> <span class="nu0">0</span>;
		GLevel<span class="sy0">-&gt;</span>TimeSeconds <span class="sy0">=</span> <span class="nu0">0</span>;
		GLevel<span class="sy0">-&gt;</span>GetLevelInfo<span class="br0">(</span><span class="br0">)</span><span class="sy0">-&gt;</span>TimeSeconds <span class="sy0">=</span> <span class="nu0">0</span>;
		GLevel<span class="sy0">-&gt;</span>GetLevelInfo<span class="br0">(</span><span class="br0">)</span><span class="sy0">-&gt;</span>GetDefaultPhysicsVolume<span class="br0">(</span><span class="br0">)</span><span class="sy0">-&gt;</span>bNoDelete <span class="sy0">=</span> <span class="kw6">true</span>;
 
		<span class="co1">// Kill off actors that aren't interesting to the client.</span>
		<span class="kw2">if</span><span class="br0">(</span> <span class="sy0">!</span>GLevel<span class="sy0">-&gt;</span>IsServer<span class="br0">(</span><span class="br0">)</span> <span class="br0">)</span>
		<span class="br0">{</span>
			<span class="kw2">for</span><span class="br0">(</span> <span class="kw5">INT</span> i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>GLevel<span class="sy0">-&gt;</span>Actors.<span class="me0">Num</span><span class="br0">(</span><span class="br0">)</span>; i<span class="sy0">++</span> <span class="br0">)</span>
			<span class="br0">{</span>
				AActor<span class="sy0">*</span> <span class="kw9">Actor</span> <span class="sy0">=</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span>;
				<span class="kw2">if</span><span class="br0">(</span> <span class="kw9">Actor</span> <span class="br0">)</span>
				<span class="br0">{</span>
					<span class="kw2">if</span><span class="br0">(</span> Actor<span class="sy0">-&gt;</span>bStatic <span class="sy0">||</span> Actor<span class="sy0">-&gt;</span>bNoDelete <span class="sy0">||</span> Actor<span class="sy0">-&gt;</span><span class="kw3">IsA</span><span class="br0">(</span>AxEmitter::StaticClass<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">)</span> 
					<span class="br0">{</span>
						<span class="kw2">if</span> <span class="br0">(</span> <span class="sy0">!</span>Actor<span class="sy0">-&gt;</span>bClientAuthoritative <span class="br0">)</span>
							Exchange<span class="br0">(</span> Actor<span class="sy0">-&gt;</span><span class="kw7">Role</span>, Actor<span class="sy0">-&gt;</span><span class="kw7">RemoteRole</span> <span class="br0">)</span>;
					<span class="br0">}</span>
					<span class="kw2">else</span>
						GLevel<span class="sy0">-&gt;</span>DestroyActor<span class="br0">(</span> <span class="kw9">Actor</span> <span class="br0">)</span>;
				<span class="br0">}</span>
			<span class="br0">}</span>
		<span class="br0">}</span>
 
		<span class="co1">// Init touching actors &amp; clear LastRenderTime</span>
		<span class="kw2">for</span><span class="br0">(</span> <span class="kw5">INT</span> i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>GLevel<span class="sy0">-&gt;</span>Actors.<span class="me0">Num</span><span class="br0">(</span><span class="br0">)</span>; i<span class="sy0">++</span> <span class="br0">)</span>
			<span class="kw2">if</span><span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span> <span class="br0">)</span>
			<span class="br0">{</span>
				GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>LastRenderTime <span class="sy0">=</span> <span class="nu0">0</span>.<span class="me0">f</span>;
				GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>Touching.<span class="me0">Empty</span><span class="br0">(</span><span class="br0">)</span>;
				GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span><span class="kw9">PhysicsVolume</span> <span class="sy0">=</span> GLevel<span class="sy0">-&gt;</span>GetLevelInfo<span class="br0">(</span><span class="br0">)</span><span class="sy0">-&gt;</span>GetDefaultPhysicsVolume<span class="br0">(</span><span class="br0">)</span>;
			<span class="br0">}</span>
 
 
		<span class="co1">// Init scripting.</span>
		<span class="kw2">for</span><span class="br0">(</span> <span class="kw5">INT</span> i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>GLevel<span class="sy0">-&gt;</span>Actors.<span class="me0">Num</span><span class="br0">(</span><span class="br0">)</span>; i<span class="sy0">++</span> <span class="br0">)</span>
			<span class="kw2">if</span><span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span> <span class="br0">)</span>
				GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>InitExecution<span class="br0">(</span><span class="br0">)</span>;
 
		<span class="co1">// Enable actor script calls.</span>
		Info<span class="sy0">-&gt;</span>bBegunPlay <span class="sy0">=</span> <span class="nu0">1</span>;
		Info<span class="sy0">-&gt;</span>bStartup <span class="sy0">=</span> <span class="nu0">1</span>;
		Info<span class="sy0">-&gt;</span>TimeDilation <span class="sy0">=</span> <span class="br0">(</span><span class="br0">(</span>ALevelInfo <span class="sy0">*</span><span class="br0">)</span><span class="br0">(</span>Info<span class="sy0">-&gt;</span>GetClass<span class="br0">(</span><span class="br0">)</span><span class="sy0">-&gt;</span>GetDefaultActor<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">-&gt;</span>TimeDilation;
 
<span class="co2">#ifdef WITH_KARMA</span>
		<span class="kw2">if</span><span class="br0">(</span><span class="sy0">!</span>GIsEditor <span class="sy0">&amp;&amp;</span> <span class="sy0">!</span>GLevel<span class="sy0">-&gt;</span>GetLevelInfo<span class="br0">(</span><span class="br0">)</span><span class="sy0">-&gt;</span>bKNoInit<span class="br0">)</span>
		<span class="br0">{</span>
			KInitLevelKarma<span class="br0">(</span>GLevel<span class="br0">)</span>;
 
			<span class="kw2">for</span><span class="br0">(</span> <span class="kw5">INT</span> i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>GLevel<span class="sy0">-&gt;</span>Actors.<span class="me0">Num</span><span class="br0">(</span><span class="br0">)</span>; i<span class="sy0">++</span> <span class="br0">)</span>
				<span class="kw2">if</span><span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span> <span class="br0">)</span>
					KInitActorKarma<span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span> <span class="br0">)</span>;
		<span class="br0">}</span>
<span class="co2">#endif</span>
 
		<span class="co1">// Init the game.</span>
		<span class="kw2">if</span><span class="br0">(</span> Info<span class="sy0">-&gt;</span><span class="kw7">Game</span> <span class="br0">)</span>
		<span class="br0">{</span>		
			Info<span class="sy0">-&gt;</span>Game<span class="sy0">-&gt;</span>eventInitGame<span class="br0">(</span> Options, <span class="kw4">Error</span> <span class="br0">)</span>;
			Info<span class="sy0">-&gt;</span>Game<span class="sy0">-&gt;</span>eventSetGrammar<span class="br0">(</span><span class="br0">)</span>;
		<span class="br0">}</span>
 
		<span class="co1">// Send PreBeginPlay.</span>
		<span class="kw2">for</span><span class="br0">(</span> <span class="kw5">INT</span> i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>GLevel<span class="sy0">-&gt;</span>Actors.<span class="me0">Num</span><span class="br0">(</span><span class="br0">)</span>; i<span class="sy0">++</span> <span class="br0">)</span>
			<span class="kw2">if</span><span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span> <span class="sy0">&amp;&amp;</span> <span class="sy0">!</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>bScriptInitialized <span class="br0">)</span>
				GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>eventPreBeginPlay<span class="br0">(</span><span class="br0">)</span>;
 
		<span class="co1">// Set BeginPlay.</span>
		<span class="kw2">for</span><span class="br0">(</span> <span class="kw5">INT</span> i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>GLevel<span class="sy0">-&gt;</span>Actors.<span class="me0">Num</span><span class="br0">(</span><span class="br0">)</span>; i<span class="sy0">++</span> <span class="br0">)</span>
			<span class="kw2">if</span><span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span> <span class="sy0">&amp;&amp;</span> <span class="sy0">!</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>bScriptInitialized <span class="br0">)</span>
				GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>eventBeginPlay<span class="br0">(</span><span class="br0">)</span>;
 
		<span class="co1">// Set zones &amp;&amp; gather volumes.</span>
		TArray<span class="sy0">&lt;</span>AVolume<span class="sy0">*&gt;</span> LevelVolumes;
		<span class="kw2">for</span><span class="br0">(</span> <span class="kw5">INT</span> i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>GLevel<span class="sy0">-&gt;</span>Actors.<span class="me0">Num</span><span class="br0">(</span><span class="br0">)</span>; i<span class="sy0">++</span> <span class="br0">)</span>
		<span class="br0">{</span>
			<span class="kw2">if</span><span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span> <span class="sy0">&amp;&amp;</span> <span class="sy0">!</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>bScriptInitialized <span class="br0">)</span>
				GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>SetZone<span class="br0">(</span> <span class="nu0">1</span>, <span class="nu0">1</span> <span class="br0">)</span>;
 
			AVolume<span class="sy0">*</span> <span class="kw9">Volume</span> <span class="sy0">=</span> Cast<span class="sy0">&lt;</span>AVolume<span class="sy0">&gt;</span><span class="br0">(</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>;
			<span class="kw2">if</span><span class="br0">(</span> <span class="kw9">Volume</span> <span class="br0">)</span>
				LevelVolumes.<span class="me0">AddItem</span><span class="br0">(</span><span class="kw9">Volume</span><span class="br0">)</span>;
		<span class="br0">}</span>
 
		<span class="co1">// Set appropriate volumes for each actor.</span>
		<span class="kw2">for</span><span class="br0">(</span> <span class="kw5">INT</span> i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>GLevel<span class="sy0">-&gt;</span>Actors.<span class="me0">Num</span><span class="br0">(</span><span class="br0">)</span>; i<span class="sy0">++</span> <span class="br0">)</span>
			<span class="kw2">if</span><span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span> <span class="sy0">&amp;&amp;</span> <span class="sy0">!</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>bScriptInitialized <span class="br0">)</span>
				GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>SetVolumes<span class="br0">(</span> LevelVolumes <span class="br0">)</span>;
 
		<span class="co1">// Post begin play.</span>
		<span class="kw2">for</span><span class="br0">(</span> <span class="kw5">INT</span> i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>GLevel<span class="sy0">-&gt;</span>Actors.<span class="me0">Num</span><span class="br0">(</span><span class="br0">)</span>; i<span class="sy0">++</span> <span class="br0">)</span>
			<span class="kw2">if</span><span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span> <span class="sy0">&amp;&amp;</span> <span class="sy0">!</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>bScriptInitialized <span class="br0">)</span>
			<span class="br0">{</span>
				GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>eventPostBeginPlay<span class="br0">(</span><span class="br0">)</span>;
 
				<span class="kw2">if</span><span class="br0">(</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>
					GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span><span class="kw4">PostBeginPlay</span><span class="br0">(</span><span class="br0">)</span>;
			<span class="br0">}</span>
 
		<span class="co1">// Post net begin play.</span>
		<span class="kw2">for</span><span class="br0">(</span> <span class="kw5">INT</span> i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>GLevel<span class="sy0">-&gt;</span>Actors.<span class="me0">Num</span><span class="br0">(</span><span class="br0">)</span>; i<span class="sy0">++</span> <span class="br0">)</span>
			<span class="kw2">if</span><span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span> <span class="sy0">&amp;&amp;</span> <span class="sy0">!</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>bScriptInitialized <span class="br0">)</span>
				GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>eventPostNetBeginPlay<span class="br0">(</span><span class="br0">)</span>;
 
		<span class="co1">// Begin scripting.</span>
		<span class="kw2">for</span><span class="br0">(</span> <span class="kw5">INT</span> i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>GLevel<span class="sy0">-&gt;</span>Actors.<span class="me0">Num</span><span class="br0">(</span><span class="br0">)</span>; i<span class="sy0">++</span> <span class="br0">)</span>
			<span class="kw2">if</span><span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span> <span class="sy0">&amp;&amp;</span> <span class="sy0">!</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>bScriptInitialized <span class="br0">)</span>
				GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>eventSetInitialState<span class="br0">(</span><span class="br0">)</span>;
 
		<span class="co1">// Find bases</span>
		<span class="kw2">for</span><span class="br0">(</span> <span class="kw5">INT</span> i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>GLevel<span class="sy0">-&gt;</span>Actors.<span class="me0">Num</span><span class="br0">(</span><span class="br0">)</span>; i<span class="sy0">++</span> <span class="br0">)</span>
		<span class="br0">{</span>
			<span class="kw2">if</span><span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span> <span class="br0">)</span> 
			<span class="br0">{</span>
				<span class="kw2">if</span> <span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>AttachTag <span class="sy0">!=</span> NAME_None <span class="br0">)</span>
				<span class="br0">{</span>
					<span class="co1">//find actor to attach self onto</span>
					<span class="kw2">for</span><span class="br0">(</span> <span class="kw5">INT</span> j<span class="sy0">=</span><span class="nu0">0</span>; j<span class="sy0">&lt;</span>GLevel<span class="sy0">-&gt;</span>Actors.<span class="me0">Num</span><span class="br0">(</span><span class="br0">)</span>; j<span class="sy0">++</span> <span class="br0">)</span>
					<span class="br0">{</span>
						<span class="kw2">if</span><span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>j<span class="br0">)</span> 
							<span class="sy0">&amp;&amp;</span> <span class="br0">(</span><span class="br0">(</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>j<span class="br0">)</span><span class="sy0">-&gt;</span><span class="kw7">Tag</span> <span class="sy0">==</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>AttachTag<span class="br0">)</span> <span class="sy0">||</span> <span class="br0">(</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>j<span class="br0">)</span><span class="sy0">-&gt;</span>GetFName<span class="br0">(</span><span class="br0">)</span> <span class="sy0">==</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>AttachTag<span class="br0">)</span><span class="br0">)</span>  <span class="br0">)</span>
						<span class="br0">{</span>
							GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span><span class="kw4">SetBase</span><span class="br0">(</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>j<span class="br0">)</span>, FVector<span class="br0">(</span><span class="nu0">0</span>,<span class="nu0">0</span>,<span class="nu0">1</span><span class="br0">)</span>, <span class="nu0">0</span><span class="br0">)</span>;
							<span class="kw2">break</span>;
						<span class="br0">}</span>
					<span class="br0">}</span>
				<span class="br0">}</span>
				<span class="kw2">else</span> <span class="kw2">if</span><span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>bCollideWorld <span class="sy0">&amp;&amp;</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>bShouldBaseAtStartup
				 <span class="sy0">&amp;&amp;</span>	<span class="br0">(</span><span class="br0">(</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span><span class="kw7">Physics</span> <span class="sy0">==</span> <span class="kw7">PHYS_None</span><span class="br0">)</span> <span class="sy0">||</span> <span class="br0">(</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span><span class="kw7">Physics</span> <span class="sy0">==</span> <span class="kw7">PHYS_Rotating</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">)</span>
				<span class="br0">{</span>
					 GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>FindBase<span class="br0">(</span><span class="br0">)</span>;
				<span class="br0">}</span>
			<span class="br0">}</span>
		<span class="br0">}</span>
 
		<span class="kw2">for</span><span class="br0">(</span> <span class="kw5">INT</span> i<span class="sy0">=</span><span class="nu0">0</span>; i<span class="sy0">&lt;</span>GLevel<span class="sy0">-&gt;</span>Actors.<span class="me0">Num</span><span class="br0">(</span><span class="br0">)</span>; i<span class="sy0">++</span> <span class="br0">)</span> 
		<span class="br0">{</span>
			<span class="kw2">if</span><span class="br0">(</span>GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>
			<span class="br0">{</span>
				<span class="kw2">if</span><span class="br0">(</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span><span class="kw3">IsA</span><span class="br0">(</span>AProjector::StaticClass<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> <span class="co1">// sjs - why is this needed?!!</span>
				<span class="br0">{</span>
					GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">-&gt;</span>PostEditChange<span class="br0">(</span><span class="br0">)</span>;
				<span class="br0">}</span>
 
<span class="co2">#ifdef WITH_KARMA</span>
				AActor<span class="sy0">*</span> <span class="kw9">actor</span> <span class="sy0">=</span> GLevel<span class="sy0">-&gt;</span>Actors<span class="br0">(</span>i<span class="br0">)</span>;
 
				<span class="kw2">if</span><span class="br0">(</span>actor<span class="sy0">-&gt;</span><span class="kw7">Physics</span> <span class="sy0">!=</span> <span class="kw7">PHYS_Karma</span> <span class="sy0">||</span> <span class="sy0">!</span>actor<span class="sy0">-&gt;</span>KParams <span class="sy0">||</span> <span class="sy0">!</span>actor<span class="sy0">-&gt;</span>KParams<span class="sy0">-&gt;</span><span class="kw3">IsA</span><span class="br0">(</span>UKarmaParams::StaticClass<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>
					<span class="kw2">continue</span>;
 
				UKarmaParams<span class="sy0">*</span> kparams <span class="sy0">=</span> Cast<span class="sy0">&lt;</span>UKarmaParams<span class="sy0">&gt;</span><span class="br0">(</span>actor<span class="sy0">-&gt;</span>KParams<span class="br0">)</span>;
 
				<span class="co1">// If running below HighDetailPhysics, turn off karma dynamics for actors with bHighDetailOnly set true.</span>
				<span class="kw2">if</span><span class="br0">(</span>	GLevel<span class="sy0">-&gt;</span>GetLevelInfo<span class="br0">(</span><span class="br0">)</span><span class="sy0">-&gt;</span>PhysicsDetailLevel <span class="sy0">&lt;</span> PDL_High <span class="sy0">&amp;&amp;</span> kparams<span class="sy0">-&gt;</span>bHighDetailOnly <span class="br0">)</span>
					KTermActorDynamics<span class="br0">(</span><span class="kw9">actor</span><span class="br0">)</span>;
 
				<span class="co1">// If dedicated server, turn off karma for actors with bHighDetailOnly or bClientsOnly</span>
				<span class="kw2">if</span><span class="br0">(</span>	GLevel<span class="sy0">-&gt;</span>GetLevelInfo<span class="br0">(</span><span class="br0">)</span><span class="sy0">-&gt;</span>NetMode <span class="sy0">==</span> NM_DedicatedServer <span class="sy0">&amp;&amp;</span> <span class="br0">(</span>kparams<span class="sy0">-&gt;</span>bHighDetailOnly <span class="sy0">||</span> kparams<span class="sy0">-&gt;</span>bClientOnly<span class="br0">)</span> <span class="br0">)</span>					
					KTermActorDynamics<span class="br0">(</span><span class="kw9">actor</span><span class="br0">)</span>;
<span class="co2">#endif</span>
			<span class="br0">}</span>
		<span class="br0">}</span>
 
		Info<span class="sy0">-&gt;</span>bStartup <span class="sy0">=</span> <span class="nu0">0</span>;
	<span class="br0">}</span>
</pre></div>
</div>

<!-- 
NewPP limit report
CPU time usage: 0.124 seconds
Real time usage: 0.127 seconds
Preprocessor visited node count: 74/1000000
Preprocessor generated node count: 96/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->

<!-- Saved in parser cache with key wiki:pcache:idhash:28783-0!*!0!!en!*!* and timestamp 20161216054022 and revision id 45927
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://wiki.beyondunreal.com/What_happens_at_map_startup?oldid=45927">https://wiki.beyondunreal.com/What_happens_at_map_startup?oldid=45927</a>"</div>
					<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://wiki.beyondunreal.com/Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="Category_Programming_articles.html" title="Category:Programming articles">Programming articles</a></li><li><a href="Category_Native_code_snippet.html" title="Category:Native code snippet">Native code snippet</a></li></ul></div></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-main" class="selected"><a href="What_happens_at_map_startup.html" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk"><a href="Talk_What_happens_at_map_startup.html" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-edit"><a href="https://wiki.beyondunreal.com/edit/What_happens_at_map_startup" title="You can edit this page. Please use the preview button before saving [e]" accesskey="e">Edit</a></li>
				<li id="ca-history"><a href="https://wiki.beyondunreal.com/history/What_happens_at_map_startup" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-createaccount"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=What+happens+at+map+startup&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li>
													<li id="pt-login"><a href="https://wiki.beyondunreal.com/Special:UserLogin?returnto=What+happens+at+map+startup" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="index.html" class="mw-wiki-logo" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-navigation" role="navigation">
		<h3>Navigation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-mainpage"><a href="index.html" title="Visit the main page [z]" accesskey="z">Main Page</a></li>
											<li id="n-portal"><a href="Unreal_Wiki_Community_portal-2.html" title="About the project, what you can do, where to find things">Community portal</a></li>
											<li id="n-recentchanges"><a href="https://wiki.beyondunreal.com/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="https://wiki.beyondunreal.com/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
											<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											<li id="n-Forums-.28General.29"><a href="https://forums.beyondunreal.com/forums/wiki-general.250/" rel="nofollow">Forums (General)</a></li>
											<li id="n-Forums-.28Technical.29"><a href="https://forums.beyondunreal.com/forums/wiki-technical.251/" rel="nofollow">Forums (Technical)</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="https://wiki.beyondunreal.com/" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search Unreal Wiki [f]" accesskey="f" id="searchInput" />
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="https://wiki.beyondunreal.com/Special:WhatLinksHere/What_happens_at_map_startup" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="https://wiki.beyondunreal.com/Special:RecentChangesLinked/What_happens_at_map_startup" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="https://wiki.beyondunreal.com/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-print"><a href="https://wiki.beyondunreal.com/What_happens_at_map_startup?printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
											<li id="t-permalink"><a href="https://wiki.beyondunreal.com/What_happens_at_map_startup?oldid=45927" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="https://wiki.beyondunreal.com/info/What_happens_at_map_startup" title="More information about this page">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-copyrightico">
									<a href="https://creativecommons.org/licenses/by-nc-sa/3.0/"><img src="../licensebuttons.net/l/by-nc-sa/3.0/88x31.png" alt="Attribution-Noncommercial-Share Alike 3.0" width="88" height="31" /></a>
							</div>
					<div id="f-poweredbyico">
									<script async src="../pagead2.googlesyndication.com/pagead/js/f.txt"></script>
        <!-- Home Page -->
        <ins class="adsbygoogle"
             style="display:inline-block;width:728px;height:90px"
             data-ad-client="ca-pub-9605963037553244"
             data-ad-slot="9528541415"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
							</div>
					<ul id="f-list">
									<li id="lastmod"> Last modified at 15:18, 9 January 2014.</li>
									<li id="copyright">Licensed as <a href="Unreal_Wiki_Copyrights.html" title="Unreal Wiki:Copyrights">Attribution-Noncommercial-Share Alike 3.0</a>.</li>
									<li id="privacy"><a href="Unreal_Wiki_Privacy_policy.html" title="Unreal Wiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="Unreal_Wiki_About.html" title="Unreal Wiki:About">About Unreal Wiki</a></li>
									<li id="disclaimer"><a href="Unreal_Wiki_General_disclaimer.html" title="Unreal Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wiki.beyondunreal.com/w/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=monobook\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":86});
}</script></body>
<!-- Mirrored from wiki.beyondunreal.com/What_happens_at_map_startup by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 16 Dec 2016 07:52:50 GMT -->
</html>
